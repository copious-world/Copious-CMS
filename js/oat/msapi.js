/* oat: featureLoaded */
var l456bt="Invalid invoke target specified.",l709ct="Invalid argument passed; both start and end must be present.",l947dt="Invalid search results page index is passed.",l773et="Invalid element id; unable to find the element in the document body.",l611ft="Head element is missing for the current document; cannot initialize the API framework.",l662gt="Either a service url or script url is required to create VENetwork instance.",l24ht="Invalid script source url is assigned; cannot download the assigned script.",l783it="Invalid style source url is assigned; cannot attach the assigned styles.",l20jt="Invalid what/where parameters; either 'what' or 'where' must be present.",l415kt="Map is not loaded; cannot perform this operation.",l859lt="Cannot calculate route at this point; try again later.",l830mt="Invalid pushpin instance.",l455nt="Invalid pushpin id; either id is empty or another pushpin already exists with that id.",l501ot="Invalid polyline id; either id is empty or another polyline already exists with that id.",l0pt="Invalid polygon id; either id is empty or another polygon already exists with that id.",l614qt="Invalid argument; input argument '%1' is not a valid '%2' value.",l32rt="Invalid layer id; either id is empty or another layer already exists with that id.",l368st="Invalid layer type.",l353tt="Invalid layer source; either layer is empty or does not exist.",l975ut="Invalid source id; either id is empty or another tile source already exists with that id.",l389vt="Min zoom is greater than max zoom.",l968wt="Invalid opacity value.",l872xt="Unable to load source file.",l141yt="Help",L_ErrorServerBusy_Text="The server is currently busy. Try again later.",l658zt="Error",l712At="close",l723Bt="What",l147Ct="Where",l400Dt="Find",l870Et="Select a location",l594Ft="Start",l257Gt="End",l134Ht="Get directions",l669It=".. Loading ..",l79Jt="Arrive at",l99Kt="Start at",l694Lt="Step %1 of %2",l686Mt="Step",l690Nt="Shared Collection",l420Ot="Unsaved Collection",l696Pt="Untitled item",l675Qt="Severity",l13Rt="Location",l799St="Description",l738Tt="Start time",l313Ut="Est. end time",l210Vt="Serious",l100Wt="Moderate",l985Xt="Minor",l782Yt="Zoom out to view Traffic information",l87Zt="Zoom in to view Traffic information",l938ajt="Road",l876akt="Aerial",l383alt="Bird's eye",l149amt="See this location in bird's eye view.",l819ant="See this location in Virtual Earth 3D",l601aot="Show labels",l695apt="Choose the zoom level",l785aqt="Change the direction of the view",l421art="Choose a thumbnail to display an image from the surrounding area",l900ast="Bird's eye images are not available for this area.",l918att="miles",l344aut="km",l676avt="m",l932awt="yds",l279axt="2D",l712ayt="3D",l954azt="Road",l72aAt="Aerial",l402aBt="Hybrid",l345aCt="2D",l502aDt="3D (Beta)",l622aEt="Map view",l161aFt="Bird's eye view",l617aGt="Street-level view",l783aHt="Look down",l322aIt="Look down at an angle",l788aJt="Look toward horizon",l580aKt="Zoom out",l378aLt="Zoom in",l591aMt="Choose view",l262aNt="To use this feature, open Live Local Search in Windows Internet Explorer version 6 or 7. For more information, and to download the latest version, visit the Microsoft Internet Explorer website (%1%3%2).",l887aOt="To use this feature, open Live Local Search in the 32-bit version of Windows Internet Explorer.",l572aPt="Virtual Earth 3D has detected that hardware acceleration is turned off.",L_MapControlNavteq_Text="&copy; 2006 NAVTEQ",L_MapControlImageCourtesyOfNASA_Text="Image courtesy of NASA",L_MapControlHarrisCorp_Text="&copy; Harris Corp, Earthstar Geographics LLC",L_MapControlImageCourtesyOfUSGS_Text="Image courtesy of USGS",L_MapControlImageCourtesyOfPictometry_Text="&copy; 2005 Pictometry International Corp.",L_MapControlImageCourtesyOfEarthData_Text="&copy; EarthData",L_MapControlImageCourtesyOfGetmapping_Text="&copy; Getmapping plc",L_MapControlImageCourtesyOfAND_Text="&copy; AND",L_MapControlImageCourtesyOfBlom_Text="&copy; 2006 Blom",L_MapCopyrightMicrosoft="&copy; 2006 Microsoft Corporation",L_MapControlPlatformName_Text="Virtual Earth",L_MapControlImageCourtesyOfGeoEye_Text="&copy; 2006 GeoEye",L_MapControlImageCourtesyOfMapDataSciences_Text="&copy; 2006 MapData Sciences Pty Ltd",L_MapControlImageCourtesyOfZenrin_Text="&copy; 2006 Zenrin",L_MapControlImageCourtesyOfPasco_Text="&copy; 2005 Pasco",L_SupportedBrowserDownloadUrl_Text="http://www.microsoft.com/windows/ie/downloads/default.mspx";RegisterNamespaces("MapControl");MapControl.Features=new function(){this.PlatformName=L_MapControlPlatformName_Text;this.Copyright=new function(){this.Navteq=L_MapControlNavteq_Text;this.ImageCourtesyOfNASA=L_MapControlImageCourtesyOfNASA_Text;this.HarrisCorp=L_MapControlHarrisCorp_Text;this.ImageCourtesyOfUSGS=L_MapControlImageCourtesyOfUSGS_Text;this.ImageCourtesyOfPictometry=L_MapControlImageCourtesyOfPictometry_Text};this.Image=new function(){this.PoweredLogo="logo_powered_by.png"};this.MapStyle=new function(){this.Road=true;this.Aerial=true;this.Hybrid=true;this.BirdsEye=true;this.View3D=true};this.BirdsEyeAtZoomLevel=10;this.ScaleBarKilometers=false;this.Traffic=new function(){this.Flow=new function(){this.Slow="0-25 mph";this.Moderate="25-45 mph";this.Fast="45+ mph"}}};RegisterNamespaces("Msn.MVC");Msn.MVC.AbstractView=function(){this._contextPin=null};Msn.MVC.AbstractView.prototype.OnBeforeSwitchAway=function(){};Msn.MVC.AbstractView.prototype.ShowShimIfSupported=function(){};Msn.MVC.AbstractView.prototype.UpdateShimIfSupported=function(){};Msn.MVC.AbstractView.prototype.OnEroShowFadeInAnimationIfSupported=function(a){a()};RegisterNamespaces("Msn.MVC");Msn.MVC.FlatlandView=function(){this._superObj=Msn.MVC.FlatlandView.prototype;this._mapDrawingView=null};Msn.MVC.FlatlandView.prototype=new Msn.MVC.AbstractView;Msn.MVC.FlatlandView.prototype.OnBeforeSwitchAway=function(){if(window.__drawingLoaded){this._ClearAllCollectionLayers();VE_MapDispatch.Clear()}};RegisterNamespaces("Msn.MVC");Msn.MVC.View3D=function(){this._superObj=Msn.MVC.View3D.prototype;this._hackUniqueLayerId="UniqueLayer_Hack";this._entityIdShapePostfix="_Shape";this._spacecontrol=null};Msn.MVC.View3D.prototype=new Msn.MVC.AbstractView;Msn.MVC.View3D.prototype.OnBeforeSwitchAway=function(){this._SetView3DControl(null)};Msn.MVC.View3D.prototype._SetView3DControl=function(a){this._spacecontrol=a};Msn.MVC.View3D.prototype.ShowShimIfSupported=function(b,a){ShowShim(b,a)};Msn.MVC.View3D.prototype.UpdateShimIfSupported=function(b,a){UpdateIFrameShim(b,a)};Msn.MVC.View3D.prototype.OnEroShowFadeInAnimationIfSupported=function(c,a,b){a.style.visibility="visible";a.style.display="block";ShowShim(b,a)};RegisterNamespaces("Msn.MVC");Msn.MVC.ViewFacade=function(){this._mvcFlatlandView=null;this._mvcView3D=null;this._curMvcView=null};Msn.MVC.ViewFacade.prototype.OnSwitchToFlatlandView=function(){if(this._mvcFlatlandView==null)this._mvcFlatlandView=new Msn.MVC.FlatlandView;if(this._curMvcView==this._mvcFlatlandView)return;if(this._curMvcView!=null)this._curMvcView.OnBeforeSwitchAway();this._curMvcView=this._mvcFlatlandView;if(window.__drawingLoaded)this._curMvcView.OnAllCollectionLayersRepaint()};Msn.MVC.ViewFacade.prototype.OnSwitchToView3D=function(a){if(this._mvcView3D==null)this._mvcView3D=new Msn.MVC.View3D;if(this._curMvcView==this._mvcView3D)return;if(this._curMvcView!=null)this._curMvcView.OnBeforeSwitchAway();this._mvcView3D._SetView3DControl(a);this._curMvcView=this._mvcView3D;if(window.__drawingLoaded)this._curMvcView.OnAllCollectionLayersRepaint()};Msn.MVC.ViewFacade.prototype.ShowShimIfSupported=function(b,a){if(this._curMvcView==null)return;return this._curMvcView.ShowShimIfSupported(b,a)};Msn.MVC.ViewFacade.prototype.UpdateShimIfSupported=function(b,a){if(this._curMvcView==null)return;return this._curMvcView.UpdateShimIfSupported(b,a)};Msn.MVC.ViewFacade.prototype.OnEroShowFadeInAnimationIfSupported=function(a,c,b){if(this._curMvcView==null)return;return this._curMvcView.OnEroShowFadeInAnimationIfSupported(a,c,b)};var mvcViewFacade=new Msn.MVC.ViewFacade,windowWidth=0,windowHeight=0,scrollbarWidth=null;function $ID(a){var b=document;return b.getElementById(a)}function $CE(a){var b=document;return b.createElement(a)}function $CENS(a){var b=document;return b.createElementNS(a)}function GetWindowWidth(){var a=0;if(typeof window.innerWidth=="number")a=window.innerWidth;else if(document.documentElement&&document.documentElement.clientWidth)a=document.documentElement.clientWidth;else if(document.body&&document.body.clientWidth)a=document.body.clientWidth;if(!a||a<100)a=100;return a}function GetWindowHeight(){var a=0;if(typeof window.innerHeight=="number")a=window.innerHeight;else if(document.documentElement&&document.documentElement.clientHeight)a=document.documentElement.clientHeight;else if(document.body&&document.body.clientHeight)a=document.body.clientHeight;if(!a||a<100)a=100;return a}function GetScrollbarWidth(){if(scrollbarWidth)return scrollbarWidth;if(navigator.userAgent.indexOf("IE")>=0){var a=document.createElement("div"),b=null;a.style.visible="hidden";a.style.overflowY="scroll";a.style.position="absolute";a.style.width=0;document.body.insertAdjacentElement("afterBegin",a);b=a.offsetWidth;a.parentNode.removeChild(a);if(!b)b=16;scrollbarWidth=b;return b}else return 0}function GetUrlPrefix(){var a=window.location.pathname.lastIndexOf("/"),b=window.location.protocol+"//"+window.location.hostname+window.location.pathname.substring(0,a+1);return b}function GetUrlParameterString(){var a=window.location.search;if(a.length==0||a.indexOf("?")==-1)return "";return a.substr(a.indexOf("?")+1)}function CheckWipExistence(){var a=GetUrlParameterString();if(a!=""&&a.indexOf("wip=")>-1)return true;return false}function GetUrlParameters(){var b=[],d=GetUrlParameterString();if(!d)return b;var e=d.split("&");for(var c=0;c<e.length;c++){var a=e[c].split("=");if(a.length==2&&a[0]&&a[1]){b.push(unescape(a[0]));b.push(unescape(a[1]))}}return b}function ParseShiftKeyForLinks(a){if(a.shiftKey)return false;return true}function GetEvent(a){return a?a:window.event}function CancelEvent(a){a.cancelBubble=true}function IgnoreEvent(a){a=GetEvent(a);CancelEvent(a);return false}function GetMouseX(a){var b=0;if(a.pageX)b=a.pageX;else if(a.clientX)if(document.documentElement&&document.documentElement.scrollLeft)b=a.clientX+document.documentElement.scrollLeft;else if(document.body)b=a.clientX+document.body.scrollLeft;return b}function GetMouseY(a){var b=0;if(a.pageY)b=a.pageY;else if(a.clientY)if(document.documentElement&&document.documentElement.scrollTop)b=a.clientY+document.documentElement.scrollTop;else if(document.body)b=a.clientY+document.body.scrollTop;return b}function GetMouseScrollDelta(a){if(a.wheelDelta)return a.wheelDelta;else if(a.detail)return -a.detail;return 0}function GetTarget(b){if(!b)b=window.event;var a=null;if(b.srcElement)a=b.srcElement;else if(b.target)a=b.target;if(a&&a.nodeType)if(a.nodeType==3)a=targ.parentNode;return a}function GetLeftPosition(c){var a=c,b=0;while(a){b+=a.offsetLeft;a=a.offsetParent}if(navigator.userAgent.indexOf("Mac")!=-1&&typeof document.body.leftMargin!="undefined")b+=document.body.leftMargin;return b}function GetTopPosition(c){var a=c,b=0;while(a){b+=a.offsetTop;a=a.offsetParent}if(navigator.userAgent.indexOf("Mac")!=-1&&typeof document.body.topMargin!="undefined")b+=document.body.topMargin;return b}RegisterNamespaces("Msn.VE");Msn.VE.DistanceUnit={Kilometers:"km",Miles:"mi"};Msn.VE.DistanceUnit.IsValidType=function(a){if(typeof a=="string")if(a==Msn.VE.DistanceUnit.Miles||a==Msn.VE.DistanceUnit.Kilometers)return true;return false};function MathFloor(a){return Math.floor(a)}function MathCeil(a){return Math.ceil(a)}function MathMax(a,b){return Math.max(a,b)}function MathMin(a,b){return Math.min(a,b)}function MathAbs(a){return Math.abs(a)}function MathRound(a){return Math.round(a)}function DegToRad(a){return a*Math.PI/180}function RadToDeg(a){return a*180/Math.PI}function MatrixMultiply(e,b){if(!e||!b||e[0].length!=b.length)return;var g=e.length,h=b[0].length,d=new Array(g),i=b.length;for(var a=0;a<g;a++){d[a]=new Array(h);for(var c=0;c<h;c++){d[a][c]=0;for(var f=0;f<i;f++)d[a][c]+=e[a][f]*b[f][c]}}return d}function RegisterNamespaces(){for(var d=0;d<arguments.length;d++){var b=arguments[d].split("."),c=window;for(var a=0;a<b.length;a++){if(!c[b[a]])c[b[a]]=new Object;c=c[b[a]]}}}RegisterNamespaces("Msn.Drawing");var MC_PointID=10000,MC_PolylineID=30000,MC_PolygonID=50000,MC_SYMBOL_IID=70000,MC_TEXT_IID=90000,MC_ENTITY_IID=200000,MC_COL_IID=1000,MC_GEO_TYPE_SYMBOL="Symbol",MC_GEO_TYPE_POINT="Point",MC_GEO_TYPE_POLYLINE="Polyline",MC_GEO_TYPE_POLYGON="Polygon",MC_GEO_TYPE_TEXT="Text",MC_GEO_TYPE_COL="Collection",MC_GEO_TYPE_ENTITY="Entity";Msn.Drawing.GetGeoUID=function(b){var a="";switch(b){case MC_GEO_TYPE_POLYGON:a=MC_PolygonID++;break;case MC_GEO_TYPE_POINT:a=MC_PointID++;break;case MC_GEO_TYPE_POLYLINE:a=MC_PolylineID++;break;case MC_GEO_TYPE_SYMBOL:a=MC_SYMBOL_IID++;break;case MC_GEO_TYPE_TEXT:a=MC_TEXT_IID++;break;case MC_GEO_TYPE_COL:a=MC_COL_IID++;break;case MC_GEO_TYPE_ENTITY:a=MC_ENTITY_IID++;break}return a.toString()};Msn.Drawing.Exception=function(a){this.message=a;this.name="Msn.Drawing.Exception"};Msn.Drawing.Exception.prototype.toString=function(){return this.name+": "+this.message};Msn.Drawing.Point=function(a,b){this.id=0;this.points=[];this.points.push(a);this.points.push(b);this.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_POINT)};Msn.Drawing.Point.prototype.type=MC_GEO_TYPE_POINT;Msn.Drawing.Point.prototype.name=null;Msn.Drawing.Point.prototype.symbol=null;Msn.Drawing.Point.prototype.isLabel=false;Msn.Drawing.Point.prototype.isOnLegend=false;Msn.Drawing.Point.prototype.Destroy=function(){this.symbol=null;this.points=null};Msn.Drawing.Point.prototype.toString=function(){return this.points[0]+","+this.points[1]};Msn.Drawing.PolyLine=function(a){this.id=0;this.points=a?a:[]};Msn.Drawing.PolyLine.prototype.toString=function(){if(this.points!=null)return this.points.join(" ");else return ""};Msn.Drawing.PolyLine.prototype.minX=null;Msn.Drawing.PolyLine.prototype.minY=null;Msn.Drawing.PolyLine.prototype.maxX=null;Msn.Drawing.PolyLine.prototype.maxY=null;Msn.Drawing.PolyLine.prototype.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_POLYLINE);Msn.Drawing.PolyLine.prototype.labelPosX=null;Msn.Drawing.PolyLine.prototype.labelPosY=null;Msn.Drawing.PolyLine.prototype.name=null;Msn.Drawing.PolyLine.prototype.type=MC_GEO_TYPE_POLYLINE;Msn.Drawing.PolyLine.prototype.symbol=null;Msn.Drawing.PolyLine.prototype.isLabel=false;Msn.Drawing.PolyLine.prototype.isOnLegend=false;Msn.Drawing.PolyLine.prototype.Destroy=function(){this.symbol=null;this.points=null;this.minX=null;this.minY=null;this.maxX=null;this.maxY=null};Msn.Drawing.Polygon=function(a){this.id=0;this.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_POLYGON);this.points=a;this.minX=null;this.minY=null;this.maxX=null;this.maxY=null;return this};Msn.Drawing.Polygon.prototype.labelPosX=null;Msn.Drawing.Polygon.prototype.labelPosY=null;Msn.Drawing.Polygon.prototype.symbol=null;Msn.Drawing.Polygon.prototype.isLabel=false;Msn.Drawing.Polygon.prototype.isOnLegend=false;Msn.Drawing.Polygon.prototype.type=MC_GEO_TYPE_POLYGON;Msn.Drawing.Polygon.prototype.name=null;Msn.Drawing.Polygon.prototype.Destroy=function(){this.symbol=null;this.points=null;this.minX=null;this.minY=null;this.maxX=null;this.maxY=null};Msn.Drawing.Stroke=function(){this.width=1;this.linecap="round";this.opacity=1;this.linejoin="miter";this.color=new Msn.Drawing.Color(255,255,255,1);this.fillcolor=new Msn.Drawing.Color(0,255,0,1)};Msn.Drawing.Color=function(d,c,b,a){this.R=d?d:0;this.G=c?c:0;this.B=b?b:0;this.A=a?a:1;this.ToHexString=function(){return "#"+Number(this.R).toString(16)+(this.R<16?"0":"")+Number(this.G).toString(16)+(this.G<16?"0":"")+Number(this.B).toString(16)+(this.B<16?"0":"")}};Msn.Drawing.MapSymbol=function(){this.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_SYMBOL);this.id=this.iid};Msn.Drawing.MapSymbol.prototype.point_type="v:rect";Msn.Drawing.MapSymbol.prototype.name="symbol";Msn.Drawing.MapSymbol.prototype.highlight_stroke_color="#336666";Msn.Drawing.MapSymbol.prototype.highlight_fill_color="#FFCC33";Msn.Drawing.MapSymbol.prototype.shape_drawtype="v:shape";Msn.Drawing.MapSymbol.prototype.shape_fill="false";Msn.Drawing.MapSymbol.prototype.shape_filled="false";Msn.Drawing.MapSymbol.prototype.shape_unselectable="off";Msn.Drawing.MapSymbol.prototype.style_zIndex=60;Msn.Drawing.MapSymbol.prototype.style_position="absolute";Msn.Drawing.MapSymbol.prototype.style_filter="alpha(opacity=30)";Msn.Drawing.MapSymbol.prototype.style_width="10";Msn.Drawing.MapSymbol.prototype.style_height="10";Msn.Drawing.MapSymbol.prototype.style_visibility="visible";Msn.Drawing.MapSymbol.prototype.style_display="block";Msn.Drawing.MapSymbol.prototype.stroke_drawtype="v:stroke";Msn.Drawing.MapSymbol.prototype.stroke_on="true";Msn.Drawing.MapSymbol.prototype.stroke_joinstyle="miter";Msn.Drawing.MapSymbol.prototype.stroke_endcap="round";Msn.Drawing.MapSymbol.prototype.stroke_opacity="100%";Msn.Drawing.MapSymbol.prototype.stroke_color="#0000FF";Msn.Drawing.MapSymbol.prototype.stroke_weight="2pt";Msn.Drawing.MapSymbol.prototype.stroke_style="Single";Msn.Drawing.MapSymbol.prototype.stroke_filltype="solid";Msn.Drawing.MapSymbol.prototype.stroke_color2="red";Msn.Drawing.MapSymbol.prototype.stroke_dashstyle="Solid";Msn.Drawing.MapSymbol.prototype.stroke_startarrow="none";Msn.Drawing.MapSymbol.prototype.stroke_startarrowwidth="medium";Msn.Drawing.MapSymbol.prototype.stroke_startarrowlength="medium";Msn.Drawing.MapSymbol.prototype.stroke_endarrow="none";Msn.Drawing.MapSymbol.prototype.stroke_endarrowwidth="medium";Msn.Drawing.MapSymbol.prototype.stroke_endarrowlength="medium";Msn.Drawing.MapSymbol.prototype.fill_drawtype="v:fill";Msn.Drawing.MapSymbol.prototype.fill_color="#008000";Msn.Drawing.MapSymbol.prototype.fill_colors="30% yellow";Msn.Drawing.MapSymbol.prototype.fill_color2="blue";Msn.Drawing.MapSymbol.prototype.fill_type="solid";Msn.Drawing.MapSymbol.prototype.fill_opacity="30%";Msn.Drawing.MapSymbol.prototype.fill_on="false";Msn.Drawing.MapSymbol.prototype.textbox_drawtype="v:textbox";Msn.Drawing.MapSymbol.prototype.textbox_text="name";Msn.Drawing.MapSymbol.prototype.textbox_color="black";Msn.Drawing.MapSymbol.prototype.textbox_bold=false;Msn.Drawing.MapSymbol.prototype.textbox_italic=false;Msn.Drawing.MapSymbol.prototype.textbox_underscore=false;Msn.Drawing.MapSymbol.prototype.imagedata_on=false;Msn.Drawing.MapSymbol.prototype.imagedata_src="http://i2.microsoft.com/h/en-us/i/msnlogo.gif";Msn.Drawing.MapSymbol.prototype.Clone=function(){var a=new Msn.Drawing.MapSymbol;a.point_type=this.point_type;a.name=this.name;a.line_color=this.line_color;a.line_width=this.line_width;a.line_dasharray=this.line_dasharray;a.highlight_stroke_color=this.highlight_stroke_color;a.highlight_fill_color=this.highlight_fill_color;a.shape_drawtype=this.shape_drawtype;a.shape_fill=this.shape_fill;a.shape_filled=this.shape_filled;a.shape_unselectable=this.shape_unselectable;a.style_zIndex=this.style_zIndex;a.style_position=this.style_position;a.style_filter=this.style_filter;a.style_width=this.style_width;a.style_height=this.style_height;a.style_visibility=this.style_visibility;a.style_display=this.style_display;a.stroke_drawtype=this.stroke_drawtype;a.stroke_on=this.stroke_on;a.stroke_joinstyle=this.stroke_joinstyle;a.stroke_endcap=this.stroke_endcap;a.stroke_opacity=this.stroke_opacity;a.stroke_color=this.stroke_color;a.stroke_weight=this.stroke_weight;a.stroke_style=this.stroke_style;a.stroke_filltype=this.stroke_filltype;a.stroke_color2=this.stroke_color2;a.stroke_dashstyle=this.stroke_dashstyle;a.stroke_startarrow=this.stroke_startarrow;a.stroke_startarrowwidth=this.stroke_startarrowwidth;a.stroke_startarrowlength=this.stroke_startarrowlength;a.stroke_endarrow=this.stroke_endarrow;a.stroke_endarrowwidth=this.stroke_endarrowwidth;a.stroke_endarrowlength=this.stroke_endarrowlength;a.fill_drawtype=this.fill_drawtype;a.fill_color=this.fill_color;a.fill_colors=this.fill_colors;a.fill_color2=this.fill_color2;a.fill_type=this.fill_type;a.fill_opacity=this.fill_opacity;a.fill_on=this.fill_on;a.textbox_drawtype=this.textbox_drawtype;a.textbox_text=this.textbox_text;a.textbox_color=this.textbox_color;a.textbox_bold=this.textbox_bold;a.textbox_italic=this.textbox_italic;a.textbox_underscore=this.textbox_underscore;a.imagedata_on=this.imagedata_on;a.imagedata_src=this.imagedata_src;return a};function VE_MapLineClip(){var b=-360,c=360,d=-180,e=180,a={LEFT:1,RIGHT:2,BOTTOM:4,TOP:8};function h(i,s,u,t,v){b=s;c=t;d=u;e=v;if(typeof i=="undefined"||i==null||i.length<4)return null;var m=false,o=i.length;if(i[o-2]==i[0]&&i[o-1]==i[1])m=true;var f=[];for(var l=0;l<i.length;l++)f.push(i[l]);var k=a.LEFT;while(k<=8){var q=f[f.length-2],r=f[f.length-1];f.push(q);f.push(r);var h=[],p=f.length;for(var j=0;j<p-2;j=j+2)g(h,k,f[j],f[j+1],f[j+2],f[j+3]);if(m){var n=h.length;if(h[n-2]!=h[0]||h[n-1]!=h[1]){h.push(h[0]);h.push(h[1])}}f=null;k=k*2;f=h}return f}function g(g,j,h,i,k,l){var n=f(h,i),o=f(k,l);if((j&n)==0&&(j&o)==0){g.push(h);g.push(i)}else if((j&n)==0||(j&o)==0){var m=(j&n)==0?true:false;if(j==a.LEFT){var q=i+(l-i)*(b-h)/(k-h);if(m){g.push(h);g.push(i)}g.push(b);g.push(q)}else if(j==a.RIGHT){q=i+(l-i)*(c-h)/(k-h);if(m){g.push(h);g.push(i)}g.push(c);g.push(q)}else if(j==a.TOP){var p=h+(k-h)*(e-i)/(l-i);if(m){g.push(h);g.push(i)}g.push(p);g.push(e)}else if(j==a.BOTTOM){p=h+(k-h)*(d-i)/(l-i);if(m){g.push(h);g.push(i)}g.push(p);g.push(d)}};}function f(g,h){var f=0;if(g<b)f=f|a.LEFT;else if(g>c)f=f|a.RIGHT;if(h<d)f=f|a.BOTTOM;else if(h>e)f=f|a.TOP;return f}this.Clip=h}VE_LineClip=new VE_MapLineClip;var L_GraphicsInitError_Text="Your Web browser does not support SVG or VML. Some graphics features may not function properly.";RegisterNamespaces("Msn.Drawing");Msn.Drawing.Graphic=function(){};Msn.Drawing.Graphic.CreateGraphic=function(f,b){if(document.all)return new Msn.Drawing.VMLGraphic(f,b);else{var c=0,e=0,g=new RegExp("Firefox/(.*)"),d=g.exec(navigator.userAgent);if(d[1]){var a=d[1].split(".");if(a){c=a[0];e=a[1];if(parseInt(c)>0&&parseInt(e)>=5)return new Msn.Drawing.SVGGraphic(f,b)}}throw new Msn.Drawing.Exception(L_GraphicsInitError_Text)}};Msn.Drawing.BaseGraphic=function(){this._stroke=new Msn.Drawing.Stroke};Msn.Drawing.BaseGraphic.prototype.CreatePrimitive=function(){};Msn.Drawing.BaseGraphic.prototype.DrawPrimitive=function(d,c,a){var b=new Msn.Drawing.MapSymbol;if(a._stroke){b.stroke_weight=a._stroke.width;b.joinstyle=a._stroke.linejoin;b.stroke_color=a._stroke.color.ToHexString();b.stroke_dashstyle=a._stroke.linecap;b.stroke_opacity=a._stroke.color.A.toString();b.fill_color=a._stroke.fillcolor.ToHexString();b.fill_opacity=a._stroke.fillcolor.A.toString()}c.symbol=b;var e=a.CreatePrimitive(d,c,"");return e};Msn.Drawing.BaseGraphic.prototype.SetStroke=function(a){this._stroke=a};Msn.Drawing.VMLGraphic=function(c,d){Msn.Drawing.BaseGraphic.call();var g=new Msn.Drawing.Color(255,0,0,1),f=new Msn.Drawing.Color(255,0,0,1),e=1,a=c;c.unselectable="on";var b=[];this.DrawPrimitive=function(e){var c=Msn.Drawing.VMLGraphic.prototype.DrawPrimitive(d,e,this);if(a&&c){a.appendChild(c);b.push(c)}};this.resetOffset=function(){};this.SetZIndex=function(a){e=a};this.Clear=function(){var a=null,c=null;while(a=b.pop()){c=a.parentElement;if(c)c.removeChild(a);a=null}};this.Destroy=function(){this.Clear();a=null}};Msn.Drawing.VMLGraphic.prototype=new Msn.Drawing.BaseGraphic;Msn.Drawing.VMLGraphic.prototype.CreatePrimitive=function(d,a){var b=null;if(a.type==MC_GEO_TYPE_POINT){if(a.symbol.shape_drawtype=="v:oval"||a.symbol.shape_drawtype=="v:rect"||a.symbol.shape_drawtype=="v:roundrect")b=document.createElement(a.symbol.shape_drawtype);else b=document.createElement("v:roundrect");var f=LatLongtoRoundedPixel(d,a.points[1],a.points[0]);b.style.width=a.symbol.style_width;b.style.height=a.symbol.style_height;b.style.left=-5+f.x+d.GetOffsetX()+"px";b.style.top=-5+f.y+d.GetOffsetY()+"px";b.style.position=a.symbol.style_position}else{b=document.createElement("v:shape");var g=null;g=GetVmlPath(d,a);var h=d.GetMapWidth(),i=d.GetMapHeight();b.style.top=d.GetOffsetY()+"px";b.style.left=d.GetOffsetX()+"px";b.style.width=h+"px";b.style.height=i+"px";b.coordsize=h+" "+i;b.style.position=a.symbol.style_position;b.path=g}b.id=a.id!=0?a.id:a.iid;b.style.zIndex=a.symbol.style_zIndex;b.unselectable=a.symbol.shape_unselectable;var c=document.createElement("v:stroke");c.joinstyle=a.symbol.stroke_joinstyle;c.endcap=a.symbol.stroke_endcap;c.opacity=a.symbol.stroke_opacity;c.dashstyle=a.symbol.stroke_dashstyle;c.filltype=a.symbol.stroke_filltype;c.color2=a.symbol.stroke_color2;c.color=a.symbol.stroke_color;c.weight=a.symbol.stroke_weight;c.linestyle=a.symbol.stroke_style;if(a.type==MC_GEO_TYPE_POLYGON){var e=document.createElement("v:fill");e.color=a.symbol.fill_color;e.colors=a.symbol.fill_colors;e.color2=a.symbol.fill_color2;e.type=a.symbol.fill_type;e.opacity=a.symbol.fill_opacity;b.appendChild(e)}else if(a.type==MC_GEO_TYPE_POLYLINE){b.fill=false;b.filled=false}else if(a.type==MC_GEO_TYPE_POINT){b.style.filter=a.symbol.style_filter;b.style.zIndex=a.symbol.style_zIndex;b.style.display=a.symbol.style_display;b.unselectable=a.symbol.shape_unselectable;b.fill=true;b.filled=true;b.fillcolor=a.symbol.fill_color}b.appendChild(c);return b};Msn.Drawing.SVGGraphic=function(c,b){Msn.Drawing.BaseGraphic.call();var g=new Msn.Drawing.Color(255,0,0,1),f=new Msn.Drawing.Color(0,255,0,1);_curmap=b;this._svgLayer=null;var d=60,e=c,a=[];this.DrawPrimitive=function(d){var c=Msn.Drawing.SVGGraphic.prototype.DrawPrimitive(b,d,this);if(c)a.push(c)};this.resetOffset=function(){_curmap.resetSvgLayer()};this.SetZIndex=function(a){d=a;if(this._svgLayer!=null)this._svgLayer.SetZIndex(a)};this.Destroy=function(){this.Clear()};this.Clear=function(){if(this._svgLayer==null)return;var b=null,c=null;while(b=a.pop()){c=b.parentNode;if(c)c.removeChild(b);b=null}}};Msn.Drawing.SVGGraphic.prototype=new Msn.Drawing.BaseGraphic;Msn.Drawing.SVGGraphic.prototype.CreatePrimitive=function(a,b,c){this._svgLayer=a.getSvgLayer();return this._svgLayer.addShape(b,c)};Msn.Drawing.SvgLayer=function(e,f){var c=f,b=null,d=false,g=false;if(d==false){d=true;b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("height","100%");b.setAttribute("width","100%");e.appendChild(b);this.lineDashStyles=[];var a=this.lineDashStyles;a[0]=new Array("Solid","none");a[1]=new Array("ShortDash","6,2");a[2]=new Array("ShortDot","2,2");a[3]=new Array("ShortDashDot","6,2,2,2");a[4]=new Array("ShortDashDotDot","6,2,2,2,2,2");a[5]=new Array("Dot","2,6");a[6]=new Array("Dash","10,6");a[7]=new Array("LongDash","20,6");a[8]=new Array("DashDot","10,6,2,6");a[9]=new Array("LongDashDot","20,6,2,6");a[10]=new Array("LongDashDotDot","20,6,2,6,2,6")}this.addShape=function(d){if(b==null)return;var a=null;if(d.type==MC_GEO_TYPE_POINT){a=document.createElementNS("http://www.w3.org/2000/svg","rect");var h=LatLongtoRoundedPixel(c,d.points[1],d.points[0]);a.setAttribute("x",h.x-6);a.setAttribute("y",h.y-6);a.setAttribute("width","6pt");a.setAttribute("height","6pt");a.setAttribute("stroke-width",d.symbol.stroke_weight);a.setAttribute("stroke",d.symbol.stroke_color);a.setAttribute("fill",d.symbol.fill_color);b.appendChild(a)}else if(d.type==MC_GEO_TYPE_POLYLINE||d.type==MC_GEO_TYPE_POLYGON){a=document.createElementNS("http://www.w3.org/2000/svg","polyline");a.setAttribute("points",GetSvgPath(c,d.points));a.setAttribute("stroke",d.symbol.stroke_color);a.setAttribute("stroke-width",d.symbol.stroke_weight);var g=this.lineDashStyles;for(var f=0;f<g.length;f++)if(d.symbol.stroke_dashstyle==g[f][0])a.setAttribute("stroke-dasharray",g[f][1]);if(d.type==MC_GEO_TYPE_POLYLINE)a.setAttribute("fill","none");else{a.setAttribute("fill",d.symbol.fill_color);var e=d.symbol.fill_opacity;if(e.indexOf("%")>1){e=parseInt(d.symbol.fill_opacity);if(e==NaN)e=0.3;else e/=100}a.setAttribute("fill-opacity",e)}}if(a){a.setAttribute("id",d.id!=0?d.id:d.iid);b.appendChild(a)}return a};this.SetZIndex=function(a){if(!c.bShowSVG)return;c.GetsvgDiv().style.zIndex=a}};function GetSvgPath(f,c){var b="",a=0,d=c.length/2,g=0;while(a<d){var e=LatLongtoRoundedPixel(f,c[a*2+1],c[a*2]);b=b.concat(e.x,",",e.y);a++;if(a<d)b+=","}return b}function LatLongtoRoundedPixel(b,d,e){var c;if(typeof VEMap!="undefined"&&VEMap.prototype.isPrototypeOf(b))c=new VELatLong(d,e);else c=new Msn.VE.LatLong(d,e);var a=b.LatLongToPixel(c,b.GetZoomLevel());if(!a)return null;a.x=MathRound(a.x);a.y=MathRound(a.y);return a}function GetVmlPath(g,a){var c=a.points;if(!c)return null;var e="m ",b=0,h=c.length;if(h>=4){var d=LatLongtoRoundedPixel(g,c[b*2+1],c[b*2]);if(!d)return null;e=e.concat(d.x,",",d.y," ","l ");++b}var f=false;if(a.type!=MC_GEO_TYPE_POINT)if(a.minX==null||a.minY==null||a.maxX==null||a.maxY==null){f=false;a.minX=360;a.minY=360;a.maxX=-360;a.maxY=-360}else f=true;while(b<h/2){if(!f){a.minX=Math.min(a.minX,c[b*2]);a.minY=Math.min(a.minY,c[b*2+1]);a.maxX=Math.max(a.maxX,c[b*2]);a.maxY=Math.max(a.maxY,c[b*2+1]);}d=LatLongtoRoundedPixel(g,c[b*2+1],c[b*2]);if(!d)return null;e=e.concat(d.x,",",d.y," ");++b}e+=" e";return e}function GetCurrentMapViewBounds(b){var o=b.GetCenterLongitude(),p=b.GetCenterLatitude(),a=b.LatLongToPixel(new Msn.VE.LatLong(p,o)),h=b.GetMapWidth(),g=b.GetMapHeight();if(!a||isNaN(a.x)||isNaN(a.y))return new Msn.VE.Bounds(0,0,-Infinity,-Infinity,Infinity,Infinity);var l,n,k,m,j=false,q=b.GetMapStyle(),c=b.PixelToLatLong(new Msn.VE.Pixel(a.x-h/2,a.y+g/2)),d=b.PixelToLatLong(new Msn.VE.Pixel(a.x+h/2,a.y-g/2));if(q=="o"){var e=b.PixelToLatLong(new Msn.VE.Pixel(a.x-h/2,a.y-g/2)),f=b.PixelToLatLong(new Msn.VE.Pixel(a.x+h/2,a.y+g/2));if(c!=null&&d!=null&&e!=null&&f!=null){l=Math.min(c.longitude,d.longitude,e.longitude,f.longitude);n=Math.min(c.latitude,d.latitude,e.latitude,f.latitude);k=Math.max(c.longitude,d.longitude,e.longitude,f.longitude);m=Math.max(c.latitude,d.latitude,e.latitude,f.latitude)}else j=true}else if(c!=null&&d!=null){l=Math.min(c.longitude,d.longitude);n=Math.min(c.latitude,d.latitude);k=Math.max(c.longitude,d.longitude);m=Math.max(c.latitude,d.latitude)}else j=true;var i=null;if(j)i=new Msn.VE.Bounds(0,0,-Infinity,-Infinity,Infinity,Infinity);else i=new Msn.VE.Bounds(0,0,l,n,k,m);return i}function GetBufferedMapViewBounds(b,a){var c=null,e=Math.abs(a.x2-a.x1),d=Math.abs(a.y2-a.y1);c=new Msn.VE.Bounds(0,0,a.x1-b*e,a.y1-b*d,a.x2+b*e,a.y2+b*d);return c}function IsContainedInView(a,b){var c=false;if(b.x1>a.x1&&b.y1>a.y1&&b.x2<a.x2&&b.y2<a.y2)c=true;return c}Msn.Drawing.ComputeBoundingBox=function(a){if(typeof a=="undefined"||a==null||a.length==0)return null;var c=[],f=Infinity,g=Infinity,d=-Infinity,e=-Infinity;for(var b=0;b<a.length;b=b+2){f=Math.min(f,a[b]);g=Math.min(g,a[b+1]);d=Math.max(d,a[b]);e=Math.max(e,a[b+1]);}c[0]=f;c[1]=g;c[2]=d;c[3]=e;return c};function IsBoundsIntersect(a,b){if(a==null)return true;if(b==null)return true;if(a.x2<b.x1||a.x1>b.x2||a.y2<b.y1||a.y1>b.y2)return false;return true}function IsRecIntersect(c,d,a,b,g,h,e,f){if(a<g||c>e||b<h||d>f)return false;return true}RegisterNamespaces("Msn.VE");$MVEM=new function(){this.IsEnabled=function(a){if(a==undefined)throw new VEException("$MVEM.IsEnabled","err_invalidfeature","Specified feature is invalid.");return a}};function VEException(b,c,a){this.source=b;this.name=c;this.message=a}VEException.prototype.Name=this.name;VEException.prototype.Source=this.source;VEException.prototype.Message=this.message;if(typeof registerNamespace!="undefined")registerNamespace("Microsoft.Web.UI");else{if(typeof Microsoft=="undefined")Microsoft={};if(typeof Microsoft.Web=="undefined")Microsoft.Web={};if(typeof Microsoft.Web.UI=="undefined")Microsoft.Web.UI={}}Microsoft.Web.UI.IEGlyphStates={Unselected:"-unselected",Hover:"-hover",Pressed:"-pressed"};Microsoft.Web.UI.IEGlyph=function(j,l){var k=Microsoft.Web.UI,a,d,c,b;m();function m(){a=document.createElement("div");if(j)a.id=j;b=l||"ieglyph";d=b+k.IEGlyphStates.Hover;c=b+k.IEGlyphStates.Pressed;a.className=b;if(!document.all)return;a.attachEvent("onmouseover",e);a.attachEvent("onmousedown",i);a.attachEvent("onmouseup",e);a.attachEvent("onmouseout",f);window.attachEvent("onunload",n)}this.getElement=function(){return a};this.setContent=function(b){a.innerHTML=b};function n(){a.detachEvent("onmouseover",e);a.detachEvent("onmousedown",i);a.detachEvent("onmouseup",e);a.detachEvent("onmouseout",f);a=null;d=null;c=null;b=null}function e(){f();h(d)}function i(){h(c)}function f(){g(d);g(c)}function h(b){a.className+=" "+b}function g(b){var c=new RegExp(" "+b,"g");a.className=a.className.replace(c,"")}};RegisterNamespaces("Msn.VE");Msn.VE.PushPinTypes={Default:0,SearchResult:1,Annotation:2,Direction:3,DirectionTemp:4,TrafficLight:5,TrafficOthers:6,YouAreHere:7,AdStandard:8,AdWide:9,AdCategory:10,AdRoofStandard:11,AdRoofWide:12,DirectionStep:13};Msn.VE.MapActionMode={ModeUnknown:0,Mode2D:1,Mode3D:2,ModeOblique:3};Msn.VE.MapControl=function(p_elSource,p_htParams,p_parentAPIControl){var offsetMeters=20971520,baseMetersPerPixel=163840,buffer=0,animatedMovementEnabled=true,zoomTotalSteps=6,keyboardPanSpeed=15,panToLatLongSpeed=15,earthRadius=6378137,earthCircumference=earthRadius*2*Math.PI,projectionOffset=earthCircumference*0.5,minZoom=1,maxZoom=19,emptyTile="http://virtualearth.msn.com/i/spacer.gif",minLatitude=-85,maxLatitude=85,minLongitude=-180,maxLongitude=180,tileSize=256,generations=new Object,vemanifestdomain="http://maps.live.com",zoomLevelToAdjustObliqueToOrthro=18,kbInputZIndex=0,containerZIndex=0,mapZIndex=1,swapZIndex=1,baseZIndex=2,debugZIndex=3,baseZIndex=11,topZIndex=20,p_this=this,roadStyle="r",hybridStyle="h",aerialStyle="a",obliqueStyle="o",mapTiles="Road",trafficTiles="Traffic",marketMaxZoom=1,currentView=new Msn.VE.MapView(p_this),preferredView=new Msn.VE.MapView(p_this),previousZoomLevel=1,previousCenter=null,lastViewChangeType=null,previousMapStyle=null,lastOrthoZoomLevel=15,lastOrthoMapStyle=roadStyle,x=0,y=0,width=0,height=0,trafficAvailable=false,tileLayerManager=new VETileLayerManager,originX=0,originY=0,offsetX=0,offsetY=0,tileViewportX1=0,tileViewportY1=0,tileViewportX2=0,tileViewportY2=0,tileViewportWidth=0,tileViewportHeight=0,dragging=false,keyboardPan=false,lastMouseX=0,lastMouseY=0,zooming=false,zoomCounter=0,panning=false,panCounter=0,panningX=0,panningY=0,panLatitude=null,panLongitude=null,pushpins=[],lines=[],map=document.createElement("div"),keyboard=document.createElement("input");keyboard.id="wl_ve_mapInput";var logo=null,scaleBar=null,copyright=null,dashboardContainer=null,dashboard=null,boxTool=null,panTool=null,currentTool=null,orthoMode=null,obliqueMode=null,threeDMode=null,currentMode=null,previousMode=null,Initialized2D=false,currentBounds=null,eventTable=[],debug=false,graphicCanvas=null,svgLayer=null,svgDiv=null,bShowSVG=true;this.GetsvgDiv=function(){return svgDiv};var mapCenterOffset=new Msn.VE.Pixel(0,0),resizeInProgress=false,view3DCreated=false,spacecontrol=false,spacediv=null,spaceCameraIsFlying=false,init3dparam=null,resizeTimer=null,traffic3dAdded=false,initial3dView=null,cameraUpdateCount=0;function SetChildDiv(a){map.appendChild(a)}function EnableGeoCommunity(a){hijackMouseMove=a}function IsGeoCommunityEnabled(){return hijackMouseMove}function GetOffsetX(){return offsetX}function GetOffsetY(){return offsetY}this.Init=function(){generations[roadStyle]=51;generations[aerialStyle]=51;generations[hybridStyle]=51;generations[obliqueStyle]=51;orthoMode=new OrthoMode;orthoMode.Init();if(p_htParams.obliqueEnabled&&p_htParams.obliqueUrl){obliqueMode=new ObliqueMode;obliqueMode.Init(p_htParams.obliqueUrl)}if(typeof view3DMode!="undefined"){threeDMode=new ThreeDMode;threeDMode.Init()}UpdateFromParent();map.className="Map";map.style.zIndex=mapZIndex;p_elSource.appendChild(map);keyboard.className="KeyboardInput";p_elSource.appendChild(keyboard);if(!p_htParams.fixedView){p_elSource.attachEvent("onmousedown",MouseDown);p_elSource.attachEvent("onmouseup",MouseUp);p_elSource.attachEvent("onmousemove",MouseMove);p_elSource.attachEvent("onmousewheel",MouseWheel);p_elSource.attachEvent("ondblclick",MouseDoubleClick);p_elSource.attachEvent("oncontextmenu",ContextMenu);if(window.addEventListener&&navigator.product&&navigator.product=="Gecko")p_elSource.addEventListener("DOMMouseScroll",MouseWheel,false);buffer=tileSize}if(p_htParams.buffer!=undefined&&p_htParams.buffer!=null)buffer=p_htParams.buffer;var startIn3DMode=false;if(window.navigator.userAgent.indexOf("MSIE")!=-1)if(p_htParams.mapMode!="undefined"&&p_htParams.mapMode!=null&&p_htParams.mapMode==Msn.VE.MapActionMode.Mode3D||p_htParams.altitude&&p_htParams.altitude>-1000||p_htParams.tilt&&p_htParams.tilt!=-90||p_htParams.direction&&p_htParams.direction!=0){SetMapTiles();startIn3DMode=true;currentMode=threeDMode}init3dparam=p_htParams.mapGUID;if(p_htParams.latitude!=null&&p_htParams.longitude!=null&&p_htParams.zoomlevel!=null&&p_htParams.mapstyle!=null)try{var initialView=new Msn.VE.MapView(p_this);initialView.SetMapStyle(ValidateMapStyle(p_htParams.mapstyle),p_htParams.obliqueSceneId);if(p_htParams.boundingBox){initialView.SetLatLongRectangle(p_htParams.boundingBox);if(startIn3DMode)initialView.Resolve(orthoMode,width,height)}else{initialView.SetZoomLevel(eval(p_htParams.zoomlevel));initialView.SetCenterLatLong(new Msn.VE.LatLong(eval(p_htParams.latitude),eval(p_htParams.longitude)))}if(p_htParams.altitude)initialView.SetAltitude(p_htParams.altitude);if(p_htParams.tilt)initialView.SetTilt(p_htParams.tilt);if(p_htParams.direction)initialView.SetDirection(p_htParams.direction);if(!startIn3DMode)SetMapTiles();currentView=initialView}catch(a){if(!startIn3DMode)SetDefaultView();else currentView=initialView}else if(!startIn3DMode)SetDefaultView();else currentView=initialView;if(p_htParams.showDashboard){if(p_htParams.showMapModeSwitch!=false)p_htParams.showMapModeSwitch=true;CreateDashboard(p_htParams.dashboardX,p_htParams.dashboardY,p_htParams.dashboardSize,p_htParams.dashboardId,p_htParams.showMapModeSwitch)}if(startIn3DMode)this.Init3DOnly();else this.Init2DOnly();if(typeof p_htParams.hideCopyright=="undefined"||!p_htParams.hideCopyright){copyright=new Copyright(p_elSource);copyright.Init();copyright.Update()}if(startIn3DMode)copyright.Hide()};this.Init2DOnly=function(a){mvcViewFacade.OnSwitchToFlatlandView();if(!p_htParams.fixedView){boxTool=new BoxTool;boxTool.Init();panTool=new PanTool;panTool.Init();currentTool=panTool;keyboard.attachEvent("onkeydown",KeyDown);keyboard.attachEvent("onkeyup",KeyUp);keyboard.attachEvent("onblur",StopKeyboardPan);p_elSource.attachEvent("onmousewheel",MouseWheel);if(window.addEventListener&&navigator.product&&navigator.product=="Gecko")p_elSource.addEventListener("DOMMouseScroll",MouseWheel,false)}if(!p_htParams.disableLogo){logo=new Logo(p_elSource);logo.Init()}if(typeof copyright!="undefined"&&copyright!=null)copyright.Show();if(p_htParams.showScaleBar){scaleBar=new ScaleBar(p_elSource);scaleBar.Init();scaleBar.SetOffset(0,10);AttachEvent("onendzoom",scaleBar.Update);AttachEvent("onendcontinuouspan",scaleBar.Update);AttachEvent("onresize",scaleBar.Reposition)}if(obliqueMode&&currentMode!=obliqueMode)obliqueMode.UpdateAvailability();try{graphicCanvas=Msn.Drawing.Graphic.CreateGraphic(map,this);graphicCanvas.SetZIndex(17)}catch(b){}tileLayerManager.Active=true;SetMapTiles();if(currentView==null)SetDefaultView();else{if(a==true||!Initialized2D){SetView(currentView);Initialized2D=true}SetView(null)}Fire("oninitmode",Msn.VE.MapActionMode.Mode2D)};this.Init3DOnly=function(){if(dashboardContainer){obliqueNotification.style.display="none";if(typeof threeDNotification!="undefined")threeDNotification.style.display="none";UpdateIFrameShim(dashboardContainer)}var b;try{if(currentView==null)b=SetDefaultView();else{var a=currentView.MakeCopy();if(currentView.mapStyle==obliqueStyle){a.SetMapStyle(lastOrthoMapStyle);a.SetZoomLevel(a.GetZoomLevel()+zoomLevelToAdjustObliqueToOrthro)}a.SetCenterLatLong(new Msn.VE.LatLong(currentView.latlong.latitude,currentView.latlong.longitude));b=SetView(a)}}catch(d){b=false}if(!b){this._Disable3DMode(true);return}if(!view3DCreated)return;mvcViewFacade.OnSwitchToView3D(spacecontrol);if(typeof p_htParams.hideCopyright=="undefined"||!p_htParams.hideCopyright)spacecontrol.ShowCopyright=true;if(typeof copyright!="undefined"&&copyright!=null)copyright.Hide();if(p_htParams.showScaleBar)spacecontrol.ShowScale=true;if(window.locale){spacecontrol.CurrentLocale=window.locale;spacecontrol.DisplayMetricUnits=MapControl.Features.ScaleBarKilometers}var c="Road";if(currentView.mapStyle=="a"){c="Aerial";spacecontrol.ShowAtmosphere=true}if(currentView.mapStyle=="h"){c="Hybrid";spacecontrol.ShowAtmosphere=true}if(currentView.mapStyle=="r"){spacecontrol.TexturesVisible=false;if(spacecontrol.HardwareClassificationLevel<3)c="LowRoad";spacecontrol.ShowAtmosphere=false}else spacecontrol.TexturesVisible=true;spacecontrol.AddImageSource("Terrain","Texture",vemanifestdomain+"/Manifests/"+c+"ContentManifest.xml",0,1);if(3==spacecontrol.HardwareClassificationLevel){spacecontrol.AddElevationSource("Terrain","DEM",vemanifestdomain+"/Manifests/HighDemContentManifest.xml",0);spacecontrol.AddModelSource("Model","Model",vemanifestdomain+"/Manifests/ModelContentManifest.xml")}else if(2==spacecontrol.HardwareClassificationLevel){spacecontrol.AddElevationSource("Terrain","DEM",vemanifestdomain+"/Manifests/DemContentManifest.xml",0);spacecontrol.AddModelSource("Model","Model",vemanifestdomain+"/Manifests/MedModelContentManifest.xml")}else spacecontrol.AddElevationSource("Terrain","DEM",vemanifestdomain+"/Manifests/DemContentManifest.xml",0);tileLayerManager.AddAllTileSourcesTo3D(spacecontrol);spacecontrol.AttachEvent("OnCameraChanged","OnView3DUpdateViewpoint");spacecontrol.AttachEvent("OnHardwareCapabilitiesUpdate","OnHardwareCapabilitiesUpdate");spacecontrol.AttachEvent("OnBeginCameraChange","OnBeginFlyTo");if(!p_htParams.fixedView){spacecontrol.AttachEvent("OnHover","OnView3DPushpinHover");spacecontrol.AttachEvent("OnHoverEnd","OnView3DHoverEnd");spacecontrol.AttachEvent("OnDropGeometry","OnView3DDropGeometry");spacecontrol.AttachEvent("OnLatLonAltClicked","OnView3DLatLonAltClicked");spacecontrol.AttachEvent("OnMouseDown","OnMouseDown3D");spacecontrol.AttachEvent("OnMouseUp","OnMouseUp3D");spacecontrol.AttachEvent("OnClick","OnClick3D")}else spacecontrol.FixedView=true;traffic3dAdded=false;VE_TrafficManager.GetTrafficInfo(false);if(typeof VE_BrandFinderAdManager!="undefined"&&VE_BrandFinderAdManager!=null)VE_BrandFinderAdManager._ClearPins();if(!init3dparam)Relay3DPushpins();Fire("oninitmode",Msn.VE.MapActionMode.Mode3D)};this.ShowSVG=function(a){bShowSVG=a};this.getSvgLayer=function(){if(svgLayer==null){svgDiv=document.createElement("div");svgDiv.style.position="absolute";if(bShowSVG)svgDiv.style.zIndex=60;else svgDiv.style.zIndex=-1;this.resizeSVG();map.appendChild(svgDiv);svgLayer=new Msn.Drawing.SvgLayer(svgDiv,this)}return svgLayer};this.resetSvgLayer=function(){this.getSvgLayer();svgDiv.style.top=-parseInt(map.style.top)+"px";svgDiv.style.left=-parseInt(map.style.left)+"px"};this.resizeSVG=function(){if(svgDiv!=null){var b=GetWindowWidth(),a=GetWindowHeight();svgDiv.style.top="0px";svgDiv.style.left="0px";svgDiv.style.width=b+"px";svgDiv.style.height=a+"px"}};this.GetGraphic=function(){return graphicCanvas};this.GetDashboard=function(){return dashboard};this.Destroy=function(){if(copyright){copyright.Destroy();copyright=null}if(currentMode==threeDMode&&currentMode!=null)this.Destroy3DOnly();else{this.Destroy2DOnly();while(pushpins.length)pushpins.pop().Destroy();ClearLines()}if(!p_htParams.fixedView){p_elSource.detachEvent("onmousedown",MouseDown);p_elSource.detachEvent("onmouseup",MouseUp);p_elSource.detachEvent("onmousemove",MouseMove);p_elSource.detachEvent("ondblclick",MouseDoubleClick);p_elSource.detachEvent("oncontextmenu",ContextMenu)}if(dashboard){dashboard.Destroy();dashboard=null}if(dashboardContainer){dashboardContainer.detachEvent("onmousedown",IgnoreEvent);dashboardContainer.detachEvent("onmouseup",IgnoreEvent);dashboardContainer.detachEvent("onmousemove",DashboardContainerMouseMoveEvent);dashboardContainer.detachEvent("onmousewheel",IgnoreEvent);dashboardContainer.detachEvent("ondblclick",IgnoreEvent);dashboardContainer.detachEvent("oncontextmenu",IgnoreEvent);dashboardContainer.detachEvent("onkeydown",IgnoreEvent);dashboardContainer.detachEvent("onkeyup",IgnoreEvent);p_elSource.removeChild(dashboardContainer);dashboardContainer=null}if(orthoMode){orthoMode.Destroy();orthoMode=null}if(obliqueMode){obliqueMode.Destroy();obliqueMode=null}if(threeDMode){threeDMode.Destroy();threeDMode=null}DestroyEventTable();p_elSource=p_this=null};this.Destroy2DOnly=function(){if(!p_htParams.fixedView){keyboard.detachEvent("onkeydown",KeyDown);keyboard.detachEvent("onkeyup",KeyUp);keyboard.detachEvent("onblur",StopKeyboardPan);p_elSource.detachEvent("onmousewheel",MouseWheel)}tileLayerManager.Active=false;if(scaleBar){DetachEvent("onendzoom",scaleBar.Update);DetachEvent("onendcontinuouspan",scaleBar.Update);DetachEvent("onresize",scaleBar.Reposition);scaleBar.Destroy();scaleBar=null}if(logo){logo.Destroy();logo=null}if(boxTool){boxTool.Destroy();boxTool=null}if(panTool){panTool.Destroy();panTool=null}if(graphicCanvas)graphicCanvas.Destroy();Fire("ondestroymode",Msn.VE.MapActionMode.Mode2D)};this.Destroy3DOnly=function(){view3DCreated=false;try{spacecontrol.Close()}catch(a){}spacecontrol=false;window.status="";if(spacediv!=null){spacediv.removeNode(true);spacediv=null}if(dashboardContainer)destroyIFrameShim(dashboardContainer.id);Fire("ondestroymode",Msn.VE.MapActionMode.Mode3D)};function UpdateFromParent(){x=GetLeftPosition(p_elSource);y=GetTopPosition(p_elSource);width=p_elSource.offsetWidth;height=p_elSource.offsetHeight}function CreateDashboard(d,e,a,b,c){if(!a)a=Msn.VE.DashboardSize.Normal;if(a==Msn.VE.DashboardSize.Tiny)a=Msn.VE.DashboardSize.Small;dashboardContainer=document.createElement("div");if(b==null||typeof b=="undefined")b="dashboard";dashboardContainer.id=b;p_elSource.appendChild(dashboardContainer);dashboardContainer.className="Dashboard Dashboard_"+a;dashboardContainer.style.top=e+"px";dashboardContainer.style.left=d+"px";dashboardContainer.attachEvent("onmousedown",IgnoreEvent);dashboardContainer.attachEvent("onmouseup",IgnoreEvent);dashboardContainer.attachEvent("onmousemove",DashboardContainerMouseMoveEvent);dashboardContainer.attachEvent("onmousewheel",IgnoreEvent);dashboardContainer.attachEvent("ondblclick",IgnoreEvent);dashboardContainer.attachEvent("oncontextmenu",IgnoreEvent);dashboardContainer.attachEvent("onkeydown",IgnoreEvent);dashboardContainer.attachEvent("onkeyup",IgnoreEvent);if(typeof view3DMode!="undefined"){dashboard=new Msn.VE.NavAction(dashboardContainer,p_this,a,c);dashboard.Init()}else{dashboard=new Msn.VE.Dashboard(dashboardContainer,p_this,a);dashboard.Init()}}function DashboardContainerMouseMoveEvent(a){a=GetEvent(a);return false}function SetDefaultView(){var a=new Msn.VE.MapView(p_this);a.SetCenterLatLong(new Msn.VE.LatLong(0,0));a.SetZoomLevel(1);a.SetMapStyle(roadStyle);SetMapTiles();SetView(a);Initialized2D=true}function SetAltitude(b){Sync3dView();var a=currentView.MakeCopy();a.SetAltitude(b);SetView(a)}function SetTilt(b){Sync3dView();var a=currentView.MakeCopy();a.SetTilt(b);SetView(a)}function SetDirection(b){Sync3dView();var a=currentView.MakeCopy();a.SetDirection(b);SetView(a)}function GetCurrentMode(){return currentMode}function GetMapWidth(){return width}function GetMapHeight(){return height}function GetCurrentMapView(){return preferredView.MakeCopy()}function SetCenter(c,b){Sync3dView();var a=preferredView.MakeCopy();a.SetCenterLatLong(new Msn.VE.LatLong(c,b));SetView(a)}function SetMapStyle(b,e,d){Sync3dView();var a=currentView.MakeCopy();a.SetMapStyle(ValidateMapStyle(b),e,d);if(currentView.mapStyle!=b)if(b==obliqueStyle){Fire("onstartmapstyleoblique");a.SetZoomLevel(1);lastOrthoZoomLevel=currentView.zoomLevel;lastOrthoMapStyle=currentView.mapStyle}else if(currentView.mapStyle==obliqueStyle){Fire("onendmapstyleoblique");a.SetZoomLevel(lastOrthoZoomLevel)}var c=currentView.GetCenterLatLong();a.latlong.latitude=c.latitude;a.latlong.longitude=c.longitude;SetView(a)}function SetScaleBarDistanceUnit(a){if(scaleBar!=null){scaleBar.SetDistanceUnit(a);scaleBar.Update()}if(currentMode==threeDMode&&spacecontrol!=null){if(a==null)bUseKilometers=$MVEM.IsEnabled(MapControl.Features.ScaleBarKilometers);else bUseKilometers=a==Msn.VE.DistanceUnit.Kilometers;spacecontrol.DisplayMetricUnits=bUseKilometers}}function ValidateMapStyle(a){if(a==aerialStyle||a==hybridStyle||a==obliqueStyle)return a;else return roadStyle}function GetCenterLatitude(){if(currentMode==threeDMode){if(view3DCreated){var a=spacecontrol.GetCenterLatitude();return isNaN(a)?null:a}return null}else if(currentView!=null&&currentView!="undefined"&&currentView.latlong!=null&&currentView.latlong!="undefined"&&currentView.latlong.latitude!=null&&currentView.latlong.latitude!="undefined")return currentView.GetCenterLatLong().latitude;return null}function GetCenterLongitude(){if(currentMode==threeDMode){if(view3DCreated){var a=spacecontrol.GetCenterLongitude();return isNaN(a)?null:a}return null}else if(currentView!=null&&currentView!="undefined"&&currentView.latlong!=null&&currentView.latlong!="undefined"&&currentView.latlong.longitude!=null&&currentView.latlong.longitude!="undefined")return currentView.GetCenterLatLong().longitude;return null}function ComputeCenterPoint(a){currentView.latlong=currentMode.PixelToLatLong(currentView.center,currentView.zoomLevel);if(a)preferredView.Copy(currentView);if(obliqueMode)obliqueMode.UpdateAvailability()}function GetLatitude(c){var b=new Msn.VE.Pixel(originX+offsetX+width/2,originY+offsetY+c),a=currentMode.PixelToLatLong(b,currentView.zoomLevel);if(!a)return null;return a.latitude}function GetLongitude(c){var b=new Msn.VE.Pixel(originX+offsetX+c,originY+offsetY+height/2),a=currentMode.PixelToLatLong(b,currentView.zoomLevel);if(!a)return null;return a.longitude}function GetY(b){var c=new Msn.VE.LatLong(b,currentView.center.longitude),a=LatLongToPixel(c);if(!a)return null;return MathRound(a.y)}function GetX(b){var c=new Msn.VE.LatLong(currentView.center.latitude,b),a=LatLongToPixel(c);if(!a)return null;return MathRound(a.x)}function LatLongToPixel(b){var a=currentMode.LatLongToPixel(b,currentView.zoomLevel);if(a==null)return null;if(currentMode!=threeDMode){a.x-=originX+offsetX;a.y-=originY+offsetY}return a}function PixelToLatLong(a){var b=new Msn.VE.Pixel(a.x+originX+offsetX,a.y+originY+offsetY);return currentMode.PixelToLatLong(b,currentView.zoomLevel)}function GetZoomLevel(){return currentView.zoomLevel}function GetMapStyle(){return currentView.mapStyle}function GetMapMode(){var a=Msn.VE.MapActionMode.ModeUnknown;if(currentMode!=null)if(currentMode==threeDMode)a=Msn.VE.MapActionMode.Mode3D;else if(currentMode==orthoMode)a=Msn.VE.MapActionMode.Mode2D;else if(currentMode==obliqueMode)a=Msn.VE.MapActionMode.ModeOblique;return a}function GetAltitude(){return currentView.GetAltitude()}function GetTilt(){return currentView.GetTilt()}function GetDirection(){return currentView.GetDirection()}function EnableMode(b,a){switch(b){case Msn.VE.MapActionMode.Mode3D:if(window.navigator.userAgent.indexOf("MSIE")!=-1)if(window.navigator.userAgent.indexOf("Win64")!=-1)ShowIEx64NotSupportedDialog();else this._Enable3DMode(a);else ShowNonIENotSupportedDialog();break;case Msn.VE.MapActionMode.Mode2D:default:this._Disable3DMode(a);UnHidePins();break}}function _Enable3DMode(a){if(currentMode!=threeDMode&&currentMode!=null){previousMode=currentMode;currentMode=threeDMode;this.Destroy2DOnly();if(typeof a!="undefined")init3dparam=a;this.Init3DOnly()}}function _Disable3DMode(a){if(currentMode==threeDMode&&currentMode!=null){previousMode=currentMode;currentMode=orthoMode;this.Destroy3DOnly();this.Init2DOnly(a)}}function Get3DControl(){if(view3DCreated)return spacecontrol;return null}function IsModeEnabled(b){var a=currentMode!=null&&currentMode==threeDMode;switch(b){case Msn.VE.MapActionMode.Mode2D:return !a;break;case Msn.VE.MapActionMode.Mode3D:return a;break}return false}function Get3DVisibleArea(acceptRegionAroundCenter){if(!view3DCreated)return null;var lat1,lon1,lat2,lon2,lat3,lon3,lat4,lon4,aroundcenter,ret=spacecontrol.QueryRegion();eval(ret);if((acceptRegionAroundCenter=="undefined"||acceptRegionAroundCenter==false)&&aroundcenter==1)return null;var points=[];points.push(new Msn.VE.LatLong(lat1,lon1));points.push(new Msn.VE.LatLong(lat2,lon2));points.push(new Msn.VE.LatLong(lat3,lon3));points.push(new Msn.VE.LatLong(lat4,lon4));return points}function Show3DTraffic(a){if(view3DCreated)if(!traffic3dAdded||a){spacecontrol.AddImageSource("Terrain","Traffic",vemanifestdomain+"/Manifests/TrafficContentManifest.xml",1,0.6);traffic3dAdded=true}}function Remove3DTraffic(){if(view3DCreated&&traffic3dAdded){spacecontrol.RemoveImageSource("Terrain","Traffic");traffic3dAdded=false}}function Sync3dView(){if(spacecontrol&&spaceCameraIsFlying)spacecontrol.RaiseCameraChangedEvent()}function OnBeginCameraUpdate(){cameraUpdateCount++;spaceCameraIsFlying=true}function OnEndCameraUpdate(){spaceCameraIsFlying=false}function IsCameraFlying(){return spaceCameraIsFlying}function GetMetersPerPixel(b,a){if(!b)b=currentView.latlong.latitude;if(!a)a=currentView.zoomLevel;return Math.cos(DegToRad(b))*currentMode.MetersPerPixel(a)}function Resize(b,a){if(resizeTimer!=null&&typeof resizeTimer=="number")window.clearTimeout(resizeTimer);p_this.w=b;p_this.h=a;resizeTimer=window.setTimeout(p_this.FireResize,250)}this.FireResize=function(){if(resizeInProgress)return;else resizeInProgress=true;var b=p_this.w,a=p_this.h,d,c;if(!b||b<=0)d="100%";else d=b+"px";if(!a||a<=0)c="100%";else c=a+"px";p_elSource.style.width=d;p_elSource.style.height=c;UpdateFromParent();if(currentMode==null||currentMode!=threeDMode){if(b&&b>=0)width=b;if(a&&a>=0)height=a}PanToView(currentView);if(copyright)copyright.Reposition();if(scaleBar)scaleBar.Reposition();if(logo)logo.Reposition();if(!document.all)p_this.resizeSVG();Fire("onresize")};function IsObliqueAvailable(){return obliqueMode?obliqueMode.IsAvailable():false}function GetObliqueScene(){return obliqueMode?obliqueMode.GetScene():null}function SetAnimationEnabled(a){animatedMovementEnabled=a}function IsAnimationEnabled(){return animatedMovementEnabled&&currentMode!=threeDMode}function SetObliqueScene(a){if(obliqueMode)SetMapStyle(obliqueStyle,a,null)}function SetObliqueOrientation(a){if(obliqueMode)SetMapStyle(obliqueStyle,null,a)}function Debug(a){debug=a}function SetCopyrightOffset(a,b){if(copyright)copyright.SetOffset(a,b);if(scaleBar)scaleBar.SetOffset(a,b)}function SetFocus(){if(currentMode==threeDMode)spacecontrol.Focus();else keyboard.focus()}function StopKeyboardPan(){if(panning&&keyboardPan)StopContinuousPan()}function UpdatePreferredView(){preferredView.Copy(currentView)}function GetCenterOffset(){if(currentMode!=null&&currentMode==threeDMode)return new Msn.VE.Pixel(0,0);return mapCenterOffset}function SetCenterOffset(a){if(typeof a!="undefined"&&a!=null)mapCenterOffset=a}function GetLastViewChangeType(){var a=lastViewChangeType;lastViewChangeType=null;return a}function ShowNonIENotSupportedDialog(){Fire("onerror",CreateEvent(currentView.latlong,currentView.zoomLevel,l262aNt.replace(/%1/g,'<a href="'+L_SupportedBrowserDownloadUrl_Text+'" target="_blank">').replace(/%3/g,L_SupportedBrowserDownloadUrl_Text).replace(/%2/g,"</a>")))}function ShowIEx64NotSupportedDialog(){Fire("onerror",CreateEvent(currentView.latlong,currentView.zoomLevel,l887aOt))}function DelayedHWDialog(){ShowMessage(l572aPt)}function SetShowMapModeSwitch(a){if(dashboard&&dashboard.constructor==Msn.VE.NavAction)dashboard.SetShowMapModeSwitch(a)}function ClipView(b,c){var a=ShiftView(b,c,0,0);if(typeof a!="undefined"&&a!=null)b.SetCenter(new Msn.VE.Pixel(b.center.x+a.x,b.center.y+a.y))}function ShiftView(b,a,c,d){if(a!=null&&a!="undefined"){c=ClipDelta(c,width,b.center.x-width/2,b.zoomLevel,a.z1,a.x1,a.x2);d=ClipDelta(d,height,b.center.y-height/2,b.zoomLevel,a.z1,a.y1,a.y2);return new Msn.VE.Pixel(c,d)}}function ClipDelta(e,c,a,g,f,i,h){var b=tileSize*i*Math.pow(2,g-f),d=tileSize*h*Math.pow(2,g-f);if(c>d-b)return (d-b-c)/2-a+b;else if(a+e<b)return b-a;else if(a+c+e>d)return d-a-c;return e}function VECopyrightTableEntry(b,a,e,f,c,d){this.MinZoomLevel=b;this.MaxZoomLevel=a;this.MinLatitude=e;this.MinLongitude=f;this.MaxLatitude=c;this.MaxLongitude=d}VECopyrightTableEntry.prototype.IsMatch=function(b,c,a){var d=false;if(b>=this.MinZoomLevel&&b<=this.MaxZoomLevel&&(c>=this.MinLatitude&&c<=this.MaxLatitude)&&(a>=this.MinLongitude&&a<=this.MaxLongitude))d=true;return d};function VECopyrightTable(){var b=[];b[Msn.VE.MapStyle.Oblique]=[L_MapControlImageCourtesyOfPictometry_Text,L_MapControlImageCourtesyOfBlom_Text];b[Msn.VE.MapStyle.Road]=[L_MapControlNavteq_Text,L_MapControlImageCourtesyOfAND_Text,L_MapControlImageCourtesyOfMapDataSciences_Text,L_MapControlImageCourtesyOfZenrin_Text];b[Msn.VE.MapStyle.Aerial]=[L_MapControlImageCourtesyOfNASA_Text,L_MapControlHarrisCorp_Text,L_MapControlImageCourtesyOfUSGS_Text,L_MapControlImageCourtesyOfEarthData_Text,L_MapControlImageCourtesyOfGetmapping_Text,L_MapControlImageCourtesyOfGeoEye_Text,L_MapControlImageCourtesyOfPasco_Text];var a=[];a[Msn.VE.MapStyle.Oblique]=[];a[Msn.VE.MapStyle.Oblique][L_MapControlImageCourtesyOfPictometry_Text]=[];a[Msn.VE.MapStyle.Oblique][L_MapControlImageCourtesyOfBlom_Text]=[];a[Msn.VE.MapStyle.Road]=[];a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text]=[];a[Msn.VE.MapStyle.Road][L_MapControlImageCourtesyOfAND_Text]=[];a[Msn.VE.MapStyle.Road][L_MapControlImageCourtesyOfMapDataSciences_Text]=[];a[Msn.VE.MapStyle.Road][L_MapControlImageCourtesyOfZenrin_Text]=[];a[Msn.VE.MapStyle.Aerial]=[];a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfNASA_Text]=[];a[Msn.VE.MapStyle.Aerial][L_MapControlHarrisCorp_Text]=[];a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfUSGS_Text]=[];a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfEarthData_Text]=[];a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGetmapping_Text]=[];a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text]=[];a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfPasco_Text]=[];a[Msn.VE.MapStyle.Oblique][L_MapControlImageCourtesyOfPictometry_Text].push(new VECopyrightTableEntry(1,20,24,-125,49,-66));a[Msn.VE.MapStyle.Oblique][L_MapControlImageCourtesyOfBlom_Text].push(new VECopyrightTableEntry(1,20,49,-11,60,2));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(1,9,-90,-180,90,180));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(10,19,16,-180,90,-50));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(10,19,27,-32,40,-13));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(10,19,35,-11,72,20));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(10,19,21,20,72,32));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(10,17,21.92,113.14,22.79,114.52));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(10,17,21.73,119.7,25.65,122.39));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(10,17,0,98.7,8,120.17));a[Msn.VE.MapStyle.Road][L_MapControlNavteq_Text].push(new VECopyrightTableEntry(10,17,0.86,103.2,1.92,104.45));a[Msn.VE.MapStyle.Road][L_MapControlImageCourtesyOfAND_Text].push(new VECopyrightTableEntry(10,19,-90,-180,90,180));a[Msn.VE.MapStyle.Road][L_MapControlImageCourtesyOfMapDataSciences_Text].push(new VECopyrightTableEntry(5,17,-45,111,-9,156));a[Msn.VE.MapStyle.Road][L_MapControlImageCourtesyOfMapDataSciences_Text].push(new VECopyrightTableEntry(5,17,-49.7,164.42,-30.82,180));a[Msn.VE.MapStyle.Road][L_MapControlImageCourtesyOfZenrin_Text].push(new VECopyrightTableEntry(4,17,23.5,122.5,46.65,151.66));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfNASA_Text].push(new VECopyrightTableEntry(1,8,-90,-180,90,180));a[Msn.VE.MapStyle.Aerial][L_MapControlHarrisCorp_Text].push(new VECopyrightTableEntry(9,13,-90,-180,90,180));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfUSGS_Text].push(new VECopyrightTableEntry(14,19,17.99,-150.11,61.39,-65.57));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfEarthData_Text].push(new VECopyrightTableEntry(14,19,21.25,-158.3,21.72,-157.64));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfEarthData_Text].push(new VECopyrightTableEntry(14,19,39.99,-80.53,40.87,-79.43));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfEarthData_Text].push(new VECopyrightTableEntry(14,19,34.86,-90.27,35.39,-89.6));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGetmapping_Text].push(new VECopyrightTableEntry(14,19,49.94,-6.35,58.71,1.78));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,44.43,-63.75,45.06,-63.45));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,45.39,-73.78,45.66,-73.4));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,45.2,-75.92,45.59,-75.55));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,42.95,-79.81,44.06,-79.42));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,50.35,-114.26,51.25,-113.82));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,48.96,-123.33,49.54,-122.97));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,-35.42,138.32,-34.47,139.07));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,-32.64,115.58,-32.38,115.85));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,-34.44,150.17,-33.27,151.49));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfGeoEye_Text].push(new VECopyrightTableEntry(14,17,-28.3,152.62,-26.94,153.64));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfEarthData_Text].push(new VECopyrightTableEntry(14,19,40.6,-74.18,41.37,-73.51));a[Msn.VE.MapStyle.Aerial][L_MapControlImageCourtesyOfPasco_Text].push(new VECopyrightTableEntry(14,17,23.5,122.5,46.65,151.66));this.CreditsFor=function(c,k,l,j){var g=[];if(c!="undefined"&&c!=null&&typeof b[c]!="undefined"&&b[c]!=null){var m=b[c].length;for(var e=0;e<m;++e){var h=b[c][e],f=a[c][h],i=f.length;for(var d=0;d<i;++d)if(f[d].IsMatch(k,l,j)){g.push(h);break}}}return g};this.CreditsForView=function(a){var b=[];b.push(L_MapCopyrightMicrosoft);if(a.mapStyle==Msn.VE.MapStyle.Hybrid){b=b.concat(this.CreditsFor(Msn.VE.MapStyle.Road,a.zoomLevel,a.latlong.latitude,a.latlong.longitude));b=b.concat(this.CreditsFor(Msn.VE.MapStyle.Aerial,a.zoomLevel,a.latlong.latitude,a.latlong.longitude))}else b=b.concat(this.CreditsFor(a.mapStyle,a.zoomLevel,a.latlong.latitude,a.latlong.longitude));return b}}var g_sVECopyrightTable=new VECopyrightTable;function Copyright(e){var a=document.createElement("div"),b=document.createElement("div"),c=13,h=0,f=0;this.Show=function(){e.appendChild(a);e.appendChild(b)};this.Hide=function(){try{e.removeChild(a);e.removeChild(b)}catch(c){}};this.Init=function(){a.className="Copyright CopyrightBackground";b.className="Copyright CopyrightForeground";d();this.Show()};this.Destroy=function(){this.Hide();a=b=null};function d(){a.style.top=height-c-3-f-(c<=13?4:0)+"px";a.style.height=c+"px";a.style.right="9px";a.style.display="block";b.style.top=height-c-3-1-f-(c<=13?4:0)+"px";b.style.height=c+"px";b.style.right="10px";b.style.display="block"}function i(){var h=g_sVECopyrightTable.CreditsForView(currentView),g="",f="";for(var e=0;e<h.length;++e){if(e>0)if(e==2){f+="<br/>";g+="\n"}else{f+="&nbsp;&nbsp;";g+="  "}f+=h[e];g+=h[e]}if(view3DCreated)spacecontrol.SetCopyrightString(g);if(h.length<=2)c=13;else c=21;a.innerHTML=f;b.innerHTML=f;d()}function g(a,b){h=a;f=b;d()}this.Reposition=d;this.Update=i;this.SetOffset=g}function MapEvent(d,b,c,a){this.view=d;this.oblique=b;this.error=c;this.requestedView=a}function CreateEvent(a,e,c,d){var b=currentView.MakeCopy();if(a!=null&&a instanceof Msn.VE.LatLong)if(Msn.VE.API!=null){var h=new VELatLongFactory(new VELatLongFactorySpecFromMapView(b));b.LatLong=h.CreateVELatLong(a.latitude,a.longitude)}else b.latlong=a;if(e!=null&&typeof e=="number")b.zoomLevel=e;if(c==null||typeof c=="undefined")c="";var g=null;if(obliqueMode)g=obliqueMode.GetEventInfo();var f=null;if(d!=null&&d instanceof Msn.VE.MapView)f=d.MakeCopy();return new MapEvent(b,g,c,f)}function AttachEvent(d,c){var a=eventTable[d];if(!a){a=[];eventTable[d]=a}for(var b=0;b<a.length;b++)if(a[b]==c)return true;a.push(c)}function DetachEvent(d,c){var a=eventTable[d];if(!a)return;for(var b=0;b<a.length;b++)if(a[b]==c)a.splice(b,1)}function IsEventAttached(b){var a=eventTable[b];if(!a)return false;return true}function Fire(d,b){var a=eventTable[d];if(!a)return;if(!b)b=CreateEvent();for(var c=0;c<a.length;c++)a[c](b)}function DestroyEventTable(){while(eventTable.length){var a=eventTable.pop();while(a.length)a.pop();a=null}eventTable=null}function KeyDown(d){d=GetEvent(d);var c=keyboardPanSpeed,a=panningX,b=panningY;switch(d.keyCode){case 9:case 18:if(panning&&keyboardPan)StopContinuousPan();return true;case 37:a=-c;break;case 38:b=-c;break;case 39:a=c;break;case 40:b=c;break;case 107:case 187:case 61:case 43:a=0;b=0;ZoomIn();break;case 109:case 189:a=0;b=0;ZoomOut();break;case 65:a=0;b=0;SetMapStyle(aerialStyle);break;case 72:a=0;b=0;SetMapStyle(hybridStyle);break;case 82:case 86:a=0;b=0;SetMapStyle(roadStyle);break;case 66:case 79:a=0;b=0;SetMapStyle(obliqueStyle);break;case 51:case 99:p_this.EnableMode(Msn.VE.MapActionMode.Mode3D);break;default:break}if(a||b)ContinuousPan(a,b,null,true);Fire("onkeydown");return false}function KeyUp(a){a=GetEvent(a);var b=panningX,c=panningY;switch(a.keyCode){case 37:b=0;break;case 38:c=0;break;case 39:b=0;break;case 40:c=0;break;default:return false}ContinuousPan(b,c,null,true);return false}var northLatitude=0,southLatitude=0,westLongitude=0,eastLongitude=0;function AddLine(h,f,g,i,k,j,a,d){if(h==null||f==null||g==null||a==null||d==null)return null;var e=[];for(var b=0;b<a.length;b++)e.push(BuildRegionHeap(a[b],0,a[b].length-1));var c=new Line;c.Init(h,f,g,i,k,j,e,d);lines.push(c);return c}function RemoveLine(c){for(var a=0;a<lines.length;a++){var b=lines[a];if(b.id==c){lines.splice(a,1);b.Destroy();return}}}function ClearLines(){while(lines.length>0)lines.pop().Destroy()}function ShowLines(){for(var a=0;a<lines.length;a++){lines[a].StartLine();lines[a].Show()}}function HideLines(){for(var a=0;a<lines.length;a++)lines[a].Hide()}function UpdateLines(){for(var a=0;a<lines.length;a++)lines[a].UpdateLine()}function BuildRegionHeap(f,e,g){var h=g-e+1;if(h<1)return null;else if(h==1)return f[e];var d=null,c=null;if(h==2){d=f[e];c=f[g]}else{var i=Math.round((e+g)/2);d=BuildRegionHeap(f,e,i);c=BuildRegionHeap(f,i+1,g)}if(d!=null&&c!=null){var b=d.boundingRectangle,a=c.boundingRectangle,l=b[0].latitude>a[0].latitude?b[0].latitude:a[0].latitude,k=b[0].longitude>a[0].longitude?b[0].longitude:a[0].longitude,m=b[1].latitude<a[1].latitude?b[1].latitude:a[1].latitude,n=b[1].longitude<a[1].longitude?b[1].longitude:a[1].longitude,j=[new Msn.VE.LatLong(l,k),new Msn.VE.LatLong(m,n)];return new Msn.VE.LineRegion(j,null,[d,c])}else if(d!=null)return d;else if(c!=null)return c;return null}var IsDrivingEventAttached=false;function Line(){var u=5,m=new Msn.Drawing.Color(0,169,235,0.7),d=new Msn.Drawing.Stroke,G=4,c=null,e="",g=true,z="",o="",s=0,x=0,w=0,A=0,y=0,a=null,b=null,j=null,i=null,H=0,I=0,f=null;function E(k,p,q,c,g,h,l,n){if(!c)c=u;if(!g)g=m;if(!h)h=defaultZIndex;this.id=k;e=k;z=c+"pt";o=g;s=h;a=p;b=q;i=n;j=l;x=a[0];w=b[0];A=a[a.length-1];y=b[b.length-1];f=currentView.MakeCopy();d.color=m;d.width=c;r();if(!IsDrivingEventAttached){AttachEvent("onstartzoom",HideLines);AttachEvent("onchangeview",UpdateLines);IsDrivingEventAttached=true}this._Draw3D();AttachEvent("oninitmode",this._Draw3D)}function D(){if(view3DCreated)spacecontrol.DeleteGeometry(0,e);DetachEvent("oninitmode",this._Draw3D);n();a=b=j=c=f=null}this._Draw3D=function(){if(view3DCreated){var c=[];for(var f=0;f<a.length;f++){c.push(b[f]);c.push(",");c.push(a[f]);if(f!=a.length-1)c.push(" ")}var g=c.join("");spacecontrol.AddPolyline(0,e,g,o,0.75,d.width)}};function n(){if(graphicCanvas)graphicCanvas.Clear()}function F(){if(!g){h();return}if(c)c.style.display="block"}function h(){if(c)c.style.display="none"}function v(a){g=a;if(!g)h()}function r(){l();p();f.Copy(currentView)}function C(){l();p();f=currentView.MakeCopy();}function l(){var a=height<900?900:height,b=width<900?900:width;northLatitude=GetLatitude(-0.5*a);southLatitude=GetLatitude(1.5*a);westLongitude=GetLongitude(-0.5*b);eastLongitude=GetLongitude(1.5*b)}function p(){if(currentView.mapStyle==obliqueStyle){graphicCanvas.Clear();return}if(view3DCreated)return;var b=[],a=i.length-1;while(i[a]<currentView.zoomLevel&&a>=0)a--;k(j[a],b);B(b)}function k(f,c){if(t(f.boundingRectangle[0],f.boundingRectangle[1]))return;if(f.childRegions!=null)for(var j=0;j<f.childRegions.length;j++)k(f.childRegions[j],c);else{var h=f.indices,e=new Msn.VE.LatLong(a[h[0]],b[h[0]]),d,g=false;if(q(e.latitude,e.longitude)){c.push(e.longitude);c.push(e.latitude);g=true}for(var i=1;i<h.length;i++){d=new Msn.VE.LatLong(a[h[i]],b[h[i]]);if(q(d.latitude,d.longitude)){if(!g){c.push(e.longitude);c.push(e.latitude)}g=true;c.push(d.longitude);c.push(d.latitude)}else if(g){g=false;c.push(d.longitude);c.push(d.latitude)}e=d}}}function B(b){if(!graphicCanvas)return;h();graphicCanvas.Clear();var a=new Msn.Drawing.PolyLine(b);a.id=e;d.width=4;graphicCanvas.SetZIndex(s);graphicCanvas.SetStroke(d);graphicCanvas.DrawPrimitive(a);c=$ID(e);if(g)c.style.display="block";else c.style.display="none"}function q(a,b){return a>=southLatitude&&a<=northLatitude&&b>=westLongitude&&b<=eastLongitude}function t(a,b){return a.latitude>northLatitude&&b.latitude>northLatitude||a.latitude<southLatitude&&b.latitude<southLatitude||a.longitude>eastLongitude&&b.longitude>eastLongitude||a.longitude<westLongitude&&b.longitude<westLongitude}this.Init=E;this.Destroy=D;this.RemoveFromMap=n;this.Show=F;this.Hide=h;this.ChangeVisibility=v;this.StartLine=r;this.UpdateLine=C}function Logo(c){var a=null;this.Init=function(){if(navigator.userAgent.toLowerCase().indexOf("msie")!=-1){a=document.createElement("div");a.className="PoweredByLogo PoweredByLogo_ie";if(Msn.VE.API!=null)a.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+Msn.VE.API.Globals.vecurrentdomain+"/i/bin/"+Msn.VE.API.Globals.vecurrentversion+"/"+MapControl.Features.Image.PoweredLogo+"', sizingMethod='scale')"}else{a=document.createElement("img");var e="http://"+location.host,d="";if(Msn.VE.API!=null){e=Msn.VE.API.Globals.vecurrentdomain;d=Msn.VE.API.Globals.vecurrentversion}else d=window.buildVersion;a.src=e+"/i/bin/"+d+"/"+MapControl.Features.Image.PoweredLogo;a.className="PoweredByLogo"}b();c.appendChild(a)};this.Destroy=function(){c.removeChild(a);a=null};function b(){a.style.top=height-40+"px";a.style.left="6px";a.style.display="block"}function d(){b()}this.Reposition=b;this.Update=d}var hijackMouseMove=false;function MouseDown(a){a=GetEvent(a);CancelEvent(a);if(zooming)return false;if(panning)StopContinuousPan();if(obliqueMode)obliqueMode.CancelRequest();if(a.which&&a.which==2)currentTool=boxTool;else if(!a.which&&a.button&&a.button==4)currentTool=boxTool;else if(a.altKey)currentTool=boxTool;if(!document.all&&!isEnablingDefaultDblClick){isEnablingDefaultDblClick=true;return false}dragging=true;currentTool.OnMouseDown(a);return false}function MouseMove(a){if(hijackMouseMove){a=GetEvent(a);CancelEvent(a);x=GetLeftPosition(p_elSource);y=GetTopPosition(p_elSource);var c=originX+offsetX+GetMouseX(a)-x,d=originY+offsetY+GetMouseY(a)-y,b=CreateEvent(currentMode.PixelToLatLong(new Msn.VE.Pixel(c,d),currentView.zoomLevel));Fire("onmousemove",b);return}a=GetEvent(a);if(dragging)currentTool.OnMouseMove(a);return false}function MouseUp(b){b=GetEvent(b);CancelEvent(b);dragging=false;var a=currentTool.OnMouseUp(b),c=true;if(typeof a!="undefined"&&a.view!=null){isEnablingDefaultDblClick=a.view.disableDbClick!=true;c=a.view.disableMapFocus!=true}else isEnablingDefaultDblClick=true;currentTool=panTool;try{if(c)keyboard.focus()}catch(d){}return false}var isEnablingDefaultDblClick=true;function MouseDoubleClick(a){a=GetEvent(a);CancelEvent(a);if(hijackMouseMove)return false;if(isEnablingDefaultDblClick){UpdateFromParent();if(panning||zooming)return false;var b=preferredView.MakeCopy();b.SetCenter(new Msn.VE.Pixel(originX+offsetX+GetMouseX(a)-x-mapCenterOffset.x,originY+offsetY+GetMouseY(a)-y-mapCenterOffset.y));if(a.altKey)b.SetZoomLevel(currentView.zoomLevel-1);else b.SetZoomLevel(currentView.zoomLevel+1);SetView(b);return false}else isEnablingDefaultDblClick=true}function MouseWheel(a){a=GetEvent(a);CancelEvent(a);if(currentMode!=null&&currentMode==threeDMode)return false;if(panning||zooming)return false;var b=GetMouseScrollDelta(a);if(b>0)ZoomIn();else if(b<0)ZoomOut();return false}function ContextMenu(a){a=GetEvent(a);CancelEvent(a);x=GetLeftPosition(p_elSource);y=GetTopPosition(p_elSource);var b,c;if(currentMode==threeDMode){b=GetMouseX(a)-x;c=GetMouseY(a)-y}else{b=originX+offsetX+GetMouseX(a)-x;c=originY+offsetY+GetMouseY(a)-y}var d=currentMode.PixelToLatLong(new Msn.VE.Pixel(b,c),currentView.zoomLevel);if(d!=null){var e=CreateEvent(d);Fire("oncontextmenu",e)}return false}function PanMap(b,c){if(b==0&&c==0)return;if(currentMode!=threeDMode){var a=ShiftView(currentView,currentBounds,b,c);if(typeof a!="undefined"&&a!=null){map.style.left=map.offsetLeft-a.x+"px";map.style.top=map.offsetTop-a.y+"px";offsetX=-map.offsetLeft;offsetY=-map.offsetTop;currentView.SetCenter(new Msn.VE.Pixel(width/2+originX+offsetX,height/2+originY+offsetY));window.setTimeout(tileLayerManager.PanView,1)}}if(copyright)copyright.Update()}function ContinuousPan(a,b,c,d){if(zooming)return;if(!c)c=-1;panningX=a;panningY=b;panCounter=c;if(!a&&!b){StopContinuousPan();return}keyboardPan=d;if(view3DCreated){spacecontrol.ContinuousPan(a,b);Fire("onstartcontinuouspan")}else if(!panning){panning=true;StepPan();Fire("onstartcontinuouspan")}}function StepPan(){if(panning){PanMap(panningX,panningY);if(panCounter>0)panCounter--;if(panCounter!=0)window.setTimeout(StepPan,10);else StopContinuousPan()}}function StopContinuousPan(){panningX=0;panningY=0;panning=false;keyboardPan=false;if(currentMode!=threeDMode)if(panLatitude!=null&&panLongitude!=null){var b=new Msn.VE.LatLong(panLatitude,panLongitude),a=LatLongToPixel(b),c=a.x-width/2,d=a.y-height/2;PanMap(c,d);currentView.latlong.latitude=panLatitude;currentView.latlong.longitude=panLongitude;preferredView.Copy(currentView);panLatitude=null;panLongitude=null;if(obliqueMode)obliqueMode.UpdateAvailability()}else ComputeCenterPoint(true);else if(view3DCreated)spacecontrol.ContinuousPan(0,0);Fire("onendcontinuouspan");Fire("onchangeview");if(resizeInProgress)resizeInProgress=false}function PanToLatLong(b,a){if(currentMode==threeDMode)SetCenter(b,a);else{panLatitude=b;panLongitude=a;PanToPixel(LatLongToPixel(new Msn.VE.LatLong(b,a)))}}function PanToView(a){var b=a.center.x-(originX+offsetX),c=a.center.y-(originY+offsetY);PanToPixel(new Msn.VE.Pixel(b,c))}function PanToPixel(a){if(currentView.mapStyle==obliqueStyle){var h=obliqueMode.GetScene();if(!h||!h.ContainsPixel(a,currentView.zoomLevel)){var d=preferredView.MakeCopy();d.sceneId=null;d.SetCenterLatLong(PixelToLatLong(a));SetView(d);if(resizeInProgress)resizeInProgress=false;return}}var b=a.x-width/2,c=a.y-height/2,e=Math.sqrt(b*b+c*c);if(!IsAnimationEnabled()||MathAbs(b)>2*width||MathAbs(c)>2*height||e>1.5*Math.sqrt(width*width+height*height)){var d=preferredView.MakeCopy(),j=a.x+(originX+offsetX),k=a.y+(originY+offsetY);d.SetCenter(new Msn.VE.Pixel(j,k));SetView(d);if(resizeInProgress)resizeInProgress=false;return}var f=Math.atan2(c,b),g=MathCeil(e/panToLatLongSpeed),i=MathRound(e/g);b=MathRound(Math.cos(f)*i);c=MathRound(Math.sin(f)*i);ContinuousPan(b,c,g)}function PushPinOffset(a,b){this.x=a;this.y=b}function getPushPinOffset(c){var b=Msn.VE.PushPinTypes,a;switch(c){case b.Annotation:a=new PushPinOffset(-2,-29/2-5);break;case b.SearchResult:a=new PushPinOffset(0,-29/2+3);break;case b.Direction:a=new PushPinOffset(-3,-26/2-3);break;case b.DirectionTemp:a=new PushPinOffset(2,-26/2+3);break;case b.TrafficLight:a=new PushPinOffset(0,-26/2);break;case b.TrafficOthers:a=new PushPinOffset(0,-29/2);break;case b.YouAreHere:a=new PushPinOffset(0,-26/2);break;case b.AdStandard:a=new PushPinOffset(0,-42/2);break;case b.AdWide:a=new PushPinOffset(0,-27/2);break;case b.Default:default:a=new PushPinOffset(0,0);break}return a}function GetPushpins(){return pushpins}function AddPushpin(k,i,j,h,f,c,d,g,e,b){var a=new Pushpin;a.Init(k,i,j,h,f,c,d,g,e);if(typeof b=="undefined"||b==false||b==null){if(typeof view3DMode!="undefined"&&view3DMode){View3DAddPushpin(k,i,j,h,f,c,d,g,e);map.appendChild(a.pin);a.Hide()}else map.appendChild(a.pin);pushpins.push(a)}if(typeof b!="undefined"&&b==true)return a.pin;else return a.pin}function RemovePushpin(b){for(var a=0;a<pushpins.length;a++){var c=pushpins[a];if(c.id==b){pushpins.splice(a,1);if(typeof view3DMode!="undefined"&&view3DMode)View3DRemovePushpin(b);c.Destroy();break}}}function ClearPushpins(){while(pushpins.length>0){var a=pushpins.pop();if(typeof view3DMode!="undefined"&&view3DMode)View3DRemovePushpin(a.id);a.Destroy()}}function Relay3DPushpins(){for(var b=0;b<pushpins.length;b++){var a=pushpins[b];if(a.id&&a.id.constructor==String&&a.id.indexOf("Layer")==-1)View3DAddPushpin(a.id,a.lat,a.lon,a.width,a.height,a.className,a.innerHtml,a.zIndex,a.pinType)}}function RepositionPushpins(){for(var a=0;a<pushpins.length;a++)pushpins[a].Reposition()}function HidePins(){for(var a=0;a<pushpins.length;a++)pushpins[a].Hide()}function UnHidePins(){for(var a=0;a<pushpins.length;a++)pushpins[a].UnHide()}function Pushpin(){var e=true,a=document.createElement("a");a.href="javascript://pushin hover";a.onclick=function(){return ParseShiftKeyForLinks(event)};a.vePushpin=this;this.pin=a;var c=0,d=0,g=0,i=0,b=null,n=0,m=0,u=zoomTotalSteps+1,h=new Array(u),j=new Array(u),f;this.Init=function(w,u,v,t,r,j,o,x,p){this.id=w;this.lat=u;this.lon=v;this.width=t;this.height=r;this.className=j;this.innerHtml=o;this.zIndex=x;this.pinType=p;a.id=w;a.className=j;a.style.position="absolute";a.innerHTML=o;a.pinType=p||Msn.VE.PushPinTypes.Default;f=getPushPinOffset(a.pinType);if(!p_htParams.fixedView){a.attachEvent("ondblclick",q);a.attachEvent("onmousewheel",s)}a.unselectable="on";b=new Msn.VE.LatLong(u,v);n=t;m=r;var h=currentMode.LatLongToPixel(b,currentView.zoomLevel);if(h&&e){c=MathRound(h.x-originX);d=MathRound(h.y-originY);g=c;i=d;k();l(0);a.style.display="block"}else a.style.display="none"};this.Destroy=function(){a.detachEvent("ondblclick",q);a.detachEvent("onmousewheel",s);o();a.vePushpin=null;a=null;this.pin=null;while(h.length>0)h.pop();while(j.length>0)j.pop()};this.GetLatitude=function(){return b.latitude};this.GetLongitude=function(){return b.longitude};function r(){var b=zoomTotalSteps;for(var a=0;a<=b;a++){h[a]=c-n/2+f.x+"px";j[a]=d-m/2+f.y+"px"}}function k(){var k=zoomTotalSteps;for(var a=0;a<=k;a++){var b=a/k,e=1-b;h[a]=MathFloor(e*c+b*g-n/2+f.x)+"px";j[a]=MathFloor(e*d+b*i-m/2+f.y)+"px"}}function l(b){a.style.left=h[b];a.style.top=j[b]}function w(){var a=0;a=c;c=g;g=a;a=d;d=i;i=a}function t(){var f=currentMode.LatLongToPixel(b,currentView.zoomLevel);if(f){c=MathRound(f.x-originX);d=MathRound(f.y-originY);r();l(0);if(a.style.display!="none"&&e)a.style.display="block"}else a.style.display="none"}function x(){if(!e){a.style.display="block";e=true}}function y(){if(e){a.style.display="none";e=false}}function v(h,j,l){c-=offsetX;d-=offsetY;var f=currentMode.LatLongToPixel(b,l);if(f){g=MathRound(f.x-h);i=MathRound(f.y-j);k();if(a.style.display!="none"&&e)a.style.display="block"}else a.style.display="none"}function o(){if(a.parentNode==map)map.removeChild(a)}function q(c){c=GetEvent(c);CancelEvent(c);if(panning||zooming)return false;var a=preferredView.MakeCopy();a.SetCenterLatLong(b);if(c.altKey)a.SetZoomLevel(currentView.zoomLevel-1);else a.SetZoomLevel(currentView.zoomLevel+1);SetView(a);return false}function s(a){a=GetEvent(a);CancelEvent(a);if(panning||zooming)return false;var b=GetMouseScrollDelta(a);if(b>0)ZoomIn();else if(b<0)ZoomOut();return false}function z(a){p(PixelToLatLong(a))}function p(a){b=a;t()}this.ClearSteps=r;this.PrecomputeSteps=k;this.SetFactor=l;this.SwapStates=w;this.Reposition=t;this.PrepareForZoom=v;this.RemoveFromMap=o;this.Move=z;this.MoveToLatLon=p;this.Hide=y;this.UnHide=x}function ScaleBar(c){var r=0,f=0,i=null,a=document.createElement("div"),b=document.createElement("div"),d=document.createElement("div"),e=document.createElement("div"),h=150;this.Init=function(){a.className="ScaleBarLabel ScaleBarLabelBackground";b.className="ScaleBarLabel ScaleBarLabelForeground";d.className="ScaleBar ScaleBarBackground";e.className="ScaleBar ScaleBarForeground";l();j();c.appendChild(a);c.appendChild(b);c.appendChild(d);c.appendChild(e)};this.Destroy=function(){c.removeChild(a);c.removeChild(b);c.removeChild(d);c.removeChild(e);a=b=d=BarFg=null};function j(){a.style.top=height-45-f+"px";a.style.right="10px";a.style.display="block";b.style.top=height-46-f+"px";b.style.right="11px";b.style.display="block";d.style.top=height-30-f+"px";d.style.right="9px";d.style.display="block";e.style.top=height-31-f+"px";e.style.right="10px";e.style.display="block"}function m(a){return a*0.001}function o(a){return a*0.000621371192}function p(a){return a*1.0936133}function n(a){i=a}function l(){try{var f=GetMetersPerPixel(),c=f*h,e;if(i==null)e=$MVEM.IsEnabled(MapControl.Features.ScaleBarKilometers);else e=i==Msn.VE.DistanceUnit.Kilometers;if(e){var d=l344aut,b=m(c),a=g(b);if(a<0.5){d=l676avt;b=c;a=g(b)}k("metric",d,a,Math.round(a/b*h))}else{d=l918att;b=o(c);a=g(b);if(a<0.5){d=l932awt;b=p(c);a=g(b)}k("us",d,a,Math.round(a/b*h))}}catch(j){}}function g(d){var g=Math.log(d)/Math.log(10),e=Math.floor(g),a=Math.pow(10,e),c=d/a,b=Math.floor(c);if(b>=3)return b*a;var f=Math.floor(c*2)*0.5;return f*a}function k(i,h,c,f){if(c<1)c=c.toFixed(1);var g=c+" "+h;a.innerHTML=g;b.innerHTML=g;d.style.width=f;e.style.width=f}function q(a,b){r=a;f=b;j()}this.SetDistanceUnit=n;this.Update=l;this.Reposition=j;this.SetOffset=q}var totalRequestTime=0,totalRequestCount=0,totalFailureCount=0,responseRangeCeilings=[];responseRangeCeilings[roadStyle]=[325,975];responseRangeCeilings[aerialStyle]=[350,1050];responseRangeCeilings[hybridStyle]=[425,1275];responseRangeCeilings[obliqueStyle]=[450,1350];var responseRangeCounts=[0,0,0];function RequestTile(b,c,i,h,d,g,e,f){var a=new Tile;a.Init(b,c,i,h,b*tileSize-originX,c*tileSize-originY,d,g,e,f);return a}function ClearTiles(a){while(a.length>0){var b=a.pop();b.Destroy();b=null}}function GetResponseRangeCounts(){var b=0;for(var a=0;a<responseRangeCounts.length;a++)b+=responseRangeCounts[a];if(b==0)return responseRangeCounts;var c=new Array(responseRangeCounts.length);for(a=0;a<responseRangeCounts.length;a++)c[a]=responseRangeCounts[a]/b;return c}function ResetResponseRangeCounts(){for(var a=0;a<responseRangeCounts.length;a++)responseRangeCounts[a]=0}function GetFailureRate(){return totalFailureCount/totalRequestCount}function Tile(){var a=null,b=null,c=document.createElement("div"),r=null,t=0,u=0,s=0,A=0,h=0,m=1,w=zoomTotalSteps+1,j=new Array(w),l=new Array(w),q=new Array(w),o=new Array(w),z=false,d=0,e=0,g=0,f=0,i=0,k=0,p=0,n=0,y=null,B=0;this.Init=function(k,l,n,j,d,e,f,a,g,i){t=k;u=l;s=n;A=j;h=i;m=g;c.style.font="7pt Verdana, sans-serif";c.style.color="Red";c.style.backgroundColor="White";if(!currentMode.IsValidTile(t,u,s))return;x(d,e,tileSize,tileSize);E(d,e,tileSize,tileSize);v();if(a==mapTiles||a==trafficTiles)B=0;else B=1;b=new Image;b.onload=N;b.onerror=M;y=new Date;b.src=currentMode.GetFilename(t,u,s,f,a)};this.Destroy=function(){if(a)a.onmousedown=null;D();while(j.length>0)j.pop();while(l.length>0)l.pop();while(q.length>0)q.pop();while(o.length>0)o.pop();j=l=q=o=null};function x(c,h,b,a){d=c;e=h;g=b;f=a}this.SetCurrentState=x;function E(c,d,b,a){i=c;k=d;p=b;n=a}this.SetNextState=E;function K(){for(var a=0;a<=zoomTotalSteps;a++){j[a]=d+"px";l[a]=e+"px";q[a]=g+"px";o[a]=f+"px"}}this.ClearSteps=K;function v(){for(var a=0;a<=zoomTotalSteps;a++){var b=a/zoomTotalSteps,c=1-b;j[a]=MathFloor(c*d+b*i)+"px";l[a]=MathFloor(c*e+b*k)+"px";q[a]=MathCeil(c*g+b*p)+"px";o[a]=MathCeil(c*f+b*n)+"px"}}this.PrecomputeSteps=v;function G(d){if(a==null||zooming&&!z)return;var b=a.style;b.left=j[d];b.top=l[d];b.width=q[d];b.height=o[d];var e=c.style;if(debug&&d==0){b.border="1px dashed red";e.left=j[d];e.top=l[d]}if(a.parentNode!=map){b.position="absolute";b.zIndex=h;if(B>0)if(b&&typeof b.filter!="undefined"){if(Msn.VE.Environment.BrowserInfo.MajorVersion<=6){r=document.createElement("div");b=r.style;b.left=j[d];b.top=l[d];b.width=q[d];b.height=o[d];b.position="absolute";b.zIndex=h;b.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+a.src+"',sizingMethod='scale'), alpha(opacity="+m*100+")";map.appendChild(r)}else{b.zIndex=h;b.filter="alpha(opacity="+m*100+");opacity:"+m+";";map.appendChild(a);}}else{b.zIndex=h;b.opacity=m;map.appendChild(a)}else{if(b&&typeof b.filter!="undefined"){if(m<1)b.filter="alpha(opacity="+m*100+");opacity:"+m}else b.opacity=m;map.appendChild(a)}if(debug&&c.parentNode!=map){var f=a.src;c.innerHTML=f.substring(f.lastIndexOf("/")+1,f.lastIndexOf("."));e.position="absolute";e.zIndex=h+1;map.appendChild(c)}}}this.SetFactor=G;function F(){var a=0;a=d;d=i;i=a;a=e;e=k;k=a;a=g;g=p;p=a;a=f;f=n;n=a}this.SwapStates=F;function D(){if(b){b.onload=null;b.onerror=null;b=null}if(a){if(a.parentNode==map)map.removeChild(a);a=null}if(c){if(c.parentNode==map)map.removeChild(c);c=null}if(r)if(r.parentNode==map)map.removeChild(r)}this.RemoveFromMap=D;function N(){if(s!=currentView.zoomLevel||b==null)return;var d=new Date,c=d.getTime()-y.getTime();C(c);totalRequestTime+=c;totalRequestCount++;if(debug)window.status="last="+c+", average="+totalRequestTime/totalRequestCount;b.onload=null;b.onerror=null;a=b;a.onmousedown=function(){return false};b=null;if(!zooming)G(zoomCounter)}function M(){if(s!=currentView.zoomLevel||b==null)return;var c=new Date,a=c.getTime()-y.getTime();C(a);totalRequestTime+=a;totalRequestCount++;totalFailureCount++;b.onload=null;b.onerror=null;b=null}function C(b){for(var a=0;a<responseRangeCeilings[A].length;a++)if(b<responseRangeCeilings[A][a]){responseRangeCounts[a]++;return}responseRangeCounts[responseRangeCounts.length-1]++}function H(l,m,r,c,j,q){x(d-offsetX,e-offsetY,g,f);var o=q-r,b=Math.pow(2,o);i=MathFloor((l+d)*b-c);k=MathFloor((m+e)*b-j);p=MathCeil((l+d+g)*b-c)-i;n=MathCeil((m+e+f)*b-j)-k;z=true;v();h=baseZIndex;if(a!=null)a.style.zIndex=h}this.PrepareBaseTile=H;function I(m,o,r,j,l,q){var s=r-q,a=Math.pow(2,s);i=MathFloor((j+d)*a-m);k=MathFloor((l+e)*a-o);p=MathCeil((j+d+g)*a-m)-i;n=MathCeil((l+e+f)*a-o)-k;var c=MathCeil(tileViewportWidth*0.25),b=MathCeil(tileViewportHeight*0.25);z=q<r&&(t<tileViewportX1+c||t>tileViewportX2-c||u<tileViewportY1+b||u>tileViewportY2-b);F();v();h=swapZIndex}this.PrepareSwapTile=I;function L(b){if(a!=null)a.style.border=b?"1px dashed red":"0px";c.style.display=b?"block":"none"}this.Debug=L;function J(){p=g;n=f}this.ClearStates=J}function SetMapTiles(){var a=new VETileSourceSpecification;a.ID=mapTiles;a.SourceName="http://%1%2.ortho.tiles.virtualearth.net/tiles/%3%4.%5?g=%6";a.NumServers=4;tileLayerManager.AddTileSource(a)}function SetView(a){if(currentMode!=null&&currentMode==threeDMode){var e=false;if(a==null){a=new Msn.VE.MapView;a.Copy(currentView);e=true}if(!view3DCreated)e=true;return SetView3D(a,e)}if(a==null){a=new Msn.VE.MapView;a.Copy(currentView);a.SetAltitude(-1000);a.SetTilt(-90);a.SetDirection(0);var f=a.latlong,h=ClipLatitude(f.latitude);if(f.latitude!=h){a.SetCenterLatLong(new Msn.VE.LatLong(h,f.longitude));a.Resolve(currentMode,width,height)}if(a.mapStyle==obliqueStyle)currentMode=obliqueMode;else currentMode=orthoMode;currentMode.ValidateZoomLevel(a);UpdateTiles(a);return true}if(zooming||dragging)return true;if(panning)StopContinuousPan();var c=a.latlong;if(a.GetViewType()=="latlongRect")c=a.latlongRect.Center();if(a.mapStyle==obliqueStyle){if(obliqueMode==null)return true;preferredView.Copy(a);currentMode=obliqueMode;p_elSource.style.backgroundColor="black";a.Resolve(currentMode,width,height);var b=obliqueMode.GetScene();if((!b||b.GetID()!=a.sceneId)&&a.sceneId!=null){obliqueMode.RequestScene(a.sceneId);return true}if(!b||!b.ContainsLatLong(c,a.zoomLevel)&&b.GetID()!=a.sceneId||b.GetOrientation()!=a.sceneOrientation){obliqueMode.RequestSceneAtLatLong(c,a.sceneOrientation,true);return true}}else{currentMode=orthoMode;if(a.mapStyle=="r")p_elSource.style.backgroundColor="#e9e7d4";else p_elSource.style.backgroundColor="black";a.Resolve(currentMode,width,height)}c=a.latlong;preferredView.Copy(a);currentMode.ValidateZoomLevel(a);currentBounds=currentMode.GetBounds(a);ClipView(a,currentBounds);a.Resolve(currentMode,width,height);if(a.Equals(currentView)&&!resizeInProgress)return false;var i=a.GetX(currentView.zoomLevel)-currentView.center.x,j=a.GetY(currentView.zoomLevel)-currentView.center.y,d=Math.sqrt(i*i+j*j);previousCenter=currentView.GetCenterLatLong();var g=0;if(!previousCenter.Equals(a.GetCenterLatLong()))g+=Msn.VE.ViewChangeType.Pan;if(currentView.zoomLevel!=a.zoomLevel)g+=Msn.VE.ViewChangeType.Zoom;SetLastViewChangeType(g);var l=d<width&&d<height&&a.zoomLevel==currentView.zoomLevel&&IsAnimationEnabled()&&a.mapStyle==currentView.mapStyle&&(a.sceneId==null||a.sceneId==currentView.sceneId);if(l){PanToLatLong(a.latlong.latitude,a.latlong.longitude);return true}previousZoomLevel=currentView.zoomLevel;if(currentView.zoomLevel!=a.zoomLevel){Fire("onstartzoom",CreateEvent(null,null,null,a));zooming=true}var k=d<width&&d<height&&(a.zoomLevel==currentView.zoomLevel-1||a.zoomLevel==currentView.zoomLevel+1)&&IsAnimationEnabled()&&a.mapStyle==currentView.mapStyle&&(a.sceneId==null||a.sceneId==currentView.sceneId);if(k){tileLayerManager.zoomView(a);return true}UpdateTiles(a);return true}function UpdateTiles(a){currentView.Destroy();currentView=a;tileLayerManager.SetViewPort();tileLayerManager.LoadBaseLayer("Road",mapTiles,1,0);tileLayerManager.RefreshTileLayers();tileLayerManager.FinalizeView();RepositionPushpins()}function SetLastViewChangeType(a){if(Msn.VE.ViewChangeType.IsValid(a))lastViewChangeType=a}if(typeof registerNamespace!="undefined")registerNamespace("Microsoft.Web.Geometry");else{if(typeof Microsoft=="undefined")Microsoft={};if(typeof Microsoft.Web=="undefined")Microsoft.Web={};if(typeof Microsoft.Web.Geometry=="undefined")Microsoft.Web.Geometry={}}Microsoft.Web.Geometry.Point=function(c,d){var a=this,b=Microsoft.Web.Geometry;this.x=c;this.y=d;this.add=function(c,d){var e=new b.Point(a.x+c,a.y+d);return e};this.getDistanceFrom=function(b){var c=Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2),d=Math.sqrt(c);return d}};Microsoft.Web.Geometry.Overlap={Range:{GreaterThanX:1,LessThanX:2,GreaterThanY:4,LessThanY:8,InXRange:16,InYRange:32,InRange:48},getInstance:function(f,g){var d=Microsoft.Web.Geometry.Overlap,a=f,b=g,c=0;e();function e(){if(b.getP2().x>a.getP2().x)c+=d.Range.GreaterThanX;if(b.getP1().x<a.getP1().x)c+=d.Range.LessThanX;if(b.getP2().y>a.getP2().y)c+=d.Range.GreaterThanY;if(b.getP1().y<a.getP1().y)c+=d.Range.LessThanY;if(a.getP1().x<=b.getP1().x&&b.getP2().x<=a.getP2().x)c+=d.Range.InXRange;if(a.getP1().y<=b.getP1().y&&b.getP2().y<=a.getP2().y)c+=d.Range.InYRange}this.getRange=function(){return c};this.getLeftXBleed=function(){if(c&d.Range.LessThanX)return Math.abs(a.getP1().x-b.getP1().x);else return 0};this.getRightXBleed=function(){if(c&d.Range.GreaterThanX)return b.getP2().x-a.getP2().x;else return 0};this.getTopYBleed=function(){if(c&d.Range.LessThanY)return Math.abs(a.getP1().y-b.getP1().y);else return 0};this.getBottomYBleed=function(){if(c&d.Range.GreaterThanY)return b.getP2().y-a.getP2().y;else return 0}}};Microsoft.Web.Geometry.Rectangle=function(h,i){var g=this,a=h,b=i,d,e;f();function f(){c()}this.move=function(c){a.x=c.x;a.y=c.y;b.x=c.x+e;b.y=c.y+d};this.getP1=function(){return a};this.getP2=function(){return b};this.setP1=function(b){a=b;c()};this.setP2=function(a){b=a;c()};this.getWidth=function(){return e};this.getHeight=function(){return d};this.containsPoint=function(c){return c.x>=a.x&&c.x<=b.x&&c.y>=a.y&&c.y<=b.y};this.getOverlap=function(a){var b=Microsoft.Web.Geometry;return new b.Overlap.getInstance(g,a)};function c(){d=b.y-a.y;e=b.x-a.x}};Microsoft.Web.Geometry.Functions={getSlope:function(a,b){return (b.y-a.y)/(b.x-a.x)},getYIntercept:function(b,a){return a.y-b*a.x},getElementPosition:function(a){var d=Microsoft.Web.Geometry,b=0,c=0;while(a&&a.offsetParent){b+=a.offsetLeft-a.scrollLeft;c+=a.offsetTop-a.scrollTop;a=a.offsetParent}return new d.Point(b,c)},getBestBoundingPoint:function(f,b,c){var a=Microsoft.Web.Geometry;if(!b)b=a.Functions.getElementPosition(f);var e=new a.Rectangle(b,new a.Point(b.x+f.offsetWidth,b.y+f.offsetHeight)),i=c.getOverlap(e),d=i.getRange();if((d&a.Overlap.Range.InRange)==a.Overlap.Range.InRange)return b;var g=b.x,h=b.y;if(d&a.Overlap.Range.GreaterThanX)g=c.getP2().x-e.getWidth();if(d&a.Overlap.Range.LessThanX)g=c.getP1().x;if(d&a.Overlap.Range.GreaterThanY)h=c.getP2().y-e.getHeight();if(d&a.Overlap.Range.LessThanY)h=c.getP1().y;return new a.Point(g,h)}};view3DMode=false;function View3DAddPushpin(f,c,d,k,j,g,a,h,b){var e=TranslatePushpinURL(g,a,h,b),i=Msn.VE.PushPinTypes;switch(b){case i.SearchResult:spacecontrol.AddPointWithProperties(0,f,c,d,e,'text="'+a+'"');break;default:spacecontrol.AddPoint(0,f,c,d,e);break}}function View3DRemovePushpin(a){spacecontrol.DeleteGeometry(0,a)}function AddView3DParameter(d,c,b){var a=document.createElement("param");a.name=c;a.value=b;d.appendChild(a)}function CreateView3DControl(a){initial3dView=new Msn.VE.MapView;initial3dView.Copy(currentView);spacediv=document.createElement("div");spacediv.id="spacediv";spacediv.className="map";spacediv.style.position="absolute";spacecontrol=document.createElement("object");var b=a.cameraLatlong==null?a.latlong:a.cameraLatlong;AddView3DParameter(spacecontrol,"StartLongitude",b.longitude);AddView3DParameter(spacecontrol,"StartLatitude",b.latitude);AddView3DParameter(spacecontrol,"StartPitch",a.GetTilt());AddView3DParameter(spacecontrol,"StartHeading",-a.GetDirection());var c=a.GetAltitude();if(c>-1000)AddView3DParameter(spacecontrol,"StartAltitude",c);else AddView3DParameter(spacecontrol,"StartZoomLevel",a.zoomLevel);spacediv.appendChild(spacecontrol);try{spacecontrol.classid="clsid:68BFC611-B963-4e8c-B0FE-0DD4FB832796"}catch(e){if(IsEventAttached("onmodenotavailable"))Fire("onmodenotavailable",Msn.VE.MapActionMode.Mode3D);else if(typeof Msn.VE.API!="undefined"&&Msn.VE.API!=null)window.open(Msn.VE.API.Globals.vecurrentdomain+"/Help/"+Msn.VE.API.Globals.locale+"/View3DInstall.htm","_blank","width=600,height=550,menubar=0,resizeable=0,status=0,titlebar=0,toolbar=0,scrollbars=0");spacecontrol=false;return false}spacecontrol.ControlId=init3dparam;AttachEvent("onresize",ResizeControl);p_elSource.appendChild(spacediv);ResizeControl();var d=ValidateControl();if(d)IterativeCameraRefinement();return d}function CallIterativeCameraRefinement(){var a=GetMapControlInstance(null);if(a)a.IterativeCameraRefinement()}function IterativeCameraRefinement(){if(cameraUpdateCount>0)return;if(IsModeEnabled(Msn.VE.MapActionMode.Mode3D)&&spacecontrol)if(!spacecontrol.AllTilesLoaded)setTimeout(CallIterativeCameraRefinement,1000);else if(Math.abs(currentView.GetAltitude()-initial3dView.GetAltitude())>1){var a=initial3dView.MakeCopy();a.SetMapStyle(currentView.mapStyle);SetView3D(a,true)}}function ValidateControl(){var a=false,b=300;if(spacecontrol.Created){while(!spacecontrol.FirstFrameRendered&&!spacecontrol.LoadFailed&&!spacecontrol.AlreadyLoaded&&b>0){b--;spacecontrol.ProcessEvents()}a=spacecontrol.FirstFrameRendered}if(spacecontrol.Created&&!spacecontrol.HardwareAccelerationEnabled&&spacecontrol.LoadFailed){window.setTimeout(DelayedHWDialog,2759);OnHardwareAccelHelpFired();if(mode==Msn.VE.MapActionMode.Mode3D)EnableMode(Msn.VE.MapActionMode.Mode2D);return false}else if(!spacecontrol.Created||!spacecontrol.Enabled||!spacecontrol.IsHandleCreated||!a&&!spacecontrol.AlreadyLoaded){spacecontrol=false;if(IsEventAttached("onmodenotavailable"))Fire("onmodenotavailable",Msn.VE.MapActionMode.Mode3D);else if(typeof Msn.VE.API!="undefined"&&Msn.VE.API!=null)window.open(Msn.VE.API.Globals.vecurrentdomain+"/Help/"+Msn.VE.API.Globals.locale+"/View3DInstall.htm","_blank","width=600,height=550,menubar=0,resizeable=0,status=0,titlebar=0,toolbar=0,scrollbars=0");return false}else{spacecontrol.focus();view3DCreated=true;return true}}function ResizeControl(){if(spacecontrol){spacecontrol.style.height=p_elSource.offsetHeight;spacecontrol.style.width=p_elSource.offsetWidth}RepositionShims()}function SetView3D(a,f){a.Resolve(orthoMode,width,height);preferredView.Copy(a);currentMode.ValidateZoomLevel(a);a.Resolve(orthoMode,width,height);if(!view3DCreated&&!spacecontrol){var k=CreateView3DControl(a);if(!k)return false;if(a.GetTilt()!=-90){a.Resolve(orthoMode,width,height);cameraUpdateCount=-1}else{cameraUpdateCount=0;a._supressFlyToCall=true}p_elSource.style.backgroundColor="#e9e7d4";originX=0;originY=0;offsetX=0;offsetY=0;UpdateFromParent()}if(!f&&a.Equals(currentView))return false;var c=false;if(a.GetAltitude()>-1000)c=Math.abs(a.GetAltitude()-currentView.GetAltitude())>0.0001;else c=currentView.zoomLevel!=a.zoomLevel;currentView.Destroy();currentView=a;if(view3DCreated){if(previousMapStyle!=currentView.mapStyle){var b="Road";if(currentView.mapStyle=="a"){b="Aerial";spacecontrol.ShowAtmosphere=true}if(currentView.mapStyle=="h"){b="Hybrid";spacecontrol.ShowAtmosphere=true}if(currentView.mapStyle=="r"){spacecontrol.TexturesVisible=false;if(spacecontrol.HardwareClassificationLevel<3)b="LowRoad";spacecontrol.ShowAtmosphere=false}else spacecontrol.TexturesVisible=true;spacecontrol.AddImageSource("Terrain","Texture",vemanifestdomain+"/Manifests/"+b+"ContentManifest.xml",0,1);Fire("onchangemapstyle");previousMapStyle=currentView.mapStyle}var d=a.cameraLatlong,h=a.zoomLevel,i=a.GetAltitude(),j=a.GetTilt(),g=a.GetDirection(),e=a._needsPivotOperation;if(c)Fire("onstartzoom");if(a._supressFlyToCall)a._supressFlyToCall=false;else spacecontrol.FlyTo(d.latitude,d.longitude,h,i,j,g,e?1:0);if(c)Fire("onendzoom");if(copyright)copyright.Update();return true}return false}var on3DAnimationInterruptedCallback=null;function SetOn3DAnimationInterruptedCallback(a){on3DAnimationInterruptedCallback=a}function GetOn3DAnimationInterruptedCallback(){return on3DAnimationInterruptedCallback}function SetViewport(b,d,c,e){Sync3dView();var a=preferredView.MakeCopy();a.sceneId=null;a.SetLatLongRectangle(new Msn.VE.LatLongRectangle(new Msn.VE.LatLong(ClipLatitude(b),ClipLongitude(d)),new Msn.VE.LatLong(ClipLatitude(c),ClipLongitude(e))));a.SetTilt(-90);a.SetDirection(0);return SetView(a)}function SetBestMapView(b){var a=GetBestMapViewBounds(b);if(!a||a.constructor!=Array)return null;if(a.length==4)SetViewport(a[0],a[1],a[2],a[3])}function GetBestMapViewBounds(a){var b=[];if(!a||a.constructor!=Array)return null;var c=a[0].latitude,d=a[0].longitude,f=c,g=d;for(var e=1;e<a.length;e++){c=MathMin(c,a[e].latitude);d=MathMin(d,a[e].longitude);f=MathMax(f,a[e].latitude);g=MathMax(g,a[e].longitude)}var h=(f-c)*0.1,i=(g-d)*0.1;c-=h;d-=i;f+=h;g+=i;if(!b||b.constructor!=Array)return null;else{b.push(ClipLatitude(c));b.push(ClipLongitude(d));b.push(ClipLatitude(f));b.push(ClipLongitude(g));return b}}function IncludePointInViewport(d,c){var a=new Msn.VE.LatLong(d,c);if(currentView.mapStyle==obliqueStyle){var b=obliqueMode.GetScene();if(!b||!b.ContainsLatLong(a))SetMapStyle(lastOrthoMapStyle)}SetBestMapView(new Array(currentView.latlong,a))}function ClipLatitude(a){return Clip(a,minLatitude,maxLatitude)}function ClipLongitude(a){return Clip(a,minLongitude,maxLongitude)}function Clip(a,c,b){if(a<c)return c;if(a>b)return b;return a}function GetXmlHttp(){var a=null;try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){a=null}}if(!a&&typeof XMLHttpRequest!="undefined")a=new XMLHttpRequest;return a}function SetZoom(b){Sync3dView();var a=preferredView.MakeCopy();a.SetZoomLevel(b);SetView(a)}function ZoomIn(){Sync3dView();var a=preferredView.MakeCopy();a.SetZoomLevel(currentView.zoomLevel+1);SetView(a)}function ZoomOut(){Sync3dView();var a=preferredView.MakeCopy();a.SetZoomLevel(currentView.zoomLevel-1);SetView(a)}function SetCenterAndZoom(d,b,c){Sync3dView();var a=preferredView.MakeCopy();a.sceneId=null;a.SetCenterLatLong(new Msn.VE.LatLong(d,b));a.SetZoomLevel(c);SetView(a)}function GetCurrentViewMaxZoomLevel(b){var a=b;if(typeof a=="undefined"||a==null)a=preferredView;if(!currentMode)return tileLayerManager.GetMaxTileZoom();return currentMode.GetCurrentMaxZoomLevel(a)}function ObliqueMode(){var scene=null,available=false,availableBefore=false,xmlHttp=null,obliqueUrl=null,showOnLoad=false,requestUrl=null,timerId=-1,bounds=['02121222233','02121222322','02121222323','02121222332','02121222333','02121223222','02121223223','02121223232','02123000101','02123000103','02123000110','02123000111','02123000112','02123000113','02123000130','02123000131','02123000301','02123000303','02123000310','02123000312','02123000313','02123000321','02123000330','02123000331','02123000332','02123000333','02123001000','02123001001','02123001002','02123001003','02123001010','02123001012','02123001020','02123001021','02123001030','02123001202','02123001203','02123001220','02123001221','02123001222','02123001223','02123001230','02123001232','02123002103','02123002110','02123002111','02123002112','02123002113','02123002121','02123002123','02123002130','02123002131','02123002132','02123002133','02123002233','02123002301','02123002303','02123002310','02123002311','02123002312','02123002313','02123002320','02123002321','02123002322','02123002323','02123002330','02123002331','02123002332','02123002333','02123003000','02123003001','02123003002','02123003003','02123003010','02123003011','02123003012','02123003013','02123003020','02123003021','02123003022','02123003023','02123003030','02123003032','02123003200','02123003201','02123003202','02123003203','02123003210','02123003220','02123003221','02123003222','02123003223','02123003232','02123020011','02123020013','02123020031','02123020100','02123020101','02123020102','02123020103','02123020110','02123020111','02123020112','02123020113','02123020120','02123021000','02123021001','02123021002','02123022103','02123022112','02123022113','02123022121','02123022122','02123022123','02123022130','02123022131','02123022132','02123022133','02123022211','02123022300','02123022301','02123022302','02123022303','02123022310','02123022311','02123022312','02123022313','02123022320','02123022321','02123022330','02123022331','02123023200','02123023202','02123023220','02123302112','02123302113','02123302130','02123302131','02123302132','02123302133','02123302310','02123302311','02123302313','02123303002','02123303003','02123303020','02123303021','02123303022','02123303023','02123303200','02123303201','02123303202','02123303203','02123303220','02123303221','02133122113','02133122131','02133122133','02133122212','02133122213','02133122230','02133122231','02133122232','02133122233','02133122302','02133122311','02133122313','02133122320','02133122322','02133122323','02133123002','02133123003','02133123012','02133123020','02133123021','02133123022','02133123023','02133123030','02133123032','02133123200','02133123201','02133123202','02133123210','02133123231','02133123232','02133123233','02133123320','02133123322','02133123323','02133123332','02133123333','02133300010','02133300011','02133300012','02133300013','02133300100','02133300102','02133301010','02133301011','02133301012','02133301013','02133301031','02133301100','02133301101','02133301102','02133301103','02133301110','02133301111','02133301112','02133301113','02133301120','02133301121','02133301122','02133301123','02133301130','02133301131','02133301132','02133301133','02133301300','02133301301','02133301303','02133301310','02133301311','02133301312','02133310020','02133310022','02133310200','02133310222','02133310223','02133310232','02133310233','02133310322','02133312000','02133312001','02133312002','02133312003','02133312010','02133312011','02133312012','02133312013','02133312021','02133312030','02133312031','02133312100','02133312102','02133333033','02133333112','02133333121','02133333122','02133333123','02133333130','02133333131','02133333132','02133333133','02133333201','02133333203','02133333210','02133333211','02133333212','02133333213','02133333300','02133333301','02133333302','02133333303','02133333310','02301002223','02301002232','02301002233','02301002322','02301002323','02301003323','02301003332','02301003333','02301012103','02301012112','02301012113','02301012121','02301012123','02301012130','02301012131','02301012132','02301012133','02301012310','02301012311','02301012312','02301012313','02301012330','02301012331','02301020001','02301020003','02301020010','02301020011','02301020012','02301020013','02301020030','02301020031','02301020033','02301020100','02301020101','02301020102','02301020103','02301020110','02301020112','02301020120','02301020121','02301020122','02301020123','02301020130','02301020131','02301020132','02301020133','02301020211','02301020300','02301020301','02301020310','02301020311','02301020312','02301020313','02301020331','02301020332','02301020333','02301021011','02301021013','02301021021','02301021022','02301021023','02301021030','02301021031','02301021032','02301021033','02301021100','02301021101','02301021102','02301021103','02301021110','02301021111','02301021112','02301021113','02301021120','02301021121','02301021122','02301021123','02301021130','02301021131','02301021132','02301021133','02301021200','02301021201','02301021202','02301021203','02301021210','02301021211','02301021212','02301021213','02301021220','02301021221','02301021222','02301021223','02301021230','02301021231','02301021232','02301021233','02301021300','02301021301','02301021302','02301021310','02301021320','02301021322','02301022110','02301022111','02301022112','02301022113','02301022131','02301023000','02301023001','02301023002','02301023003','02301023010','02301023011','02301023012','02301023013','02301023020','02301023021','02301023022','02301023023','02301023030','02301023031','02301023032','02301023033','02301023100','02301023102','02301023103','02301023120','02301023122','02301023201','02301023210','02301023211','02301023213','02301023300','02301023302','02301023320','02301031102','02301031103','02301031120','02301031121','02301031131','02301031133','02301120020','02301120022','02301212003','02301212012','02301212021','02301212023','02301212030','02301212032','02301212033','02301212210','02301212211','02301212213','02301212302','02301212303','02301212320','02301212321','02301212323','02301212330','02301212331','02301212332','02301212333','02301213211','02301213213','02301213222','02301213300','02301213301','02301213302','02301213303','02301213310','02301213311','02301213312','02301213313','02301213320','02301213321','02301213322','02301213323','02301213330','02301213331','02301213332','02301213333','02301231013','02301231031','02301231100','02301231101','02301231102','02301231103','02301231110','02301231111','02301231112','02301231113','02301231120','02301231121','02301231130','02301231131','02301231132','02301231133','02301231303','02301231310','02301231311','02301231312','02301231321','02301231330','02301231331','02301300230','02301300231','02301300232','02301300233','02301300302','02301300320','02301301113','02301301131','02301301133','02301301311','02301301332','02301301333','02301302123','02301302132','02301302133','02301302200','02301302201','02301302202','02301302203','02301302210','02301302211','02301302212','02301302213','02301302220','02301302221','02301302222','02301302223','02301302230','02301302231','02301302232','02301302233','02301302300','02301302301','02301302302','02301302303','02301302310','02301302311','02301302312','02301302313','02301302320','02301302321','02301302322','02301302323','02301302330','02301302331','02301302332','02301302333','02301303021','02301303022','02301303110','02301303111','02301303200','02301303201','02301310002','02301310020','02301310021','02301310022','02301310023','02301310030','02301310032','02301310033','02301310200','02301310201','02301310210','02301310211','02301310212','02301310213','02301312033','02301312211','02301312300','02301312302','02301312320','02301312321','02301312332','02301320000','02301320001','02301320002','02301320003','02301320010','02301320011','02301320012','02301320013','02301320020','02301320021','02301320022','02301320023','02301320030','02301320031','02301320032','02301320033','02301320100','02301320101','02301320102','02301320103','02301320110','02301320111','02301320112','02301320113','02301320120','02301320121','02301320122','02301320130','02301320200','02301320201','02301320203','02301320210','02301320211','02301320212','02301320213','02301320230','02301320231','02301320300','02301320301','02301320302','02301320303','02301320312','02301320320','02301320321','02301320322','02301320323','02301320330','02301320332','02301321001','02301321002','02301321003','02301321010','02301321011','02301321012','02301321013','02301321020','02301321021','02301321022','02301321023','02301321030','02301321032','02301321033','02301321100','02301321101','02301321102','02301321103','02301321201','02301321210','02301321211','02301321212','02301321213','02301322100','02301322101','02301322102','02301322103','02301322110','02301322111','02301322112','02301322113','02301322120','02301322121','02301322122','02301322123','02301322130','02301322131','02301322132','02301322133','02301322301','02301322310','02301323000','02301323002','02301323020','02301330011','02301330100','02301330101','02301330102','02301330103','02301330110','02301331312','02301331313','02301331330','02301331331','02301332031','02301332033','02301332120','02301332121','02301332122','02301332123','02301332210','02301332211','02310012303','02310012312','02310012313','02310012321','02310012330','02310012331','02310101223','02310101230','02310101232','02310101233','02310101322','02310101323','02310101332','02310101333','02310103001','02310103003','02310103010','02310103011','02310103012','02310103013','02310103021','02310103023','02310103030','02310103031','02310103032','02310103033','02310103100','02310103101','02310103102','02310103103','02310103110','02310103111','02310103112','02310103113','02310103120','02310103121','02310103122','02310103130','02310103131','02310103203','02310103210','02310103211','02310103212','02310103213','02310103300','02310103302','02310110222','02310110223','02310110232','02310112000','02310112001','02310112002','02310112003','02310112010','02310112012','02310112020','02310112021','02310112030','02310210322','02310210323','02310210332','02310210333','02310211203','02310211212','02310211213','02310211221','02310211222','02310211223','02310211230','02310211231','02310211232','02310211233','02310211302','02310211303','02310211320','02310211321','02310211322','02310212011','02310212100','02310212101','02310212110','02310212111','02310212112','02310212130','02310212132','02310213000','02310213001','02310213002','02310213003','02310213010','02310213011','02310213012','02310213100','02310213112','02310213113','02310213130','02310213131','02310213132','02310213133','02310213311','02310220021','02310220023','02310220030','02310220031','02310220032','02310220033','02310220122','02310220200','02310220201','02310220202','02310220203','02310220210','02310220211','02310220212','02310220213','02310220220','02310220221','02310220223','02310220230','02310220231','02310220232','02310220233','02310220300','02310220302','02310220303','02310220320','02310220321','02310220322','02310220323','02310220330','02310222310','02310222311','02310222312','02310222313','02310222331','02310222333','02310223200','02310223201','02310223202','02310223203','02310223212','02310223220','02310223221','02310223222','02310223223','02310223230','02310223232','02310300110','02310300111','02310300112','02310300113','02310300122','02310300123','02310300130','02310300131','02310300300','02310300301','02310300302','02310300303','02310300320','02310300321','02310300322','02310300323','02310302002','02310302003','02310302012','02310302013','02310302020','02310302021','02310302022','02310302023','02310302030','02310302031','02310302032','02310302033','02310302101','02310302120','02310302121','02310302122','02310302123','02310302200','02310302201','02310302210','02310302211','02310302212','02310302213','02310302230','02310302231','02310302232','02310302233','02310302300','02310302301','02310302302','02310302320','02310322223','02310322232','02310322233','02310331033','02310331211','02310331213','02310331231','02310331300','02310331301','02310331302','02310331303','02310331320','02310331321','02311030103','02311030112','02311030113','02311030121','02311030123','02311030130','02311030131','02311030132','02311030133','02311030310','02311030311','02311030313','02311031002','02311031003','02311031020','02311031021','02311031022','02311031023','02311031200','02311031201','02311031202','02311031203','02311102213','02311102231','02311102302','02311102303','02311102320','02311102321','02311102323','02311102332','02311102333','02311103222','02311113322','02311113323','02311113332','02311113333','02311120101','02311120103','02311120110','02311120111','02311120112','02311120113','02311120121','02311120130','02311120131','02311121000','02311121002','02311121020','02311131013','02311131031','02311131100','02311131101','02311131102','02311131103','02311131110','02311131111','02311131112','02311131113','02311131120','02311131121','02311131130','02311131131','02311210231','02311210232','02311210233','02311210301','02311210302','02311210303','02311210310','02311210312','02311210313','02311210320','02311210321','02311210322','02311210323','02311210330','02311210331','02311210332','02311210333','02311212011','02311212013','02311212100','02311212101','02311212102','02311212103','02311212110','02311212111','02311212112','02311212113','02311212120','02311212121','02311212122','02311212123','02311212130','02311212131','02311212132','02311212133','02311212301','02311212310','02311212311','02311230121','02311230123','02311230130','02311230131','02311230132','02311230133','02311230301','02311230303','02311230310','02311230311','02311230312','02311230313','02311230321','02311230330','02311230331','02311231020','02311231021','02311231022','02311231023','02311231030','02311231032','02311231033','02311231200','02311231201','02311231202','02311231203','02311231210','02311231211','02311231212','02311231213','02311231220','02311231221','02311231222','02311231223','02311231230','02311231231','02311231232','02311231233','02311231300','02311231302','02311231320','02311231322','02311232010','02311232011','02311232012','02311232013','02311232023','02311232030','02311232031','02311232032','02311232033','02311232100','02311232101','02311232102','02311232103','02311232110','02311232111','02311232112','02311232113','02311232120','02311232121','02311232122','02311232123','02311232130','02311232131','02311232132','02311232133','02311232201','02311232210','02311232211','02311232212','02311232213','02311232230','02311232231','02311232233','02311232300','02311232301','02311232302','02311232310','02311232311','02311232320','02311233000','02311233001','02311233002','02311233003','02311233010','02311233011','02311233012','02311233013','02311233020','02311233021','02311233022','02311233100','02311233102','02311233200','02311300101','02311300103','02311300110','02311300111','02311300112','02311300113','02311300121','02311300123','02311300130','02311300131','02311300132','02311300133','02311300310','02311300311','02311300312','02311300313','02311300330','02311300331','02311301000','02311301001','02311301002','02311301003','02311301010','02311301012','02311301020','02311301021','02311301022','02311301023','02311301030','02311301200','02311301201','02311301202','02311301203','02311301220','02311301221','02311313111','02311313112','02311313113','02311313130','02311313131','02311313132','02311313133','02311323131','02311323133','02311323311','02311332020','02311332021','02311332022','02311332023','02311332032','02311332200','02311332201','02311332210','02312001000','02312001001','02312001002','02312100001','02312100003','02312100010','02312100011','02312100012','02312100013','02312100031','02312100033','02312100100','02312100102','02312100120','02312100122','02313003321','02313003323','02313003330','02313003331','02313003332','02313003333','02313012001','02313012003','02313012010','02313012011','02313012012','02313012013','02313012021','02313012023','02313012030','02313012031','02313012032','02313012033','02313012102','02313012103','02313012112','02313012120','02313012121','02313012122','02313012123','02313012130','02313012210','02313012211','02313012220','02313012222','02313012223','02313012300','02313012301','02313013123','02313013132','02313013133','02313013301','02313013310','02313013311','02313013312','02313013313','02313013330','02313013331','02313013333','02313021101','02313021103','02313021110','02313021111','02313021112','02313021113','02313021121','02313021130','02313021131','02313023201','02313023203','02313023210','02313023212','02313023221','02313023230','02313030000','02313030001','02313030002','02313030003','02313030010','02313030020','02313032013','02313032030','02313032031','02313032032','02313032033','02313032120','02313032121','02313032122','02313032123','02313032130','02313032131','02313032132','02313032133','02313032210','02313032211','02313032300','02313032301','02313032310','02313032311','02313100221','02313100223','02313100230','02313100232','02313100233','02313102001','02313102003','02313102010','02313102011','02313102012','02313102013','02313102021','02313102022','02313102023','02313102030','02313102031','02313102032','02313102033','02313102102','02313102120','02313102200','02313102201','02313102202','02313102203','02313102210','02313102211','02313102212','02313102213','02313102220','02313102221','02313102222','02313102223','02313102230','02313102231','02313102232','02313102233','02313102302','02313102320','02313102322','02313102332','02313102333','02313112031','02313112032','02313112033','02313112120','02313112121','02313112122','02313112123','02313112210','02313112211','02313112300','02313112301','02313113032','02313113033','02313113121','02313113122','02313113123','02313113130','02313113132','02313113210','02313113211','02313113212','02313113213','02313113230','02313113231','02313113232','02313113233','02313113300','02313113301','02313113302','02313113303','02313113311','02313113313','02313113320','02313113321','02313113322','02313113323','02313113330','02313113331','02313113332','02313113333','02313120001','02313120010','02313120011','02313120012','02313120013','02313120030','02313120031','02313120032','02313120100','02313120101','02313120102','02313120103','02313120110','02313120111','02313120120','02313131100','02313131101','02313131103','02313131110','02313131111','02313131112','02313131113','02313131121','02313131130','02313131131','02313131132','02313131133','02313210123','02313210132','02313210211','02313210213','02313210231','02313210300','02313210301','02313210302','02313210303','02313210310','02313210311','02313210312','02313210313','02313210320','02313210321','02313210322','02313210323','02313210330','02313210331','02313210332','02313210333','02313212101','02313212110','03022203201','03022203202','03022203203','03022203210','03022203211','03022203212','03022203213','03022203220','03022203221','03022203222','03022203223','03022203230','03022203231','03022203232','03022203233','03022203300','03022203302','03022203320','03022203322','03022220013','03022220031','03022220033','03022220102','03022220103','03022220112','03022220113','03022220120','03022220121','03022220122','03022220123','03022220130','03022220131','03022220132','03022220133','03022220211','03022220300','03022220301','03022220310','03022220311','03022221000','03022221001','03022221003','03022221010','03022221011','03022221012','03022221013','03022221021','03022221023','03022221030','03022221031','03022221032','03022221033','03022221100','03022221102','03022221120','03022221121','03022221122','03022221201','03022221210','03022221211','03022221300','03022231301','03022231303','03022231310','03022231311','03022231312','03022231313','03022231321','03022231323','03022231330','03022231331','03022231332','03022231333','03022302230','03022302231','03022302232','03022302233','03022302320','03022302321','03022302322','03022302323','03022302332','03022313313','03022313330','03022313331','03022313332','03022313333','03022320010','03022320011','03022320012','03022320013','03022320030','03022320031','03022320100','03022320101','03022320102','03022320103','03022320200','03022320201','03022320202','03022320203','03022320220','03022320221','03022320222','03022320223','03022320300','03022320301','03022320302','03022320303','03022320310','03022320311','03022320312','03022320313','03022320320','03022320321','03022320322','03022320323','03022320330','03022320331','03022320332','03022320333','03022321200','03022321202','03022322030','03022322031','03022322032','03022322033','03022322110','03022322120','03022322121','03022322122','03022322123','03022322130','03022322132','03022322210','03022322211','03022322212','03022322213','03022322230','03022322231','03022322300','03022322301','03022322302','03022322303','03022322320','03022322321','03022323021','03022323022','03022323023','03022323122','03022323123','03022323132','03022323133','03022323200','03022323201','03022323202','03022323203','03022323210','03022323211','03022323212','03022323213','03022323231','03022323233','03022323300','03022323301','03022323302','03022323303','03022323310','03022323311','03022323312','03022323313','03022323320','03022323321','03022323322','03022323323','03022323330','03022323331','03022330332','03022330333','03022331110','03022331111','03022331113','03022331123','03022331130','03022331131','03022331132','03022331133','03022331211','03022331212','03022331213','03022331220','03022331221','03022331222','03022331223','03022331230','03022331231','03022331232','03022331233','03022331300','03022331301','03022331302','03022331303','03022331310','03022331311','03022331312','03022331313','03022331320','03022331321','03022331322','03022331323','03022331330','03022331331','03022331332','03022331333','03022332003','03022332012','03022332013','03022332020','03022332021','03022332022','03022332023','03022332030','03022332031','03022332032','03022332033','03022332101','03022332103','03022332110','03022332111','03022332112','03022332113','03022332200','03022332201','03022332202','03022332203','03022332210','03022332211','03022332212','03022332213','03022332220','03022332221','03022332231','03022332232','03022332233','03022332320','03022332321','03022332322','03022332323','03022333000','03022333001','03022333002','03022333003','03022333010','03022333011','03022333012','03022333013','03022333100','03022333101','03022333110','03022333111','03023202202','03023202203','03023202212','03023202213','03023202220','03023202221','03023202222','03023202223','03023202230','03023202231','03023202232','03023202233','03023202302','03023202303','03023202320','03023202321','03023202322','03023202323','03023202330','03023202331','03023202332','03023202333','03023203130','03023203131','03023203132','03023203133','03023203202','03023203203','03023203212','03023203213','03023203220','03023203221','03023203222','03023203223','03023203230','03023203231','03023203232','03023203233','03023203300','03023203301','03023203302','03023203303','03023203310','03023203311','03023203312','03023203313','03023203320','03023203321','03023203322','03023203323','03023203330','03023203331','03023203332','03023203333','03023210110','03023210111','03023210112','03023210113','03023210131','03023210133','03023210230','03023210231','03023210232','03023210233','03023210311','03023210313','03023210322','03023210331','03023210333','03023211000','03023211001','03023211002','03023211003','03023211010','03023211011','03023211012','03023211013','03023211020','03023211021','03023211022','03023211023','03023211030','03023211031','03023211032','03023211033','03023211132','03023211200','03023211201','03023211202','03023211203','03023211210','03023211211','03023211212','03023211213','03023211220','03023211221','03023211222','03023211223','03023211230','03023211231','03023211232','03023211233','03023211300','03023211301','03023211302','03023211303','03023211310','03023211312','03023211313','03023211320','03023211321','03023211322','03023211323','03023211330','03023211331','03023211332','03023212001','03023212002','03023212003','03023212010','03023212011','03023212012','03023212013','03023212020','03023212021','03023212022','03023212023','03023212030','03023212031','03023212032','03023212033','03023212100','03023212102','03023212111','03023212120','03023212122','03023212200','03023212201','03023212202','03023212203','03023212210','03023212211','03023212212','03023212213','03023212220','03023212222','03023212223','03023212232','03023212233','03023212300','03023212332','03023213000','03023213001','03023213002','03023213003','03023213010','03023213011','03023213012','03023213013','03023213021','03023213030','03023213031','03023213100','03023213101','03023213102','03023213103','03023213110','03023213112','03023213120','03023213121','03023213123','03023213130','03023213132','03023213133','03023213300','03023213301','03023213303','03023213310','03023213311','03023213312','03023213313','03023213321','03023213323','03023213330','03023213331','03023213332','03023213333','03023220000','03023220001','03023220002','03023220003','03023220010','03023220011','03023220012','03023220013','03023220020','03023220021','03023220022','03023220023','03023220030','03023220031','03023220032','03023220033','03023220100','03023220101','03023220102','03023220103','03023220110','03023220111','03023220112','03023220113','03023220120','03023220122','03023220130','03023220131','03023220132','03023220133','03023220200','03023220201','03023220202','03023220203','03023220210','03023220211','03023220212','03023220213','03023220220','03023220221','03023220222','03023220223','03023220230','03023220231','03023220232','03023220233','03023220300','03023220301','03023220302','03023220303','03023220310','03023220311','03023220312','03023220313','03023220320','03023220321','03023220322','03023220323','03023220330','03023220331','03023220332','03023220333','03023221000','03023221001','03023221002','03023221003','03023221010','03023221011','03023221012','03023221013','03023221020','03023221021','03023221022','03023221023','03023221030','03023221031','03023221032','03023221033','03023221100','03023221101','03023221102','03023221103','03023221110','03023221111','03023221112','03023221113','03023221120','03023221121','03023221122','03023221123','03023221130','03023221131','03023221132','03023221200','03023221201','03023221202','03023221203','03023221210','03023221211','03023221213','03023221220','03023221221','03023221222','03023221223','03023221230','03023221231','03023221232','03023221300','03023221301','03023221302','03023221303','03023221310','03023221311','03023221312','03023221313','03023221320','03023221321','03023221322','03023221323','03023221330','03023221331','03023221332','03023221333','03023222000','03023222001','03023222010','03023222011','03023222100','03023222101','03023222110','03023222111','03023223000','03023223001','03023223010','03023223100','03023223101','03023223110','03023223111','03023230000','03023230001','03023230002','03023230003','03023230010','03023230012','03023230013','03023230020','03023230021','03023230030','03023230031','03023230102','03023230110','03023230111','03023230112','03023230113','03023230120','03023230130','03023230131','03023230331','03023230333','03023231000','03023231001','03023231002','03023231003','03023231010','03023231012','03023231020','03023231021','03023231101','03023231102','03023231103','03023231110','03023231111','03023231112','03023231113','03023231130','03023231131','03023231132','03023231133','03023231200','03023231201','03023231202','03023231203','03023231210','03023231211','03023231212','03023231213','03023231220','03023231221','03023231222','03023231223','03023231230','03023231231','03023231232','03023231233','03023231300','03023231302','03023231310','03023231311','03023231312','03023231313','03023231320','03023231321','03023231322','03023231323','03023231330','03023231331','03023231332','03023231333','03023233101','03023233110','03023233111','03023233212','03023233213','03023233221','03023233223','03023233230','03023233231','03023233232','03023233233','03023233320','03023233322','03023233333','03023320020','03023320021','03023320022','03023320023','03023320030','03023320031','03023320032','03023320033','03023320120','03023320121','03023320122','03023320123','03023320130','03023320131','03023320132','03023320133','03023320200','03023320201','03023320202','03023320203','03023320210','03023320211','03023320212','03023320213','03023320220','03023320221','03023320222','03023320223','03023320230','03023320231','03023320232','03023320233','03023320300','03023320301','03023320302','03023320303','03023320310','03023320311','03023320312','03023320313','03023320320','03023320321','03023320322','03023320323','03023320330','03023320331','03023320332','03023320333','03023321003','03023321013','03023321020','03023321021','03023321022','03023321023','03023321030','03023321031','03023321032','03023321033','03023321102','03023321103','03023321120','03023321121','03023321122','03023321123','03023321130','03023321132','03023321200','03023321201','03023321202','03023321203','03023321210','03023321211','03023321212','03023321213','03023321220','03023321221','03023321222','03023321223','03023321230','03023321231','03023321232','03023321233','03023321300','03023321301','03023321302','03023321320','03023321321','03023321322','03023321323','03023321332','03023322000','03023322001','03023322010','03023322011','03023322100','03023322101','03023322110','03023322111','03023322222','03023322223','03023322231','03023322232','03023322233','03023322312','03023322320','03023322321','03023322322','03023322323','03023322330','03023322332','03023322333','03023323000','03023323001','03023323002','03023323003','03023323010','03023323011','03023323012','03023323013','03023323020','03023323021','03023323023','03023323030','03023323031','03023323032','03023323033','03023323100','03023323101','03023323102','03023323103','03023323110','03023323112','03023323113','03023323120','03023323121','03023323122','03023323123','03023323130','03023323131','03023323132','03023323133','03023323201','03023323210','03023323211','03023323300','03023323301','03023323302','03023323303','03023323310','03023323311','03023323312','03023323313','03023330222','03023330223','03023332000','03023332001','03023332002','03023332003','03023332010','03023332012','03023332020','03023332021','03023332022','03023332023','03023332030','03023332032','03023332201','03023332202','03023332203','03023332212','03023332220','03023332221','03131013130','03131013131','03131013132','03131013133','03131102020','03131102022','03131121130','03131121131','03131121132','03131121133','03131121310','03131121311','03131121312','03131121313','03131123313','03131123331','03131130022','03131130023','03131130200','03131130201','03131130331','03131130333','03131131202','03131131203','03131131212','03131131220','03131131221','03131131222','03131131230','03131132030','03131132031','03131132032','03131132033','03131132111','03131132120','03131132122','03131132132','03131132133','03131132202','03131132220','03131132231','03131132233','03131132310','03131132311','03131132320','03131132321','03131132322','03131132323','03131132330','03131132332','03131132333','03131133000','03131133020','03131133021','03131133022','03131133023','03131133030','03131133032','03131133100','03131133101','03131133102','03131133103','03131133200','03131133201','03131133203','03131133210','03131133212','03131133220','03131133221','03131133223','03131133230','03131133232','03131133323','03131133330','03131133332','03131301222','03131301223','03131301232','03131303000','03131303001','03131303010','03131303101','03131303102','03131303103','03131303110','03131303112','03131303120','03131303121','03131303130','03131310011','03131310022','03131310031','03131310033','03131310100','03131310101','03131310102','03131310103','03131310110','03131310111','03131310112','03131310113','03131310200','03131310212','03131310213','03131310230','03131310231','03131310302','03131310323','03131310332','03131311012','03131311013','03131311030','03131311031','03131311113','03131311131','03131311220','03131311221','03131311222','03131311223','03131311303','03131311312','03131311320','03131311321','03131311322','03131311323','03131311330','03131311331','03131311332','03131311333','03131312000','03131312001','03131312002','03131312003','03131312010','03131312012','03131312013','03131312020','03131312021','03131312030','03131312031','03131312101','03131312103','03131312110','03131312112','03131312312','03131312313','03131312322','03131312323','03131312330','03131312331','03131312332','03131312333','03131313100','03131313101','03131313110','03131313111','03131313113','03131313130','03131313131','03131313202','03131313203','03131313212','03131313220','03131313221','03131313222','03131313223','03131313230','03131313232','03131313233','03131313321','03131313322','03131313323','03131313330','03131313331','03131313332','03131313333','03131330100','03131330101','03131330110','03133131222','03133131223','03133311102','03133311103','03133311120','03133311121','03200000320','03200000321','03200000322','03200000323','03200000330','03200000331','03200000332','03200000333','03200002100','03200002101','03200002102','03200002103','03200002110','03200002111','03200002112','03200002113','03200002120','03200002121','03200002130','03200010232','03200010233','03200010303','03200010312','03200010313','03200010321','03200010322','03200010323','03200010330','03200010331','03200010332','03200010333','03200011233','03200011322','03200011323','03200012010','03200012011','03200012012','03200012013','03200012030','03200012031','03200012100','03200012101','03200012102','03200012103','03200012110','03200012111','03200012112','03200012113','03200012120','03200012121','03200012122','03200012123','03200012130','03200012131','03200012132','03200012133','03200012301','03200012310','03200012311','03200013011','03200013013','03200013100','03200013101','03200013102','03200013103','03200013131','03200013301','03200013303','03200013310','03200013311','03200013312','03200013313','03200013321','03200013330','03200013331','03200021301','03200021303','03200021310','03200021312','03200021321','03200021323','03200021330','03200023130','03200023131','03200023132','03200023133','03200023311','03200031310','03200031311','03200031312','03200031313','03200031330','03200031331','03200031333','03200032020','03200032021','03200032022','03200032023','03200032200','03200032201','03200100311','03200100312','03200100313','03200100322','03200100323','03200100330','03200100331','03200100332','03200100333','03200101202','03200101220','03200101221','03200101222','03200101223','03200102020','03200102021','03200102022','03200102023','03200102030','03200102032','03200102100','03200102101','03200102102','03200102103','03200102110','03200102111','03200102112','03200102113','03200102200','03200102201','03200102202','03200102203','03200102210','03200102212','03200102220','03200103000','03200103001','03200103002','03200110010','03200110011','03200110100','03200110101','03200110323','03200110330','03200110331','03200110332','03200110333','03200111220','03200111222','03200111223','03200112101','03200112103','03200112110','03200112111','03200112112','03200112113','03200113000','03200113001','03200113002','03200113003','03200120122','03200120123','03200120132','03200120200','03200120202','03200120220','03200120222','03200120300','03200120301','03200120302','03200120303','03200120310','03200120312','03200133020','03200133021','03200133022','03200133023','03200202000','03200202001','03200202002','03200202003','03200202010','03200202012','03200202020','03200202021','03200202022','03200202023','03200202030','03200202032','03200203001','03200203003','03200203010','03200203011','03200203012','03200203013','03200203021','03200203023','03200203030','03200203031','03200203032','03200203033','03200210033','03200210122','03200210211','03200210212','03200210213','03200210230','03200210231','03200210300','03200210301','03200210302','03200210303','03200210310','03200210320','03200210321','03200213032','03200213033','03200213103','03200213112','03200213113','03200213121','03200213122','03200213123','03200213130','03200213131','03200213132','03200213133','03200213210','03200213211','03200213300','03200221311','03200221313','03200221331','03200230021','03200230022','03200230023','03200230030','03200230032','03200230033','03200230101','03200230102','03200230103','03200230110','03200230111','03200230112','03200230113','03200230120','03200230121','03200230122','03200230130','03200230131','03200230132','03200230200','03200230201','03200230202','03200230203','03200230210','03200230211','03200230212','03200230213','03200230220','03200230221','03200230222','03200230223','03200230230','03200230231','03200230232','03200230300','03200230302','03200231002','03200231020','03200231103','03200231112','03200231113','03200231121','03200231123','03200231130','03200231131','03200231132','03200231133','03200231301','03200231303','03200231310','03200231311','03200231312','03200231313','03200231331','03200232120','03200232121','03200232122','03200232123','03200232130','03200232131','03200232132','03200232133','03200232211','03200232213','03200232300','03200232301','03200232302','03200232303','03200232310','03200232311','03200232312','03200232313','03200300223','03200300232','03200300233','03200300322','03200302001','03200302002','03200302003','03200302010','03200302011','03200302012','03200302013','03200302020','03200302021','03200302022','03200302023','03200302030','03200302031','03200302032','03200302100','03200302102','03200302222','03200302223','03200302232','03200320000','03200320001','03200320002','03200320003','03200320010','03200320012','03200320013','03200320020','03200320021','03200320022','03200320023','03200320030','03200320031','03200320032','03200320103','03200320112','03200320120','03200320121','03200320123','03200320130','03200320132','03200320200','03200320201','03200320202','03200320210','03200320220','03200331132','03200331133','03200331310','03200331311','03200332203','03200332212','03200332220','03200332221','03200332222','03200332223','03200332230','03200332231','03200332232','03200332233','03200332322','03201000333','03201001203','03201001212','03201001213','03201001220','03201001221','03201001222','03201001223','03201001230','03201001231','03201001232','03201001233','03201001320','03201001322','03201001323','03201002111','03201002113','03201002303','03201002311','03201002312','03201002313','03201002321','03201002330','03201002331','03201002332','03201002333','03201003000','03201003001','03201003002','03201003003','03201003010','03201003011','03201003012','03201003013','03201003022','03201003023','03201003030','03201003031','03201003032','03201003033','03201003100','03201003101','03201003102','03201003103','03201003110','03201003112','03201003120','03201003121','03201003122','03201003123','03201003200','03201003201','03201003202','03201003203','03201003210','03201003211','03201003212','03201003213','03201003220','03201003221','03201003222','03201003223','03201003230','03201003231','03201003232','03201003233','03201003300','03201003301','03201003302','03201003303','03201003322','03201010032','03201010131','03201010132','03201010133','03201010201','03201010203','03201010210','03201010211','03201010212','03201010213','03201010221','03201010230','03201010231','03201010232','03201010233','03201010300','03201010301','03201010302','03201010303','03201010310','03201010311','03201010312','03201010313','03201010320','03201010321','03201010322','03201010323','03201010330','03201010331','03201011000','03201011001','03201011002','03201011003','03201011010','03201011011','03201011012','03201011013','03201011020','03201011021','03201011022','03201011023','03201011030','03201011031','03201011032','03201011033','03201011100','03201011101','03201011102','03201011103','03201011110','03201011111','03201011112','03201011113','03201011120','03201011121','03201011122','03201011123','03201011130','03201011131','03201011200','03201011201','03201011202','03201011203','03201011210','03201011211','03201011212','03201011213','03201011220','03201011221','03201011222','03201011223','03201011230','03201011231','03201011232','03201012011','03201012100','03201012101','03201012112','03201012113','03201012121','03201012123','03201012130','03201012131','03201012132','03201012133','03201012301','03201012303','03201012310','03201012311','03201012312','03201012313','03201012321','03201012323','03201012330','03201012332','03201013000','03201013001','03201013002','03201013003','03201013010','03201013012','03201013020','03201013021','03201013022','03201013023','03201013030','03201013200','03201020111','03201020132','03201020133','03201021000','03201021001','03201021002','03201021003','03201021010','03201021011','03201021012','03201021013','03201021031','03201022110','03201022111','03201022112','03201022113','03201022130','03201022131','03201023230','03201023231','03201023232','03201023233','03201023302','03201023303','03201023312','03201023313','03201023320','03201023321','03201023322','03201023323','03201023330','03201023331','03201023332','03201023333','03201030031','03201030033','03201030120','03201030121','03201030122','03201030123','03201032220','03201032222','03201100000','03201100001','03201100002','03201100003','03201100010','03201100011','03201100012','03201100013','03201100020','03201100021','03201100100','03201100101','03201100102','03201100110','03201201010','03201201011','03201201100','03201201101','03201201110','03201201111','03201210000','03201210002','03201210020','03201210021','03201210022','03201210023','03201210201','03201210203','03201210210','03201210212','03201210230','03201210232','03201212002','03201212003','03201212010','03201212012','03201220022','03201220200','03202002022','03202002023','03202002032','03202002200','03202002201','03202002202','03202002210','03202010333','03202011222','03202011223','03202011232','03202012111','03202012113','03202012130','03202012131','03202013000','03202013001','03202013002','03202013003','03202013010','03202013012','03202013020','03202013021','03202101311','03202101313','03202101323','03202101332','03202101333','03202102331','03202102333','03202103101','03202103103','03202103110','03202103111','03202103112','03202103113','03202103121','03202103122','03202103123','03202103130','03202103131','03202103132','03202103133','03202103202','03202103203','03202103220','03202103221','03202103222','03202103223','03202103310','03202103311','03202110001','03202110003','03202110010','03202110011','03202110012','03202110013','03202110100','03202110200','03202110201','03202110202','03202110203','03202110220','03202112000','03202112002','03202112003','03202112020','03202112021','03202112022','03202112023','03202112200','03202112201','03202121023','03202121032','03202121033','03202121201','03202121203','03202121210','03202121211','03202121212','03202121213','03202121300','03202121302','03202121311','03202121313','03202121323','03202121331','03202121332','03202121333','03202123001','03202123003','03202123010','03202123011','03202123012','03202123013','03202123021','03202123023','03202123030','03202123031','03202123032','03202123033','03202123100','03202123101','03202123102','03202123103','03202123110','03202123111','03202123112','03202123113','03202123120','03202123121','03202123122','03202123123','03202123130','03202123131','03202123132','03202123133','03202123201','03202123210','03202123211','03202123212','03202123213','03202123300','03202123301','03202123310','03202123311','03202130023','03202130200','03202130201','03202130202','03202130203','03202130210','03202130212','03202130213','03202130220','03202130221','03202130222','03202130223','03202130230','03202130231','03202130232','03202130233','03202130322','03202132000','03202132001','03202132002','03202132003','03202132010','03202132011','03202132012','03202132013','03202132020','03202132021','03202132022','03202132023','03202132030','03202132031','03202132032','03202132033','03202132100','03202132102','03202132120','03202132122','03202132200','03202132201','03202132210','03202132211','03202132300','03202301011','03202301013','03202301031','03202301033','03202301100','03202301102','03202301103','03202301112','03202301113','03202301120','03202301121','03202301122','03202301123','03202301130','03202301131','03202301132','03202301133','03202301300','03202301301','03202301310','03202301311','03202301312','03202301313','03202310002','03202310020','03202310022','03202310133','03202310200','03202310311','03202310312','03202310313','03202310321','03202310323','03202310330','03202310331','03202310332','03202310333','03202311002','03202311020','03202311022','03202311200','03202311202','03202311220','03202311222','03202312100','03202312101','03202312102','03202312103','03202312110','03202312111','03202312112','03202312113','03202312121','03202312123','03202312130','03202312131','03202312132','03202312133','03202313000','03202313002','03311103000','03311103001','03311120231','03311120233','03311120320','03311120321','03311120322','03311120323','12002131202','12002131203','12002131212','12002131221','12002131230','12020022312','12020022313','12020022330','12020022331','12020022332','12020022333','12020023202','12020023220','12020023221','12020023222','12020023223','12020023230','12020023232','12020122100','12020122101','12020122102','12020122103','12020122232','12020122233','12020131000','12020131001','12020131002','12020131003','12020131120','12020131121','12020131122','12020131123','12020200002','12020200003','12020200020','12020200021','12020200022','12020200023','12020200220','12020200221','12020200222','12020200223','12020200232','12020200233','12020200302','12020200303','12020200322','12020200330','12020202000','12020202001','12020202002','12020202003','12020202010','12020202011','12020202012','12020202013','12020202020','12020202021','12020202100','12020202101','12020202102','12020202113','12020202121','12020202122','12020202123','12020202130','12020202131','12020202223','12020202230','12020202231','12020202232','12020202233','12020202300','12020202301','12020202303','12020202310','12020202311','12020202312','12020202320','12020203002','12020203020','12020211232','12020211233','12020211331','12020213010','12020213011','12020213331','12020213333','12020220001','12020300010','12020300011','12020300202','12020300203','12020300220','12020300221','12020302012','12020302013','12020302030','12020302031','12020302220','12020302221','12020302222','12020302230','12020302232','12020311100','12020311101','12020313310','12020313312','12020313313','12020313330','12020313331','12020322101','12020322103','12020322110','12020322311','12020322313','12020323131','12020323133','12020323202','12020323311','12020323331','12020323333','12020330212','12020330213','12020330231','12020330320','12020331222','12020331323','12020331332','12020332020','12020332022','12020332200','12020332220','12020332222','12020332223','12020332233','12020332302','12020332320','12020332322','12020333000','12020333112','12020333121','12020333123','12020333130','12020333131','12020333132','12020333133','12020333310','12020333311','12021002322','12021002323','12021003203','12021003212','12021003221','12021003223','12021003230','12021003232','12021003301','12021003303','12021003310','12021003321','12021020100','12021020101','12021200021','12021200023','12021200030','12021200032','12021200110','12021200111','12021200112','12021200113','12021200210','12021200302','12021200303','12021200312','12021200320','12021200321','12021200330','12021201001','12021201003','12021201010','12021201012','12021202011','12021202013','12021202100','12021202102','12021202103','12021202112','12021202113','12021202120','12021202121','12021202123','12021202130','12021202131','12021202132','12021202202','12021202203','12021202212','12021202220','12021202221','12021202230','12021202320','12021202321','12021202322','12021202323','12021203221','12021203222','12021203223','12021203301','12021203303','12021203310','12021203312','12021210221','12021210223','12021210230','12021212123','12021212300','12021212301','12021220102','12021220103','12021220120','12021220121','12021220221','12021220223','12021220230','12021220232','12022020023','12022020032','12022020201','12022020210','12022021003','12022021021','12022032003','12022032012','12022032021','12022032030','12022033013','12022033030','12022033031','12022033033','12022033102','12022033120','12022033122','12022033200','12022033201','12022033202','12022033203','12022101110','12022101112','12022101113','12022101122','12022101123','12022101300','12022101301','12022101322','12022101333','12022103100','12022110001','12022110011','12022110012','12022110013','12022110030','12022110031','12022110033','12022110100','12022110101','12022110102','12022110103','12022110111','12022110112','12022110113','12022110120','12022110122','12022110130','12022110131','12022110222','12022111000','12022111001','12022111002','12022111200','12022111201','12022111301','12022111303','12022111310','12022111312','12022112031','12022112033','12022112120','12022112122','12022113012','12022113030','12022122023','12022122201','12022122210','12022123232','12022123233','12022123313','12022123322','12022123331','12022131333','12022132122','12022132123','12022132130','12022132131','12022132132','12022132133','12022132202','12022132211','12022132212','12022132213','12022132220','12022132230','12022132231','12022132233','12022132300','12022132301','12022132302','12022132320','12022132321','12022132322','12022132330','12022133023','12022133032','12022133111','12022133201','12022133210','12022133222','12022133223','12022133323','12022202133','12022202311','12022203022','12022203200','12022212123','12022212132','12022212212','12022212230','12022212301','12022212310','12022213002','12022213003','12022213010','12022213011','12022213012','12022213013','12022213020','12022213021','12022213030','12022213032','12022213310','12022213311','12022213312','12022213313','12022213330','12022213331','12022222031','12022222033','12022222330','12022222331','12022222332','12022222333','12022223220','12022230020','12022230022','12022301010','12022301011','12022301013','12022301100','12022301102','12022301112','12022301113','12022301331','12022302133','12022302311','12022303021','12022303022','12022303023','12022303030','12022303200','12022310000','12022310001','12022310002','12022310003','12022310110','12022310111','12022310203','12022310210','12022310211','12022310212','12022310213','12022310220','12022311030','12022311031','12022311033','12022311120','12022311121','12022311122','12022311123','12022311130','12022311132','12022311301','12022311310','12022311311','12022313001','12022313003','12022313010','12022313012','12022313013','12022313030','12022313031','12022313032','12022313033','12022313101','12022313102','12022313103','12022313110','12022313112','12022313113','12022313120','12022313131','12022313133','12022313210','12022331112','12022331113','12022331130','12022331131','12023000002','12023000003','12023000120','12023000121','12023000122','12023000123','12023000203','12023000212','12023000220','12023000221','12023000222','12023000223','12023000230','12023000232','12023002100','12023002101','12023002102','12023002103','12023021232','12023021233','12023022023','12023022032','12023022111','12023022113','12023022121','12023022123','12023022130','12023022132','12023022201','12023022210','12023022211','12023022213','12023022232','12023022233','12023022301','12023022302','12023022303','12023022310','12023022311','12023022312','12023022321','12023022323','12023022330','12023022332','12023023000','12023023002','12023023010','12023023011','12023200003','12023200010','12023200011','12023200012','12023200021','12023200030','12023200200','12023200201','12023200202','12023200212','12023200213','12023200230','12023200231','12023200301','12023200303','12023200310','12023200312','12023200320','12023200322','12023200323','12023200333','12023202002','12023202020','12023202022','12023202111','12023202202','12023202211','12023202213','12023202220','12023202323','12023202332','12023203000','12023203002','12023203003','12023203012','12023203021','12023203030','12023203122','12023203123','12023203300','12023203301','12023220101','12023220110','12023220133','12023220300','12023220301','12023220302','12023220303','12023220311','12023220323','12023220332','12023220333','12023221022','12023221102','12023221103','12023221112','12023221121','12023221123','12023221130','12023221132','12023221200','12023221222','12023222101','12023222103','12023222110','12023222111','12023222112','12023222113','12023222121','12023222130','12023222131','12023223000','12023223001','12023223002','12023223003','12023223022','12023223023','12023223200','12023223201','12023230200','12023230201','12023230202','12023230203','12023232033','12023232231','12023232233','12023232320','12023232322','12023233200','12023233331','12023233333','12023322220','12023322222','12200110002','12200110003','12200110020','12200110021','12201010013','12201010031','12201010102','12201010120','12201011112','12201011130','12201013300','12201013323','12201013330','12201013332','12201013333','12201021211','12201021213','12201021300','12201021302','12201031110','12201031200','12201031201','12201031202','12201031203','12201031220','12201031221','12201032103','12201032112','12201100023','12201100032','12201100121','12201100130','12201100201','12201100210','12201100311','12201102203','12201102221'];this.Init=function(a){obliqueUrl=a};this.Destroy=function(){};function IsValidTile(b,c,a){return scene.IsValidTile(b,c,a)}function GetFilename(a,b,c){return scene.GetTileFilename(a,b,c)}function MetersPerPixel(d){if(!scene)return 0;var a=new Msn.VE.Pixel(MathRound(originX+offsetX+width/2),MathRound(originY+offsetY+height/2)),e=scene.PixelToLatLong(a,d);a.x++;var f=scene.PixelToLatLong(a,d),g=Math.sin(DegToRad(e.latitude)),h=Math.sin(DegToRad(f.latitude)),b=earthRadius/2*MathAbs(Math.log((1+g)/(1-g))-Math.log((1+h)/(1-h))),c=earthRadius*MathAbs(DegToRad(e.longitude)-DegToRad(f.longitude));return Math.sqrt(c*c+b*b)}function PixelToLatLong(b,a){return scene?scene.PixelToLatLong(b,a):null}function LatLongToPixel(b,a){return scene?scene.LatLongToPixel(b,a):null}function GetCurrentMaxZoomLevel(){return 2}function ValidateZoomLevel(a){if(a.zoomLevel>=2)tileLayerManager.SetMarketMaxZoom(2);if(a.zoomLevel<1)a.SetZoomLevel(1);else if(a.zoomLevel>2)a.SetZoomLevel(2)}function GetScene(){return scene}function GetBounds(){return scene.GetBounds()}function IsAvailable(){return available}function GetEventInfo(){if(!available)return null;var a=new Object;return a}function UpdateAvailability(){if(currentView.mapStyle==obliqueStyle)return;if(currentView.zoomLevel<=0)return;if(currentView.zoomLevel<MapControl.Features.BirdsEyeAtZoomLevel){scene=null;availableBefore=available;available=false;NotifyListeners();return}RequestSceneAtLatLong(currentView.latlong,"North",false,500)}function RequestSceneAtLatLong(a,b,d,c){CancelRequest();showOnLoad=d;if(!InBounds(a)){scene=null;availableBefore=available;available=false;NotifyListeners();return}requestUrl=obliqueUrl+"?ver=3&lat="+a.latitude+"&lon="+a.longitude;if(b)requestUrl+="&o="+b;if(c)timerId=window.setTimeout(SendRequest,c);else{SendRequest();timerId=-1}}function RequestScene(a){if(scene&&scene.GetID()==a)return;CancelRequest();showOnLoad=true;requestUrl=obliqueUrl+"?ver=3&id="+a;SendRequest()}function CancelRequest(){try{if(timerId!=-1)window.clearTimeout(timerId)}catch(a){}timerId=-1;try{if(xmlHttp){xmlHttp.onreadystatechange=null;xmlHttp.abort()}}catch(a){}}function SendRequest(){CancelRequest();if(!requestUrl)return;if(Msn.VE.API!=null){var a=new VENetwork;a.ServiceUrl=requestUrl;a.BeginInvoke("EndInvokeImagery",null,APIResponseHandler)}else{if(!xmlHttp)xmlHttp=GetXmlHttp();if(xmlHttp){xmlHttp.open("POST",requestUrl,true);xmlHttp.onreadystatechange=ResponseHandler;xmlHttp.send("")}}}function APIResponseHandler(a){availableBefore=available;if(a!=null){scene=a;available=true}else{scene=null;available=false}NotifyListeners()}function ResponseHandler(){if(!xmlHttp||xmlHttp.readyState!=4)return;timerId=-1;availableBefore=available;var code=xmlHttp.responseText;if(code)try{scene=eval(code+"EndInvokeImagery();");if(scene!=null)available=true;else available=false}catch(a){scene=null;available=false}else{scene=null;available=false}NotifyListeners()}function NotifyListeners(){if(showOnLoad){showOnLoad=false;if(available){var a=preferredView.MakeCopy();a.SetMapStyle(obliqueStyle,scene.GetID(),scene.GetOrientation());SetView(a);Fire("onobliquechange")}else{a=preferredView.MakeCopy();a.SetMapStyle(lastOrthoMapStyle);if(a.GetViewType()!="latlongRect")a.SetZoomLevel(lastOrthoZoomLevel);SetView(a);Fire("onerror",CreateEvent(currentView.latlong,currentView.zoomLevel,l900ast))}}if(availableBefore!=available)if(available)Fire("onobliqueenter");else Fire("onobliqueleave")}function InBounds(a){if(!a||!bounds||bounds.length==0)return false;var b=LatLongToQuadKey(a,bounds[0].length);return BinarySearchBounds(b,0,bounds.length-1)}function LatLongToQuadKey(g,c){var e=orthoMode.LatLongToPixel(g,c),h=MathFloor(e.x/tileSize),i=MathFloor(e.y/tileSize),d="";for(var b=c;b>0;b--){var a=0,f=1<<b-1;if((h&f)!=0)a++;if((i&f)!=0)a+=2;d+=a+""}return d}function BinarySearchBounds(a,d,c){if(c<d)return false;var b=MathFloor((d+c)/2);if(bounds[b]==a)return true;if(a<bounds[b])return BinarySearchBounds(a,d,b-1);return BinarySearchBounds(a,b+1,c)}this.IsValidTile=IsValidTile;this.GetFilename=GetFilename;this.MetersPerPixel=MetersPerPixel;this.PixelToLatLong=PixelToLatLong;this.LatLongToPixel=LatLongToPixel;this.GetBounds=GetBounds;this.ValidateZoomLevel=ValidateZoomLevel;this.IsAvailable=IsAvailable;this.UpdateAvailability=UpdateAvailability;this.CancelRequest=CancelRequest;this.GetEventInfo=GetEventInfo;this.GetScene=GetScene;this.RequestSceneAtLatLong=RequestSceneAtLatLong;this.RequestScene=RequestScene;this.GetCurrentMaxZoomLevel=GetCurrentMaxZoomLevel}function OrthoMode(){var a=[new Msn.VE.Bounds(1, 17, 0, 0, 2, 2),new Msn.VE.Bounds(18, 19, 35680, 82915, 83740, 113061),new Msn.VE.Bounds(18, 19, 123062, 74647, 132528, 89130),new Msn.VE.Bounds(18, 19, 12379, 112260, 20388, 119266),new Msn.VE.Bounds(18, 19, 80099, 115425, 85051, 119645),new Msn.VE.Bounds(18, 18, 216996, 80310, 242483, 117743)];this.Init=function(){};this.Destroy=function(){};function h(a,b,d){var c=1<<d;return a>=0&&b>=0&&a<c&&b<c}function g(c,d,f,b){var a=new VETileContext;a.XPos=c;a.YPos=d;a.ZoomLevel=f;a.MapStyle=currentView.mapStyle;var e=b.GetTilePath(a);return e}function b(a){return earthCircumference/((1<<a)*tileSize)}function f(d,e){var c=b(e),f=d.x*c-projectionOffset,g=projectionOffset-d.y*c,a=new Msn.VE.LatLong;a.latitude=RadToDeg(Math.PI/2-2*Math.atan(Math.exp(-g/earthRadius)));a.longitude=RadToDeg(f/earthRadius);return a}function e(d,f){var e=Math.sin(DegToRad(d.latitude)),g=earthRadius*DegToRad(d.longitude),h=earthRadius/2*Math.log((1+e)/(1-e)),c=b(f),a=new Msn.VE.Pixel;a.x=(projectionOffset+g)/c;a.y=(projectionOffset-h)/c;return a}function i(c){if(c==undefined)c=currentView;var d=c.zoomLevel,f=c.center.x+mapCenterOffset.x,g=c.center.y+mapCenterOffset.y;for(var b=0;b<a.length;b++){var h=d-a[b].z1,e=tileSize*Math.pow(2,h),k=a[b].x1*e,i=a[b].x2*e,l=a[b].y1*e,j=a[b].y2*e;if(f>=k&&f<=i&&g>=l&&g<=j)if(d>=a[b].z1&&d<=a[b].z2||d<=tileLayerManager.GetMaxTileZoom())return a[b]}}function c(e){var f=e.center.x+mapCenterOffset.x,g=e.center.y+mapCenterOffset.y,c=0;for(var b=0;b<a.length;b++){var d=tileSize*Math.pow(2,e.zoomLevel-a[b].z1),j=a[b].x1*d,h=a[b].x2*d,k=a[b].y1*d,i=a[b].y2*d;if(f>=j&&f<=h&&g>=k&&g<=i)c=Math.max(c,a[b].z2)}c=Math.max(c,tileLayerManager.GetMaxTileZoom());return c}function d(d){var f=d.center.x+mapCenterOffset.x,g=d.center.y+mapCenterOffset.y,c=0;for(var b=0;b<a.length;b++){var e=tileSize*Math.pow(2,d.zoomLevel-a[b].z1),j=a[b].x1*e,h=a[b].x2*e,k=a[b].y1*e,i=a[b].y2*e;if(f>=j&&f<=h&&g>=k&&g<=i){c=0;if(a[b].z2>=d.zoomLevel){tileLayerManager.SetMarketMaxZoom(a[b].z2);return}else if(a[b].z2>c){tileLayerManager.SetMarketMaxZoom(a[b].z2);c=a[b].z2;if(c<tileLayerManager.GetMaxTileZoom())if(d.zoomLevel<=tileLayerManager.GetMaxTileZoom())c=d.zoomLevel;else c=tileLayerManager.GetMaxTileZoom()}}}d.SetZoomLevel(c)}this.IsValidTile=h;this.GetFilename=g;this.MetersPerPixel=b;this.PixelToLatLong=f;this.LatLongToPixel=e;this.GetBounds=i;this.ValidateZoomLevel=d;this.GetCurrentMaxZoomLevel=c}function ThreeDMode(){var internalOrthoMode=new OrthoMode,bounds=[new Msn.VE.Bounds(1, 17, 0, 0, 2, 2),new Msn.VE.Bounds(18, 19, 35680, 82915, 83740, 113061),new Msn.VE.Bounds(18, 19, 123062, 74647, 132528, 89130),new Msn.VE.Bounds(18, 19, 12379, 112260, 20388, 119266),new Msn.VE.Bounds(18, 19, 80099, 115425, 85051, 119645),new Msn.VE.Bounds(18, 18, 216996, 80310, 242483, 117743)];this.Init=function(){};this.Destroy=function(){};function IsValidTile(b,c,a){return internalOrthoMode.IsValidTile(b,c,a)}function GetFilename(a,b,d,c){return internalOrthoMode.GetFilename(a,b,d,c)}function MetersPerPixel(a){return internalOrthoMode.MetersPerPixel(a)}function PixelToLatLong(pixel){if(!view3DCreated)return null;var lat,lon,latlonvalid,result=spacecontrol.PixelToLatLong(pixel.x,pixel.y);eval(result);if(latlonvalid!=0){var latlong=new Msn.VE.LatLong;latlong.latitude=RadToDeg(lat);latlong.longitude=RadToDeg(lon);return latlong}return null}function LatLongToPixel(latlong){if(!view3DCreated)return null;var x,y,xyvalid=0,result=spacecontrol.LatLongToPixel(latlong.latitude,latlong.longitude);eval(result);if(xyvalid!=0){var pixel=new Msn.VE.Pixel(x,y);return pixel}return null}function GetBounds(){return null}function GetCurrentMaxZoomLevel(){return 19}function ValidateZoomLevel(a){if(a.zoomLevel<1)a.SetZoomLevel(1);if(a.zoomLevel>19)a.SetZoomLevel(19)}function _InternalOrthoMode(){return internalOrthoMode}this._InternalOrthoMode=_InternalOrthoMode;this.IsValidTile=IsValidTile;this.GetFilename=GetFilename;this.MetersPerPixel=MetersPerPixel;this.PixelToLatLong=PixelToLatLong;this.LatLongToPixel=LatLongToPixel;this.GetBounds=GetBounds;this.ValidateZoomLevel=ValidateZoomLevel;this.GetCurrentMaxZoomLevel=GetCurrentMaxZoomLevel}function BoxTool(){var b=document.createElement("div"),a=document.createElement("div"),c=0,e=0,d=0,f=0;this.Init=function(){b.className="ZoomBox_bg";a.className="ZoomBox_fg";b.attachEvent("onmouseup",MouseUp);a.attachEvent("onmouseup",MouseUp);if(map!=null){map.appendChild(b);map.appendChild(a)}};this.Destroy=function(){b.detachEvent("onmouseup",MouseUp);a.detachEvent("onmouseup",MouseUp);if(map!=null){map.removeChild(b);map.removeChild(a)}};function i(b){if(typeof VE_ContextMenu!="undefined"&&VE_ContextMenu!=null){VE_ContextMenu.RemoveContextPin();VE_ContextMenu.CloseMenu()}x=GetLeftPosition(p_elSource);y=GetTopPosition(p_elSource);c=d=GetMouseX(b)-x+offsetX;e=f=GetMouseY(b)-y+offsetY;h(c,e,1,1);m();if(a.setCapture)a.setCapture()}function j(a){d=GetMouseX(a)-x+offsetX;f=GetMouseY(a)-y+offsetY;h(MathMin(c,d),MathMin(e,f),MathMax(1,MathAbs(d-c)),MathMax(1,MathAbs(f-e)))}function k(){if(MathAbs(c-d)>1&&MathAbs(e-f)>1){var b=preferredView.MakeCopy();b.SetZoomLevel(currentView.zoomLevel);b.SetPixelRectangle(new Msn.VE.PixelRectangle(new Msn.VE.Pixel(originX+c,originY+e),new Msn.VE.Pixel(originX+d,originY+f)));SetView(b)}l();if(a.releaseCapture)a.releaseCapture()}function h(e,f,d,c){g(b,e+1,f+1,d,c);g(a,e,f,d,c)}function g(a,d,e,c,b){a.style.left=d+"px";a.style.top=e+"px";a.style.width=c+"px";a.style.height=b+"px"}function m(){b.style.display="block";a.style.display="block"}function l(){b.style.display="none";a.style.display="none"}this.OnMouseDown=i;this.OnMouseMove=j;this.OnMouseUp=k}function PanTool(){var a=false;this.Init=function(){};this.Destroy=function(){};function b(b){a=false;lastMouseX=GetMouseX(b);lastMouseY=GetMouseY(b);if(p_elSource.setCapture)p_elSource.setCapture();x=GetLeftPosition(p_elSource);y=GetTopPosition(p_elSource);var d=originX+offsetX+GetMouseX(b)-x,e=originY+offsetY+GetMouseY(b)-y,c=CreateEvent(currentMode.PixelToLatLong(new Msn.VE.Pixel(d,e),currentView.zoomLevel));Fire("onstartcontinuouspan",c);Fire("onmousedown",c)}function c(d){var b=GetMouseX(d),c=GetMouseY(d);PanMap(lastMouseX-b,lastMouseY-c);lastMouseX=b;lastMouseY=c;a=true}function d(c){ComputeCenterPoint(true);if(p_elSource.releaseCapture)p_elSource.releaseCapture();if(a){Fire("onendcontinuouspan");Fire("onchangeview");a=false}var d=originX+offsetX+GetMouseX(c)-x,e=originY+offsetY+GetMouseY(c)-y,b=CreateEvent(currentMode.PixelToLatLong(new Msn.VE.Pixel(d,e),currentView.zoomLevel));Fire("onmouseup",b);Fire("onclick",b);return b}this.OnMouseDown=b;this.OnMouseMove=c;this.OnMouseUp=d}function GetTrafficAvailability(){return trafficAvailable}function GetSlidingExpirationForAutoRefresh(){return 1800000}function GetAutoRefreshRate(){return 300000}function GetMarketsFile(){return "http://t1.traffic.virtualearth.net/incidents/markets.js"}function GetIncidentsFile(){return "http://t0.traffic.virtualearth.net/incidents/market"}var setTrafficViewflag=true;function SetTrafficView(){var a=new VETileSourceSpecification;a.ID=trafficTiles;a.SourceName="http://t%2.traffic.virtualearth.net/Flow/t%4.png";a.NumServers=2;tileLayerManager.AddTileSource(a);tileLayerManager.LoadTileLayer("Traffic",a.ID,0.6,1)}function VETileLayerManager(){var c=[],a=[],b=[],i=[],j=[],h=null,e=true,d=17;this.AddTileSource=function(a){if(c[a.ID]==null||c[a.ID]=="undefined")c[a.ID]=a;};this.Add3DTileSource=function(f,e,g){if(trafficTiles==f)return;if(0==a[f].zIndex)return;var b='ID="'+e.ID+'" TILESOURCE="'+e.SourceName+'" MINZOOM="'+e.MinZoom+'" MAXZOOM="'+e.MaxZoom+'"',c=e.Bounds;if(typeof c!="undefined"&&c!=null){b=b+' Bounds="';for(var d=0;d<c.length;d++){if(d>0)b=b+",";b=b+c[d].TopLeftLatLong.Longitude+","+c[d].BottomRightLatLong.Latitude+","+c[d].BottomRightLatLong.Longitude+","+c[d].TopLeftLatLong.Latitude}b=b+'"'}g.AddImageSource(f,e.ID,b,a[f].zIndex,a[f].opacity)};this.AddAllTileSourcesTo3D=function(d){if(typeof Msn.VE.API!="undefined"&&Msn.VE.API!=null)for(var c=0;c<b.length;c++)this.Add3DTileSource(b[c],a[b[c]],d)};this.LoadBaseLayer=function(d,e,f,g){if(a[d]==null||a[d]=="undefined"){a[d]=c[e];b.push(d)}a[d].opacity=f;a[d].zIndex=g};this.LoadTileLayer=function(d,g,j,l){if(!e)return;if(a[d]==null||a[d]=="undefined"){a[d]=c[g];b.push(d)}if(a[d].currentTileList!=null)ClearTiles(a[d].currentTileList);a[d].currentTileList=[];a[d].oldTilesList=[];if(j!=null&&j!="undefined")a[d].opacity=j;else a[d].opacity=1;if(l!=null&&l!="undefined")a[d].zIndex=l;else a[d].zIndex=1;var h=false;if(typeof Msn.VE.API!="undefined"&&Msn.VE.API!=null){var k=f();if(typeof k!="undefined"&&k!=null)tileLayerManager.Add3DTileSource(d,c[g],k)}var i=c[g].MaxZoom;if(i==1)i=c[mapTiles].MaxZoom;if(currentView.zoomLevel>=c[g].MinZoom&&currentView.zoomLevel<=i)if(c[g].Bounds!="undefined"&&c[g].Bounds!=null)h=tileLayerManager.CheckTilesAvailability(g,d);else h=true;if(h){a[d].isActive=true;for(var n=tileViewportY1;n<=tileViewportY2;n++)for(var m=tileViewportX1;m<=tileViewportX2;m++){var o=RequestTile(m,n,currentView.zoomLevel,currentView.mapStyle,a[d],g,a[d].opacity,a[d].zIndex);a[d].currentTileList.push(o)}}};this.SetViewPort=function(){map.style.top="0px";map.style.left="0px";originX=MathRound(currentView.center.x-width/2);originY=MathRound(currentView.center.y-height/2);offsetX=0;offsetY=0;tileViewportX1=MathFloor((originX-buffer)/tileSize);tileViewportY1=MathFloor((originY-buffer)/tileSize);tileViewportX2=MathFloor((originX+width+buffer)/tileSize);tileViewportY2=MathFloor((originY+height+buffer)/tileSize);tileViewportWidth=tileViewportX2-tileViewportX1+1;tileViewportHeight=tileViewportY2-tileViewportY1+1};this.FinalizeView=function(){zooming=false;for(var c=0;c<b.length;c++){if(a[b[c]].oldTilesList!=null){ClearTiles(a[b[c]].oldTilesList);a[b[c]].oldTilesList=null}for(var d=0;d<a[b[c]].currentTileList.length;d++){a[b[c]].currentTileList[d].SwapStates();a[b[c]].currentTileList[d].ClearSteps();a[b[c]].currentTileList[d].SetFactor(0);a[b[c]].currentTileList[d].ClearStates()}}for(c=0;c<pushpins.length;c++){pushpins[c].SwapStates();pushpins[c].ClearSteps();pushpins[c].SetFactor(0)}window.setTimeout(ShowLines,250);if(copyright)copyright.Update();if(previousMapStyle!=currentView.mapStyle){Fire("onchangemapstyle");previousMapStyle=currentView.mapStyle}if(previousZoomLevel!=currentView.zoomLevel)Fire("onendzoom");Fire("onchangeview");if(obliqueMode)window.setTimeout(obliqueMode.UpdateAvailability,100);try{CollectGarbage()}catch(e){}};this.PanView=function(){if(!e)return;if(zooming)return;var h=originX+offsetX,i=originY+offsetY,j=MathFloor((h-buffer)/tileSize),l=MathFloor((i-buffer)/tileSize),k=MathFloor((h+width+buffer)/tileSize),m=MathFloor((i+height+buffer)/tileSize);while(tileViewportX1<j){for(var d=tileViewportHeight-1;d>=0;d--)for(var c=0;c<b.length;c++)if(a[b[c]].currentTileList.length>0){var g=a[b[c]].currentTileList.splice(d*tileViewportWidth,1)[0];try{g.RemoveFromMap()}catch(n){}}tileViewportX1++;tileViewportWidth--}while(tileViewportX1>j){tileViewportX1--;tileViewportWidth++;for(d=0;d<tileViewportHeight;d++)for(c=0;c<b.length;c++)if(a[b[c]].currentTileList.length>0){g=RequestTile(tileViewportX1,tileViewportY1+d,currentView.zoomLevel,currentView.mapStyle,a[b[c]],b[c],a[b[c]].opacity,a[b[c]].zIndex);a[b[c]].currentTileList.splice(d*tileViewportWidth,0,g)}}while(tileViewportY1<l){for(var f=0;f<tileViewportWidth;f++)for(c=0;c<b.length;c++)if(a[b[c]].currentTileList.length>0){g=a[b[c]].currentTileList.shift();try{g.RemoveFromMap()}catch(n){}}tileViewportY1++;tileViewportHeight--}while(tileViewportY1>l){tileViewportY1--;tileViewportHeight++;for(f=tileViewportWidth-1;f>=0;f--)for(c=0;c<b.length;c++)if(a[b[c]].currentTileList.length>0){g=RequestTile(tileViewportX1+f,tileViewportY1,currentView.zoomLevel,currentView.mapStyle,a[b[c]],b[c],a[b[c]].opacity,a[b[c]].zIndex);a[b[c]].currentTileList.unshift(g)}}while(tileViewportX2>k){for(d=tileViewportHeight-1;d>=0;d--)for(c=0;c<b.length;c++)if(a[b[c]].currentTileList.length>0){g=a[b[c]].currentTileList.splice(d*tileViewportWidth+tileViewportWidth-1,1)[0];try{g.RemoveFromMap()}catch(n){}}tileViewportX2--;tileViewportWidth--}while(tileViewportX2<k){tileViewportX2++;tileViewportWidth++;for(d=0;d<tileViewportHeight;d++)for(c=0;c<b.length;c++)if(a[b[c]].currentTileList.length>0){g=RequestTile(tileViewportX2,tileViewportY1+d,currentView.zoomLevel,currentView.mapStyle,a[b[c]],b[c],a[b[c]].opacity,a[b[c]].zIndex);a[b[c]].currentTileList.splice(d*tileViewportWidth+tileViewportWidth-1,0,g)}}while(tileViewportY2>m){for(f=0;f<tileViewportWidth;f++)for(c=0;c<b.length;c++)if(a[b[c]].currentTileList.length>0){g=a[b[c]].currentTileList.pop();try{g.RemoveFromMap()}catch(n){}}tileViewportY2--;tileViewportHeight--}while(tileViewportY2<m){tileViewportY2++;tileViewportHeight++;for(f=0;f<tileViewportWidth;f++)for(c=0;c<b.length;c++)if(a[b[c]].currentTileList.length>0){g=RequestTile(tileViewportX1+f,tileViewportY2,currentView.zoomLevel,currentView.mapStyle,a[b[c]],b[c],a[b[c]].opacity,a[b[c]].zIndex);a[b[c]].currentTileList.push(g)}}};this.StepAnimation=g;this.zoomView=function(f){if(!e)return;var j=originX+offsetX,k=originY+offsetY,m=currentView.zoomLevel,i=f.zoomLevel,g=MathRound(f.center.x-width/2),h=MathRound(f.center.y-height/2);a[mapTiles].oldTilesList=a[mapTiles].currentTileList;for(var c=0;c<b.length;c++)if(a[b[c]].ID==mapTiles)a[b[c]].currentTileList=[];else ClearTiles(a[b[c]].currentTileList);for(var d=0;d<a[mapTiles].oldTilesList.length;d++)a[mapTiles].oldTilesList[d].PrepareBaseTile(j,k,m,g,h,i);for(c=0;c<pushpins.length;c++)pushpins[c].PrepareForZoom(g,h,i);currentView.Destroy();currentView=f;var l=[];l=a[mapTiles].oldTilesList;this.SetViewPort();this.RefreshTileLayers();a[mapTiles].oldTilesList=l;for(d=0;d<a[mapTiles].currentTileList.length;d++)a[mapTiles].currentTileList[d].PrepareSwapTile(j,k,m,g,h,i);zoomCounter=1;this.StepAnimation()};function g(){if(!zooming)return;for(var b=0;b<a[mapTiles].oldTilesList.length;b++)a[mapTiles].oldTilesList[b].SetFactor(zoomCounter);for(b=0;b<a[mapTiles].currentTileList.length;b++)a[mapTiles].currentTileList[b].SetFactor(zoomCounter);for(var c=0;c<pushpins.length;c++)pushpins[c].SetFactor(zoomCounter);if(zoomCounter<zoomTotalSteps){zoomCounter++;window.setTimeout(g,1)}else{zoomCounter=0;tileLayerManager.FinalizeView()}}this.ClearTileLayers=function(){for(var c=0;c<b.length;c++){ClearTiles(a[b[c]].currentTileList);a[b[c]]=null;delete a[b[c]];b[c]=null}b.length=0};function f(){if(typeof Msn.VE.API.Globals.vemapinstances=="undefined"||Msn.VE.API.Globals.vemapinstances==null)return null;var b=0;for(var a in Msn.VE.API.Globals.vemapinstances)if(Msn.VE.API.Globals.vemapinstances[a]instanceof VEMap&&Msn.VE.API.Globals.vemapinstances[a].GetMapMode()==VEMapMode.Mode3D)return Msn.VE.API.Globals.vemapinstances[a].vemapcontrol.Get3DControl();return null}this.ClearTileLayer=function(c){if(a[c]!=null&&a[c]!="undefined"){if(typeof Msn.VE.API!="undefined"&&Msn.VE.API!=null){var e=f();if(typeof e!="undefined"&&e!=null)e.RemoveImageSource(c,a[c].ID)}ClearTiles(a[c].currentTileList);a[c]=null;delete a[c]}for(var d=0;d<b.length;d++)if(b[d]==c){b[d]=null;b.splice(d,1)}};this.RefreshTileLayers=function(){if(b!=null)for(var c=0;c<b.length;c++)this.LoadTileLayer(b[c],a[b[c]].ID,a[b[c]].opacity,a[b[c]].zIndex)};this.RefreshTileLayer=function(b){this.LoadTileLayer(layerid,a[b].ID,a[b].opacity,a[b].zIndex)};this.SetTileSource=function(a){var b=new VETileSourceSpecification;b.ID=a.ID;b.SourceName=a.TileSource;b.NumServers=a.NumServers;b.Bounds=a.Bounds;if(a.MinZoom!="undefined"&&a.MinZoom!=null)b.MinZoom=a.MinZoom;if(a.MaxZoom!="undefined"&&a.MaxZoom!=null){b.MaxZoom=a.MaxZoom;if(b.MaxZoom>d)d=b.MaxZoom}if(a.GetTilePath!="undefined"&&a.GetTilePath!=null)b.GetTilePath=a.GetTilePath;tileLayerManager.AddTileSource(b)};this.DeleteTileSource=function(e){if(c[e]!=null&&c[e]!="undefined"){c[e]=null;delete c[e]}if(b!=null)for(var d=0;d<b.length;d++)if(a[b[d]]!=null&&a[b[d]]!="undefined"&&a[b[d]].ID==e){ClearTiles(a[b[d]].currentTileList);a[b[d]]=null;delete a[b[d]];b[d]=null;b.splice(d,1)}};this.CheckTilesAvailability=function(h,n){var k=PixelToLatLong(new Msn.VE.Pixel(0,0)),j=PixelToLatLong(new Msn.VE.Pixel(width,height));if(k==null||j==null)return;var b=k.latitude,d=j.longitude,e=j.latitude,f=k.longitude;if(b<e){var i=b;b=e;e=i}if(d<f){i=d;d=f;f=i}var l=new Msn.VE.LatLongRectangle(new Msn.VE.LatLong(b,f),new Msn.VE.LatLong(e,d)),o=c[h].Bounds.length;for(var g=0;g<o;g++){b=c[h].Bounds[g].TopLeftLatLong.Latitude;d=c[h].Bounds[g].BottomRightLatLong.Longitude;e=c[h].Bounds[g].BottomRightLatLong.Latitude;f=c[h].Bounds[g].TopLeftLatLong.Longitude;if(b<e){i=b;b=e;e=i}if(d<f){i=d;d=f;f=i}var m=new Msn.VE.LatLongRectangle(new Msn.VE.LatLong(b,f),new Msn.VE.LatLong(e,d));if(tileLayerManager.BBOverlap(l,m))return true}a[n].isActive=false;return false};this.BBOverlap=function(a,b){return this.RectInBoundingBox(b,a)};this.RectInBoundingBox=function(a,b){return !(a.southeast.latitude>b.northwest.latitude||a.southeast.longitude<b.northwest.longitude||a.northwest.latitude<b.southeast.latitude||a.northwest.longitude>b.southeast.longitude)};this.ShowTrafficLegend=function(a){h=a;Fire("onapitrafficdisplay")};this.HideTrafficLegend=function(){Fire("onapitraffichide")};this.GetTimeStamp=function(){return h};this.GetMaxTileZoom=function(){return d};this.SetMarketMaxZoom=function(a){marketMaxZoom=a;c[mapTiles].MaxZoom=a}}function VETileSourceSpecification(){this.ID="";this.SourceName="";this.NumServers=0;this.Bounds=null;this.MinZoom=minZoom;this.MaxZoom=1;this.GetTilePath=function(a){try{if(a!=null&&a!="undefined"){var e="",b=0;for(var c=a.ZoomLevel;c>0;c--){b=0;var d=1<<c-1;if((a.XPos&d)!=0)b++;if((a.YPos&d)!=0)b+=2;e+=b+""}c=b%this.NumServers;return this.SourceName.replace(/%1/g,a.MapStyle).replace(/%2/g,c).replace(/%3/g,a.MapStyle).replace(/%4/g,e).replace(/%5/g,a.MapStyle==roadStyle?"png":"jpeg").replace(/%6/g,generations[a.MapStyle])}else return ""}catch(f){}}}function VETileLayerSpecification(){this.ID="";this.ZIndex=0;this.Opacity=1}function VETileContext(){this.XPos=0;this.YPos=0;this.ZoomLevel=0;this.MapStyle=""}this.SetCenter=SetCenter;this.SetMapStyle=SetMapStyle;this.SetScaleBarDistanceUnit=SetScaleBarDistanceUnit;this.GetCenterLatitude=GetCenterLatitude;this.GetCenterLongitude=GetCenterLongitude;this.GetLatitude=GetLatitude;this.GetLongitude=GetLongitude;this.GetY=GetY;this.GetX=GetX;this.LatLongToPixel=LatLongToPixel;this.PixelToLatLong=PixelToLatLong;this.GetZoomLevel=GetZoomLevel;this.GetMapStyle=GetMapStyle;this.GetMapMode=GetMapMode;this.GetAltitude=GetAltitude;this.GetDirection=GetDirection;this.GetTilt=GetTilt;this.GetMetersPerPixel=GetMetersPerPixel;this.Resize=Resize;this.PanMap=PanMap;this.ContinuousPan=ContinuousPan;this.StopContinuousPan=StopContinuousPan;this.StopKeyboardPan=StopKeyboardPan;this.PanToLatLong=PanToLatLong;this.GetPushpins=GetPushpins;this.AddPushpin=AddPushpin;this.RemovePushpin=RemovePushpin;this.ClearPushpins=ClearPushpins;this.SetViewport=SetViewport;this.SetBestMapView=SetBestMapView;this.GetBestMapViewBounds=GetBestMapViewBounds;this.IncludePointInViewport=IncludePointInViewport;this.SetZoom=SetZoom;this.SetTilt=SetTilt;this.SetDirection=SetDirection;this.SetAltitude=SetAltitude;this.ZoomIn=ZoomIn;this.ZoomOut=ZoomOut;this.SetCenterAndZoom=SetCenterAndZoom;this.AddLine=AddLine;this.RemoveLine=RemoveLine;this.ClearLines=ClearLines;this.AttachEvent=AttachEvent;this.DetachEvent=DetachEvent;this.CreateEvent=CreateEvent;this.Fire=Fire;this.IsObliqueAvailable=IsObliqueAvailable;this.GetObliqueScene=GetObliqueScene;this.SetAnimationEnabled=SetAnimationEnabled;this.IsAnimationEnabled=IsAnimationEnabled;this.SetObliqueScene=SetObliqueScene;this.SetObliqueOrientation=SetObliqueOrientation;this.SetView=SetView;this.Debug=Debug;this.GetResponseRangeCounts=GetResponseRangeCounts;this.ResetResponseRangeCounts=ResetResponseRangeCounts;this.GetFailureRate=GetFailureRate;this.SetTrafficView=SetTrafficView;this.GetTrafficAvailability=GetTrafficAvailability;this.GetMarketsFile=GetMarketsFile;this.GetIncidentsFile=GetIncidentsFile;this.GetSlidingExpirationForAutoRefresh=GetSlidingExpirationForAutoRefresh;this.GetAutoRefreshRate=GetAutoRefreshRate;this.SetCopyrightOffset=SetCopyrightOffset;this.SetFocus=SetFocus;this.GetCurrentMode=GetCurrentMode;this.GetMapWidth=GetMapWidth;this.GetMapHeight=GetMapHeight;this.GetCurrentMapView=GetCurrentMapView;this.SetMapTiles=SetMapTiles;this.SetTileSource=tileLayerManager.SetTileSource;this.LoadTileLayer=tileLayerManager.LoadTileLayer;this.ClearTileLayer=tileLayerManager.ClearTileLayer;this.ClearTileLayers=tileLayerManager.ClearTileLayers;this.DeleteTileSource=tileLayerManager.DeleteTileSource;this.RefreshTileLayers=tileLayerManager.RefreshTileLayers;this.ShowTrafficLegend=tileLayerManager.ShowTrafficLegend;this.HideTrafficLegend=tileLayerManager.HideTrafficLegend;this.GetTimeStamp=tileLayerManager.GetTimeStamp;this.GetMaxTileZoom=tileLayerManager.GetMaxTileZoom;this.PanView=tileLayerManager.PanView;this.LoadBaseLayer=tileLayerManager.LoadBaseLayer;this.GetCurrentViewMaxZoomLevel=GetCurrentViewMaxZoomLevel;this.EnableMode=EnableMode;this._Enable3DMode=_Enable3DMode;this._Disable3DMode=_Disable3DMode;this.Get3DVisibleArea=Get3DVisibleArea;this.Get3DControl=Get3DControl;this.IsModeEnabled=IsModeEnabled;this.Sync3dView=Sync3dView;this.OnBeginCameraUpdate=OnBeginCameraUpdate;this.OnEndCameraUpdate=OnEndCameraUpdate;this.IsCameraFlying=IsCameraFlying;this.Show3DTraffic=Show3DTraffic;this.Remove3DTraffic=Remove3DTraffic;this.IterativeCameraRefinement=IterativeCameraRefinement;this.SetChildDiv=SetChildDiv;this.EnableGeoCommunity=EnableGeoCommunity;this.IsGeoCommunityEnabled=IsGeoCommunityEnabled;this.GetOffsetX=GetOffsetX;this.GetOffsetY=GetOffsetY;this.GetCenterOffset=GetCenterOffset;this.SetCenterOffset=SetCenterOffset;this.UpdatePreferredView=UpdatePreferredView;this.GetLastViewChangeType=GetLastViewChangeType;this.SetOn3DAnimationInterruptedCallback=SetOn3DAnimationInterruptedCallback;this.GetOn3DAnimationInterruptedCallback=GetOn3DAnimationInterruptedCallback;this.SetShowMapModeSwitch=SetShowMapModeSwitch};Msn.VE.Bounds=function(e,f,a,c,b,d){this.z1=e;this.z2=f;this.x1=a;this.y1=c;this.x2=b;this.y2=d};Msn.VE.DashboardSize=new function(){this.Normal="normal";this.Small="small";this.Tiny="tiny"};Msn.VE.DashboardStates=new function(){this.MapMode=new function(){this.Flatland=1;this.View3D=2};this.MapView=new function(){this.Ortho=4;this.Oblique=8;this.StreetSide=16};this.MapStyle=new function(){this.Road=32;this.Aerial=64;this.Hybrid=128}};Msn.VE.NavAction=function(e,a,zb,qb){var g=document.createElement("div");g.className="header";g.id="navAction_header";var eb=null,o=null,S=null,I=null,Nb=null,r=null,q=null,x=document.createElement("div");x.className="dashboardContainerDiv";var l=document.createElement("div");l.id="mapViewRow";x.appendChild(l);var K=document.createElement("div");K.id="zoomDiv";var j=document.createElement("div");j.id="navAction_mapViewCell";j.className="dashboardMapModeContainer";var R=document.createElement("div");R.id="navAction_mapViewCellInner";j.appendChild(R);l.appendChild(K);l.appendChild(j);var y=document.createElement("div");y.id="mapStyleRow";x.appendChild(y);var p=document.createElement("div");p.id="navAction_mapStyleCell";var T=document.createElement("div");T.id="compassDiv";var h=null;y.appendChild(T);y.appendChild(p);var D=document.createElement("div"),v=document.createElement("div"),m=document.createElement("div"),C=document.createElement("div"),A=document.createElement("div"),B=document.createElement("div"),c=Msn.VE.DashboardStates.MapMode.Flatland,b=Msn.VE.DashboardStates.MapView.Ortho,d=Msn.VE.DashboardStates.MapStyle.Road,s=document.createElement("div");s.colSpan=3;s.setAttribute("colspan",3);s.id="obliqueSelectorContainer";var f=document.createElement("div");f.id="obliqueNotification";var n=document.createElement("div");n.id="threeDNotification";var U=false,k=document.createElement("div");k.id="lowerContainer";k.appendChild(x);k.appendChild(s);e.className+=" expanded";e.appendChild(g);e.appendChild(k);var E=false;this.Init=function(){var c=a.GetMapStyle();Mb(qb);if(!zb||zb==Msn.VE.DashboardSize.Normal);h=new Jb(T);h.Hide();if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye)){k.appendChild(f);Ab();obliqueSelector=new Ib(s);obliqueSelector.Init();obliqueSelector.Hide()}P(D,"navAction_OrthoMapView","OrthoMapView",F,l622aEt);if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye)&&a.IsObliqueAvailable())P(v,"navAction_ObliqueMapView","ObliqueMapView",z,l161aFt,true);else P(v,"navAction_ObliqueMapView","ObliqueMapView",z,l161aFt,false);P(m,"navAction_StreetSideMapView","StreetSideMapView",L,l617aGt,false);m.style.display="none";r=new Lb(K,100,30);r.Init();q=new Kb(K);q.Init();V(C,"navAction_RoadMapStyle",l954azt,t,$MVEM.IsEnabled(MapControl.Features.MapStyle.Road));V(A,"navAction_AerialMapStyle",l72aAt,M,$MVEM.IsEnabled(MapControl.Features.MapStyle.Aerial));V(B,"navAction_HybridMapStyle",l402aBt,N,$MVEM.IsEnabled(MapControl.Features.MapStyle.Hybrid));this.HideToggleGlyph();a.AttachEvent("oninitmode",db);a.AttachEvent("onendzoom",yb);a.AttachEvent("onchangemapstyle",rb);if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye)){a.AttachEvent("onobliqueenter",vb);a.AttachEvent("onobliqueleave",wb);a.AttachEvent("onobliquechange",sb)}e.className+=" FlatlandMapMode";switch(c){case "r":b=Msn.VE.DashboardStates.MapView.Ortho;u();d=Msn.VE.DashboardStates.MapStyle.Road;ab();break;case "a":b=Msn.VE.DashboardStates.MapView.Ortho;u();d=Msn.VE.DashboardStates.MapStyle.Aerial;X();break;case "h":b=Msn.VE.DashboardStates.MapView.Ortho;u();d=Msn.VE.DashboardStates.MapStyle.Hybrid;Y();break;case "o":b=Msn.VE.DashboardStates.MapView.Oblique;Z();break}};this.Destroy=function(){bb(C,t);bb(A,M);bb(B,N);y.removeChild(p);h.Destroy();y.removeChild(T);x.removeChild(y);C=A=B=p=y=h=null;if(r){r.Destroy();r=null}if(q){q.Destroy();q=null}l.removeChild(K);cb(D,F);cb(v,z);cb(m,L);l.removeChild(j);x.removeChild(l);D=v=m=j=l=null;pb();g.removeChild(o);e.removeChild(g);g=o=eb=null;if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye))obliqueSelector.Destroy();s=obliqueSelector=null;k.removeChild(x);try{k.removeChild(s);k.removeChild(f);k.removeChild(n)}catch(b){}e.removeChild(k);if(a){a.DetachEvent("oninitmode",db);a.DetachEvent("onendzoom",yb);a.DetachEvent("onchangemapstyle",rb);if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye)){a.DetachEvent("onobliqueenter",vb);a.DetachEvent("onobliqueleave",wb);a.DetachEvent("onobliquechange",sb);f.detachEvent("onclick",z);f=null}if($MVEM.IsEnabled(MapControl.Features.MapStyle.View3D)&&qb!=false){n.detachEvent("onclick",O);n=null}a=null}};this.OnView3DModeUpdateUI=lb;this.OnFlatlandModeUpdateUI=hb;this.OnModeUpdateUI=db;function mb(a,f,e,c,d,b){a.innerText=e;a.id=f;a.title=d;if(b==undefined||b==true){a.className="MapMode";a.attachEvent("onclick",c)}else a.className="MapMode_disabled";pseudoHover(a);g.appendChild(a)}function P(a,f,b,d,e,c){a.id=f;a.title=e;if(c==undefined||c==true){a.className=b;a.attachEvent("onclick",d)}else a.className=b+"_disabled";pseudoHover(a);R.appendChild(a)}function V(a,e,d,c,b){a.innerText=d;a.id=e;if(b==undefined||b==true){a.className="MapStyle";a.attachEvent("onclick",c)}else a.className="MapStyle_disabled";pseudoHover(a);p.appendChild(a)}function O(){a.EnableMode(Msn.VE.MapActionMode.Mode3D)}function db(a){if(a==Msn.VE.MapActionMode.Mode3D)lb();else hb()}function lb(){if(c==Msn.VE.DashboardStates.MapMode.View3D)return;c=Msn.VE.DashboardStates.MapMode.View3D;e.className=e.className.replace(/\s*FlatlandMapMode/g,"");e.className+=" View3DMapMode";if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye)){obliqueSelector.Hide();h.Hide()}J();w();m.style.display="block";Bb();W();ob();jb();kb();D.title=l783aHt;v.title=l322aIt;m.title=l788aJt;mvcViewFacade.UpdateShimIfSupported($ID(e.id))}function gb(){a.EnableMode(Msn.VE.MapActionMode.Mode2D)}function hb(){c=Msn.VE.DashboardStates.MapMode.Flatland;e.className=e.className.replace(/\s*View3DMapMode/g,"");e.className=e.className.replace(/\s*FlatlandMapMode/g,"");e.className+=" FlatlandMapMode";m.style.display="none";D.title=l622aEt;v.title=l161aFt;m.title=l788aJt;if(a.IsObliqueAvailable()&&$MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye))W();else ib();if($MVEM.IsEnabled(MapControl.Features.MapStyle.Road))ob();else Gb();if($MVEM.IsEnabled(MapControl.Features.MapStyle.Aerial))jb();else Db();if($MVEM.IsEnabled(MapControl.Features.MapStyle.Hybrid))kb();else Eb();switch(b){case Msn.VE.DashboardStates.MapView.Oblique:if(a.IsObliqueAvailable()&&$MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye))i(c+b);else F();break;case Msn.VE.DashboardStates.MapView.StreetSide:F();break;case Msn.VE.DashboardStates.MapView.Ortho:switch(d){case Msn.VE.DashboardStates.MapStyle.Aerial:if($MVEM.IsEnabled(MapControl.Features.MapStyle.Aerial))i(c+b+d);else t();break;case Msn.VE.DashboardStates.MapStyle.Hybrid:if($MVEM.IsEnabled(MapControl.Features.MapStyle.Hybrid))i(c+b+d);else t();break;default:i(c+b+d);break}J();if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye)){obliqueSelector.Hide();h.Hide()}break;default:F();break}}function F(){if(b==Msn.VE.DashboardStates.MapView.Ortho&&c==Msn.VE.DashboardStates.MapMode.Flatland)return;b=Msn.VE.DashboardStates.MapView.Ortho;if(c==Msn.VE.DashboardStates.MapMode.Flatland)switch(d){case Msn.VE.DashboardStates.MapStyle.Aerial:if($MVEM.IsEnabled(MapControl.Features.MapStyle.Aerial))i(c+b+d);else t();break;case Msn.VE.DashboardStates.MapStyle.Hybrid:if($MVEM.IsEnabled(MapControl.Features.MapStyle.Hybrid))i(c+b+d);else t();break;default:i(c+b+d);break}else i(c+b);u()}function L(){if(b==Msn.VE.DashboardStates.MapView.StreetSide&&c==Msn.VE.DashboardStates.MapMode.Flatland)return;b=Msn.VE.DashboardStates.MapView.StreetSide;i(c+b);Cb()}function z(){if(b==Msn.VE.DashboardStates.MapView.Oblique&&c==Msn.VE.DashboardStates.MapMode.Flatland)return;b=Msn.VE.DashboardStates.MapView.Oblique;i(c+b);Z()}function t(){if(d==Msn.VE.DashboardStates.MapStyle.Road)return;d=Msn.VE.DashboardStates.MapStyle.Road;i(c+b+d);if(c==Msn.VE.DashboardStates.MapMode.View3D)ab()}function M(){if(d==Msn.VE.DashboardStates.MapStyle.Aerial)return;d=Msn.VE.DashboardStates.MapStyle.Aerial;i(c+b+d);if(c==Msn.VE.DashboardStates.MapMode.View3D)X()}function N(){if(d==Msn.VE.DashboardStates.MapStyle.Hybrid)return;d=Msn.VE.DashboardStates.MapStyle.Hybrid;i(c+b+d);if(c==Msn.VE.DashboardStates.MapMode.View3D)Y()}function i(b){var c=false;if(b&Msn.VE.DashboardStates.MapStyle.Road){a.SetMapStyle("r");c=true}else if(b&Msn.VE.DashboardStates.MapStyle.Aerial){a.SetMapStyle("a");c=true}else if(b&Msn.VE.DashboardStates.MapStyle.Hybrid){a.SetMapStyle("h");c=true}if(b&Msn.VE.DashboardStates.MapMode.Flatland){if(b&Msn.VE.DashboardStates.MapView.Oblique)a.SetMapStyle("o")}else if(b&Msn.VE.DashboardStates.MapMode.View3D&&!c)if(b&Msn.VE.DashboardStates.MapView.Ortho)a.SetTilt(-90);else if(b&Msn.VE.DashboardStates.MapView.Oblique)a.SetTilt(-45);else if(b&Msn.VE.DashboardStates.MapView.StreetSide)a.SetTilt(-25)}function u(){j.className="OrthoView";l.className="OrthoView";if(c==Msn.VE.DashboardStates.MapMode.Flatland)J();else w()}function Z(){j.className="ObliqueView";l.className="ObliqueView";f.style.display="none";if(c==Msn.VE.DashboardStates.MapMode.Flatland){xb();tb();obliqueSelector.Show();h.Show();s.style.top=x.offsetHeight-s.offsetHeight}else{J();w();obliqueSelector.Hide();h.Hide()}}function Cb(){j.className="StreetSideView";l.className="StreetSideView";if(c==Msn.VE.DashboardStates.MapMode.Flatland){xb();tb()}else{J();w()}}function ab(){p.className="RoadMapStyle";w()}function X(){p.className="AerialMapStyle";w()}function Y(){p.className="HybridMapStyle";w()}function w(){q.Hide();r.Show()}function tb(){r.Hide();q.Show()}function xb(){C.style.display="none";A.style.display="none";B.style.display="none"}function J(){C.style.display="block";A.style.display="block";B.style.display="block"}function Ab(){f.innerHTML+='<div id="obliqueNotifyIcon">&nbsp;</div> <div id="obliqueNotifyText">'+l149amt+"</div>";f.attachEvent("onclick",z);f.style.display="none"}function Fb(){if(!a.IsModeEnabled(Msn.VE.MapActionMode.Mode3D)&&a.GetMapStyle()!="o"){k.appendChild(n);n.style.top=-(g.offsetHeight/2+6)+"px";n.innerHTML+='<div id="threeDNotifyIcon">&nbsp;</div> <div id="threeDNotifyText">'+l819ant+"</div>";n.attachEvent("onclick",O);window.setTimeout(Hb,6000);U=true}else n.style.display="none"}function Hb(){n.style.display="none";U=false;if(!a.IsModeEnabled(Msn.VE.MapActionMode.Mode3D))if(a.IsObliqueAvailable()&&$MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye))fb()}function Mb(a){nb(a);if($MVEM.IsEnabled(MapControl.Features.MapStyle.View3D)&&a!=false)Fb(I);eb=new Microsoft.Web.UI.IEGlyph(null,"toggleGlyph");o=eb.getElement();g.appendChild(o)}function nb(a){if($MVEM.IsEnabled(MapControl.Features.MapStyle.View3D)&&a!=false){S=document.createElement("div");I=document.createElement("div");mb(S,"navAction_FlatlandMapMode",l279axt,gb,l345aCt);mb(I,"navAction_View3DMapMode",l712ayt,O,l502aDt);g.className="header with3D";E=true}else{g.className="header no3D";E=false}}function pb(){if(E){ub(S,gb);ub(I,O);S=I=null;E=false}else Nb=null}function ub(a,c,b){if(a==null)return;if(b==undefined||b==true)a.detachEvent("onclick",c);if(g!=null)try{g.removeChild(a)}catch(d){}}function cb(a,b){a.detachEvent("onclick",b);if(j!=null)try{j.removeChild(a)}catch(c){}}function bb(a,b){a.detachEvent("onclick",b);if(p!=null)try{p.removeChild(a)}catch(c){}}function W(){H(v,z,"ObliqueMapView")}function ib(){G(v,z,"ObliqueMapView_disabled")}function Bb(){H(m,L,"StreetSideMapView")}function ob(){H(C,t,"MapStyle")}function Gb(){G(C,t,"MapStyle_disabled")}function jb(){H(A,M,"MapStyle")}function Db(){G(A,M,"MapStyle_disabled")}function kb(){H(B,N,"MapStyle")}function Eb(){G(B,N,"MapStyle_disabled")}function yb(){r.UpdateFromMap();q.UpdateFromMap()}function vb(){if(a.GetMapStyle()=="o")b=Msn.VE.DashboardStates.MapView.Oblique;W();fb()}function fb(){if(!U)if(b!=Msn.VE.DashboardStates.MapView.Oblique){f.style.top=(j.offsetHeight-R.offsetHeight)/2+D.offsetHeight+6+"px";f.style.marginLeft="4px";f.style.display="block";window.setTimeout(function(){f.style.display="none"},6000)}}function wb(){obliqueSelector.Hide();h.Hide();w();b=Msn.VE.DashboardStates.MapView.Ortho;u();ib();f.style.display="none"}function rb(e){switch(e.view.mapStyle){case "r":if(c==Msn.VE.DashboardStates.MapMode.Flatland&&a.IsModeEnabled(Msn.VE.MapActionMode.Mode2D)&&b!=Msn.VE.DashboardStates.MapView.Ortho){b=Msn.VE.DashboardStates.MapView.Ortho;u()}d=Msn.VE.DashboardStates.MapStyle.Road;ab();if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye))obliqueSelector.Hide();h.Hide();break;case "a":if(c==Msn.VE.DashboardStates.MapMode.Flatland&&a.IsModeEnabled(Msn.VE.MapActionMode.Mode2D)&&b!=Msn.VE.DashboardStates.MapView.Ortho){b=Msn.VE.DashboardStates.MapView.Ortho;u()}d=Msn.VE.DashboardStates.MapStyle.Aerial;X();if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye))obliqueSelector.Hide();h.Hide();break;case "h":if(c==Msn.VE.DashboardStates.MapMode.Flatland&&a.IsModeEnabled(Msn.VE.MapActionMode.Mode2D)&&b!=Msn.VE.DashboardStates.MapView.Ortho){b=Msn.VE.DashboardStates.MapView.Ortho;u()}d=Msn.VE.DashboardStates.MapStyle.Hybrid;Y();if($MVEM.IsEnabled(MapControl.Features.MapStyle.BirdsEye))obliqueSelector.Hide();h.Hide();break;case "o":b=Msn.VE.DashboardStates.MapView.Oblique;Z();break}}function sb(){f.style.display="none";obliqueSelector.Update();h.UpdateFromMap()}function G(a,b,c){a.className=c;a.detachEvent("onclick",b)}function H(a,b,c){a.className=c;a.attachEvent("onclick",b)}this.SetX=function(a){e.style.left=a+"px"};this.GetElement=function(){return e};this.GetHeader=function(){return g};this.GetY=function(){return GetTopPosition(e)};this.GetHeight=function(){return e.offsetHeight};this.ShowToggleGlyph=function(){if(o!=null&&o!="undefined")o.style.display="block"};this.HideToggleGlyph=function(){if(o!=null&&o!="undefined")o.style.display="none"};this.SetShowMapModeSwitch=function(a){if(a!=E){if(!a)pb();nb(a)}};function Lb(j){var c=document.createElement("div"),f=document.createElement("div"),d=document.createElement("div"),b=document.createElement("div"),e=document.createElement("div"),x=0,u=0,i=false;this.Init=function(){e.className="ZoomBar_minus";e.id="navAction_orthoZoomBar_minus";e.title=l580aKt;e.unselectable="on";e.attachEvent("onclick",l);pseudoHover(e);b.className="ZoomBar_slider";b.id="navAction_orthoZoomBar_slider";b.unselectable="on";b.attachEvent("onmousedown",o);b.attachEvent("onmousemove",p);b.attachEvent("onmouseup",s);b.attachEvent("onclick",IgnoreEvent);pseudoHover(b);d.className="OrthoZoomBar_bar";d.unselectable="on";d.appendChild(b);d.attachEvent("onclick",t);f.className="ZoomBar_plus";f.id="navAction_orthoZoomBar_plus";f.title=l378aLt;f.unselectable="on";f.attachEvent("onclick",m);pseudoHover(f);c.className="OrthoZoomBar";c.appendChild(e);c.appendChild(d);c.appendChild(f);c.attachEvent("onmousedown",IgnoreEvent);c.attachEvent("onmouseup",IgnoreEvent);c.attachEvent("onclick",IgnoreEvent);c.attachEvent("ondblclick",IgnoreEvent);j.appendChild(c);h()};this.Destroy=function(){e.detachEvent("onclick",l);b.detachEvent("onmousedown",o);b.detachEvent("onmousemove",p);b.detachEvent("onmouseup",s);b.detachEvent("onclick",IgnoreEvent);d.removeChild(b);d.detachEvent("onclick",t);f.detachEvent("onclick",m);c.removeChild(f);c.removeChild(d);c.removeChild(e);c.detachEvent("onmousedown",IgnoreEvent);c.detachEvent("onmousedown",IgnoreEvent);c.detachEvent("onclick",IgnoreEvent);c.detachEvent("ondblclick",IgnoreEvent);j.removeChild(c);a.DetachEvent("onendzoom",h);e=b=d=f=c=j=a=null};function w(){c.style.display="block"}function v(){c.style.display="none"}function k(){x=GetLeftPosition(c);u=GetTopPosition(c)}function o(a){a=GetEvent(a);CancelEvent(a);k();if(b.setCapture)b.setCapture();i=true;return false}function p(a){a=GetEvent(a);CancelEvent(a);if(i)b.style.top=g(GetMouseY(a))+"px";return false}function s(a){a=GetEvent(a);CancelEvent(a);if(b.releaseCapture)b.releaseCapture();i=false;n(g(GetMouseY(a)));r.UpdateFromMap();q.UpdateFromMap();return false}function m(){a.ZoomIn()}function l(){a.ZoomOut()}function t(a){a=GetEvent(a);CancelEvent(a);k();n(g(GetMouseY(a)));return false}function g(a){a-=u+e.offsetHeight+b.offsetHeight;var c=d.offsetHeight-b.offsetHeight;if(a<0)a=0;else if(a>c)a=c;return a}function n(f){var c=d.offsetHeight-b.offsetHeight,e=1+MathRound((c-f)/c*18);a.SetZoom(e)}function h(){var c=d.offsetHeight-b.offsetHeight,e=c-(a.GetZoomLevel()-1)/18*c;b.style.top=e+"px"}this.UpdateFromMap=h;this.Show=w;this.Hide=v}function Kb(i){var c=document.createElement("div"),f=document.createElement("div"),d=document.createElement("div"),b=document.createElement("div"),e=document.createElement("div"),y=0,t=0,h=false;this.Init=function(){e.className="ZoomBar_minus";e.id="navAction_obliqueZoomBar_minus";e.unselectable="on";e.title=l580aKt;e.attachEvent("onclick",k);pseudoHover(e);b.className="ZoomBar_slider";b.id="navAction_obliqueZoomBar_slider";b.unselectable="on";b.attachEvent("onmousedown",n);b.attachEvent("onmousemove",o);b.attachEvent("onmouseup",p);b.attachEvent("onclick",IgnoreEvent);pseudoHover(b);d.className="ObliqueZoomBar_bar";d.unselectable="on";d.appendChild(b);d.attachEvent("onclick",s);f.className="ZoomBar_plus";f.id="navAction_obliqueZoomBar_plus";f.title=l378aLt;f.unselectable="on";f.attachEvent("onclick",l);pseudoHover(f);c.className="ObliqueZoomBar";c.appendChild(e);c.appendChild(d);c.appendChild(f);c.attachEvent("onmousedown",IgnoreEvent);c.attachEvent("onmouseup",IgnoreEvent);c.attachEvent("onclick",IgnoreEvent);c.attachEvent("ondblclick",IgnoreEvent);i.appendChild(c)};function x(){c.style.display="block"}function w(){c.style.display="none"}function s(a){a=GetEvent(a);CancelEvent(a);j();m(g(GetMouseY(a)));return false}function g(a){a-=t+e.offsetHeight+b.offsetHeight;var c=d.offsetHeight-b.offsetHeight;if(a<0)a=0;else if(a>c)a=c;return a}function k(){a.ZoomOut()}function l(){a.ZoomIn()}function v(){e.detachEvent("onclick",k);b.detachEvent("onmousedown",n);b.detachEvent("onmousemove",o);b.detachEvent("onmouseup",p);b.detachEvent("onclick",IgnoreEvent);d.removeChild(b);d.detachEvent("onclick",s);f.detachEvent("onclick",l);c.removeChild(f);c.removeChild(d);c.removeChild(e);c.detachEvent("onmousedown",IgnoreEvent);c.detachEvent("onmousedown",IgnoreEvent);c.detachEvent("onclick",IgnoreEvent);c.detachEvent("ondblclick",IgnoreEvent);i.removeChild(c);e=b=d=f=c=i=a=null}function n(a){a=GetEvent(a);CancelEvent(a);j();if(b.setCapture)b.setCapture();h=true;return false}function o(a){a=GetEvent(a);CancelEvent(a);if(h)b.style.top=g(GetMouseY(a))+"px";return false}function p(a){a=GetEvent(a);CancelEvent(a);if(b.releaseCapture)b.releaseCapture();h=false;m(g(GetMouseY(a)));r.UpdateFromMap();q.UpdateFromMap();return false}function j(){y=GetLeftPosition(c);t=GetTopPosition(c)}function m(f){var c=d.offsetHeight-b.offsetHeight,e=1+MathRound((c-f)/c*1);a.SetZoom(e)}function u(){if(a.GetZoomLevel()==1)b.style.top=d.offsetHeight-b.offsetHeight+"px";else b.style.top="0px"}this.Destroy=v;this.Show=x;this.Hide=w;this.UpdateFromMap=u}function Ib(d){var c=document.createElement("table"),b=new Array(3);this.Init=function(){c.className="obliqueSelectorTable";g();d.appendChild(c);var j=document.createElement("tbody");c.appendChild(j);for(var a=0;a<3;a++){var k=document.createElement("tr");j.appendChild(k);b[a]=new Array(3);for(var f=0;f<3;f++){var i=document.createElement("div"),h=document.createElement("td");k.appendChild(h);h.appendChild(i);i.className="Dashboard_thumbnail";if(a==1&&f==1){b[a][f]=new e(i,false);h.className="obliqueSelectorCellCenter"}else{b[a][f]=new e(i,true);h.className="obliqueSelectorCellOff"}b[a][f].Init()}}};this.Destroy=function(){d.removeChild(c);c=null;for(var a=0;a<b.length;a++)for(var e=0;e<b[a].length;e++){b[a][e].Destroy();b[a][e]=null}b=null};function h(){f();d.style.display="block"}function g(){d.style.display="none"}function f(){var c=a.GetObliqueScene();if(!c)return;b[1][1].SetScene(c);switch(c.GetOrientation()){case "North":b[0][0].SetScene(c.GetNeighbor("Northwest"));b[0][1].SetScene(c.GetNeighbor("North"));b[0][2].SetScene(c.GetNeighbor("Northeast"));b[1][0].SetScene(c.GetNeighbor("West"));b[1][2].SetScene(c.GetNeighbor("East"));b[2][0].SetScene(c.GetNeighbor("Southwest"));b[2][1].SetScene(c.GetNeighbor("South"));b[2][2].SetScene(c.GetNeighbor("Southeast"));break;case "East":b[0][0].SetScene(c.GetNeighbor("Northeast"));b[0][1].SetScene(c.GetNeighbor("East"));b[0][2].SetScene(c.GetNeighbor("Southeast"));b[1][0].SetScene(c.GetNeighbor("North"));b[1][2].SetScene(c.GetNeighbor("South"));b[2][0].SetScene(c.GetNeighbor("Northwest"));b[2][1].SetScene(c.GetNeighbor("West"));b[2][2].SetScene(c.GetNeighbor("Southwest"));break;case "West":b[0][0].SetScene(c.GetNeighbor("Southwest"));b[0][1].SetScene(c.GetNeighbor("West"));b[0][2].SetScene(c.GetNeighbor("Northwest"));b[1][0].SetScene(c.GetNeighbor("South"));b[1][2].SetScene(c.GetNeighbor("North"));b[2][0].SetScene(c.GetNeighbor("Southeast"));b[2][1].SetScene(c.GetNeighbor("East"));b[2][2].SetScene(c.GetNeighbor("Northeast"));break;case "South":b[0][0].SetScene(c.GetNeighbor("Southeast"));b[0][1].SetScene(c.GetNeighbor("South"));b[0][2].SetScene(c.GetNeighbor("Southwest"));b[1][0].SetScene(c.GetNeighbor("East"));b[1][2].SetScene(c.GetNeighbor("West"));b[2][0].SetScene(c.GetNeighbor("Northeast"));b[2][1].SetScene(c.GetNeighbor("North"));b[2][2].SetScene(c.GetNeighbor("Northwest"));break}}function e(b,d){var c=null;this.Init=function(){b.title=l421art;if(d){b.attachEvent("onclick",g);b.attachEvent("onmouseover",e);b.attachEvent("onmouseout",f)}};this.Destroy=function(){if(d){b.detachEvent("onclick",g);b.detachEvent("onmouseover",e);b.detachEvent("onmouseout",f)}};this.SetScene=function(a){c=a;if(c){b.innerHTML='<img src="'+c.GetThumbnailFilename()+"\" width=50 height=50 border=0 display='block'>";if(d)b.style.cursor="pointer"}else{b.innerHTML="";b.style.cursor="default"}if(d)b.parentNode.className="obliqueSelectorCellOff"};function g(){if(!c)return;a.SetObliqueScene(c.GetID())}function e(){b.parentNode.className="obliqueSelectorCellOn"}function f(){b.parentNode.className="obliqueSelectorCellOff"}}this.Update=f;this.Show=h;this.Hide=g}function Q(w,u,v){var a=document.createElement("div");a.setAttribute("id",w);a.innerHTML=u;var c="obliqueCompassPointOff",f=v;a.attachEvent("onmouseover",e);a.attachEvent("onmouseout",g);a.attachEvent("onclick",h);this.onclick=null;this.onmouseover=null;this.onmouseout=null;var b=this,d=false,i=new s(a,17,17);function e(e){if(d)return;c=a.className;a.className="obliqueCompassPointHover";if(b.onmouseover)b.onmouseover(e)}function h(a){if(d)return;e(a);c="obliqueCompassPointOn";if(b.onclick)b.onclick(a)}function g(e){if(d)return;a.className=c;if(b.onmouseout)b.onmouseout(e)}function l(){c="obliqueCompassPointOn";a.className="obliqueCompassPointOn"}function k(){c="obliqueCompassPointOff";a.className="obliqueCompassPointOff"}function r(){d=true;k()}function j(){d=false;l()}function p(){return a}function m(){return f}function n(a){f=a}function t(){i.Reset();j()}function o(b){a.style.left=b.left;a.style.top=b.top}function s(s,o,p){var g=s,a=0,b=0.3,d=0,m=40,h=25,c=false,l=Math.PI/2,i=true,q=b+0.1;function n(a,b,c){if(b>=c-a&&b<=c+a)return true;return false}function j(){a+=b;if(a>Math.PI*2)a-=Math.PI*2;else if(a<0)a+=Math.PI*2;if(n(q,a,d)){b=0.3;a=d;e(a);c=false;return}e(a);window.setTimeout(j,m)}function e(a){var b=o+h*Math.sin(a),c=p+h*Math.cos(a);g.style.left=b+"px";g.style.top=c+"px"}function f(a){if(c)return;c=true;d=a;j()}function k(a,c){i=c;if(!i)b*=-1;f(l*a)}function r(){c=false;a=0}this.RotateTo=f;this.RotateToIndex=k;this.Reset=r}function q(){a.parentNode.removeChild(a);a.detachEvent("onmouseover",e);a.detachEvent("onmouseout",g);a.detachEvent("onclick",h);a=null}this.GetElement=p;this.GetCurrentPositionIndex=m;this.SetCurrentPositionIndex=n;this.SetCurrentPosition=o;this.On=l;this.Off=k;this.RotateToIndex=i.RotateToIndex;this.Reset=t;this.Disable=r;this.Enable=j;this.Destroy=q}function Jb(C){var o=[];o.push({"top":"-8px","left":"17px"});o.push({"top":"17px","left":"42px"});o.push({"top":"42px","left":"17px"});o.push({"top":"17px","left":"-8px"});var b=document.createElement("div");b.setAttribute("id","obliqueCompassContainer");b.title=l785aqt;var c=new Q("obliqueCompassPointN","N",0),j=c.GetElement();j.attachEvent("onclick",r);j.attachEvent("onmouseover",u);j.attachEvent("onmouseout",h);var e=new Q("obliqueCompassPointE","E",1),l=e.GetElement();l.attachEvent("onclick",t);l.attachEvent("onmouseover",x);l.attachEvent("onmouseout",h);var d=new Q("obliqueCompassPointS","S",2),k=d.GetElement();k.attachEvent("onclick",s);k.attachEvent("onmouseover",v);k.attachEvent("onmouseout",h);var f=new Q("obliqueCompassPointW","W",3),m=f.GetElement();m.attachEvent("onclick",w);m.attachEvent("onmouseover",y);m.attachEvent("onmouseout",h);var n=document.createElement("div");b.appendChild(j);b.appendChild(l);b.appendChild(k);b.appendChild(m);b.appendChild(n);C.appendChild(b);q();function p(a){if(a<0)a=4-Math.abs(a);return a}function i(g){var b=g.GetCurrentPositionIndex();e.SetCurrentPositionIndex(p(e.GetCurrentPositionIndex()-b));f.SetCurrentPositionIndex(p(f.GetCurrentPositionIndex()-b));c.SetCurrentPositionIndex(p(c.GetCurrentPositionIndex()-b));d.SetCurrentPositionIndex(p(d.GetCurrentPositionIndex()-b));var a=true;if(b==3)a=false;c.RotateToIndex(2-c.GetCurrentPositionIndex()<0?c.GetCurrentPositionIndex():2-c.GetCurrentPositionIndex(),a);e.RotateToIndex(2-e.GetCurrentPositionIndex()<0?e.GetCurrentPositionIndex():2-e.GetCurrentPositionIndex(),a);d.RotateToIndex(2-d.GetCurrentPositionIndex()<0?d.GetCurrentPositionIndex():2-d.GetCurrentPositionIndex(),a);f.RotateToIndex(2-f.GetCurrentPositionIndex()<0?f.GetCurrentPositionIndex():2-f.GetCurrentPositionIndex(),a)}function g(a){switch(a){case 0:h();break;case 1:z();break;case 2:A();break;case 3:B();break}}function h(){n.className="obliqueCompassArrowU"}function A(){n.className="obliqueCompassArrowD"}function z(){n.className="obliqueCompassArrowR"}function B(){n.className="obliqueCompassArrowL"}function s(){i(d);g(0);var b=a.GetObliqueScene();if(b){var c=b.GetRotation("South");if(c)a.SetObliqueOrientation("South")}}function r(){i(c);g(0);var b=a.GetObliqueScene();if(b){var d=b.GetRotation("North");if(d)a.SetObliqueOrientation("North")}}function t(){i(e);g(0);var b=a.GetObliqueScene();if(b){var c=b.GetRotation("East");if(c)a.SetObliqueOrientation("East")}}function w(){i(f);g(0);var b=a.GetObliqueScene();if(b){var c=b.GetRotation("West");if(c)a.SetObliqueOrientation("West")}}function v(){g(d.GetCurrentPositionIndex())}function x(){g(e.GetCurrentPositionIndex())}function y(){g(f.GetCurrentPositionIndex())}function u(){g(c.GetCurrentPositionIndex())}function E(){b.style.display="none"}function F(){b.style.display="block"}function q(){var b=a.GetObliqueScene();if(!b)return;switch(b.GetOrientation()){case "North":i(c);break;case "South":i(d);break;case "East":i(e);break;case "West":i(f);break}g(0);if(b.GetRotation("North"))c.Enable();else c.Disable();if(b.GetRotation("South"))d.Enable();else d.Disable();if(b.GetRotation("East"))e.Enable();else e.Disable();if(b.GetRotation("West"))f.Enable();else f.Disable()}function D(){c.Destroy();e.Destroy();d.Destroy();f.Destroy();j.detachEvent("onclick",r);j.detachEvent("onmouseover",u);j.detachEvent("onmouseout",h);l.detachEvent("onclick",t);l.detachEvent("onmouseover",x);l.detachEvent("onmouseout",h);k.detachEvent("onclick",s);k.detachEvent("onmouseover",v);k.detachEvent("onmouseout",h);m.detachEvent("onclick",w);m.detachEvent("onmouseover",y);m.detachEvent("onmouseout",h);b.parentNode.removeChild(b);b=null}this.Hide=E;this.Show=F;this.UpdateFromMap=q;this.Destroy=D}};Msn.VE.LatLong=function(b,a){this.latitude=b;this.longitude=a;this.ToString=function(){return "("+this.latitude+", "+this.longitude+")"};this.Copy=function(a){if(!a)return;this.latitude=a.latitude;this.longitude=a.longitude};this.Equals=function(a){if(a instanceof Msn.VE.LatLong)return this.latitude==a.latitude&&this.longitude==a.longitude;else return false}};Msn.VE.LatLongRectangle=function(a,b){this.northwest=a;this.southeast=b;this.ToString=function(){return "("+(this.northwest?this.northwest.ToString():"null")+", "+(this.southeast?this.southeast.ToString():"null")+")"};this.Copy=function(a){if(!a)return;if(!this.northwest)this.northwest=new Msn.VE.LatLong;if(!this.southeast)this.southeast=new Msn.VE.LatLong;this.northwest.Copy(a.northwest);this.southeast.Copy(a.southeast)};this.Center=function(){var b=Math.sin(this.northwest.latitude*Math.PI/180),c=Math.sin(this.southeast.latitude*Math.PI/180),d=0.25*(Math.log((1+b)/(1-b))+Math.log((1+c)/(1-c))),a=new Msn.VE.LatLong;a.latitude=Math.atan(Math.exp(d))*360/Math.PI-90;a.longitude=0.5*(parseFloat(this.northwest.longitude)+parseFloat(this.southeast.longitude));return a};this.Contains=function(c){return c.latitude<=a.latitude&&c.longitude>=a.longitude&&c.latitude>=b.latitude&&c.longitude<=b.longitude}};Msn.VE.MapStyle=new function(){this.Road="r";this.Aerial="a";this.Hybrid="h";this.Oblique="o"};Msn.VE.MapView=function(map){this.zoomLevel=0;this.mapStyle=null;this.tilt=-90;this.direction=0;this.altitude=-1000;this.center=new Msn.VE.Pixel;this.latlong=new Msn.VE.LatLong;this.cameraLatlong=null;this.pixelRect=new Msn.VE.PixelRectangle;this.latlongRect=new Msn.VE.LatLongRectangle;this.sceneId=null;this.sceneOrientation=null;this._supressFlyToCall=false;this._needsPivotOperation=true;var mapInstance=map,p_this=this,viewType="pixel";this.Destroy=function(){this.center=this.latlong=p_this=mapInstance=null};this.GetViewType=function(){return viewType};this.GetMap=function(){return mapInstance};this.SetMap=function(a){mapInstance=a};function MakeCopy(){var a=new Msn.VE.MapView;a.Copy(p_this);return a}function Copy(a){p_this.zoomLevel=a.zoomLevel;p_this.mapStyle=a.mapStyle;p_this.tilt=a.tilt;p_this.direction=a.direction;p_this.altitude=a.altitude;p_this.center.Copy(a.center);if(a.cameraLatlong!=null){p_this.cameraLatlong=new Msn.VE.LatLong;p_this.cameraLatlong.Copy(a.cameraLatlong)}p_this.latlong.Copy(a.latlong);p_this.pixelRect.Copy(a.pixelRect);p_this.latlongRect.Copy(a.latlongRect);p_this.sceneId=a.sceneId;p_this.sceneOrientation=a.sceneOrientation;p_this.SetMap(a.GetMap());viewType=a.GetViewType()}function Equals(a){return a!=null&&p_this.zoomLevel==a.zoomLevel&&p_this.mapStyle==a.mapStyle&&MathAbs(p_this.tilt-a.tilt)<1E-06&&MathAbs(p_this.direction-a.direction)<1E-06&&MathAbs(p_this.altitude-a.altitude)<1E-06&&MathAbs(p_this.center.x-a.center.x)<1E-06&&MathAbs(p_this.center.y-a.center.y)<1E-06&&p_this.sceneId==a.sceneId&&p_this.GetMap()==a.GetMap()&&p_this.sceneOrientation==a.sceneOrientation}function ToString(){return "("+p_this.latlong.ToString()+", "+p_this.zoomLevel+", "+p_this.mapStyle+")"}function SetCenter(a){if(!a)return;p_this.center=a;viewType="pixel"}function SetCenterLatLong(a){if(!a)return;p_this.latlong=a;p_this.cameraLatlong=null;viewType="latlong"}function SetPixelRectangle(a){p_this.pixelRect=a;p_this.cameraLatlong=null;p_this.tilt=-90;p_this.direction=0;viewType="pixelRect"}function SetLatLongRectangle(a){p_this.latlongRect=a;p_this.cameraLatlong=null;p_this.tilt=-90;p_this.direction=0;viewType="latlongRect"}function SetZoomLevel(a){if(a<=0)a=1;var c=mapInstance.GetCenterOffset().x,d=mapInstance.GetCenterOffset().y;switch(viewType){case "pixel":var b=Math.pow(2,a-p_this.zoomLevel);p_this.center.x=(p_this.center.x+c)*b-c;p_this.center.y=(p_this.center.y+d)*b-d;break;case "pixelRect":b=Math.pow(2,a-p_this.zoomLevel);p_this.pixelRect.topLeft.x=p_this.pixelRect.topLeft.x*b;p_this.pixelRect.topLeft.y=p_this.pixelRect.topLeft.y*b;p_this.pixelRect.bottomRight.x=p_this.pixelRect.bottomRight.x*b;p_this.pixelRect.bottomRight.y=p_this.pixelRect.bottomRight.y*b;break}if(p_this.zoomLevel!=a){p_this.altitude=-1000;if(p_this.zoomLevel!=0)p_this.cameraLatlong=null}p_this.zoomLevel=a}function SetMapStyle(a,c,b){p_this.mapStyle=a;if(viewType=="pixel")viewType="latlong";if(a!="o"){p_this.sceneId=null;p_this.sceneOrientation=null}else{p_this.sceneId=c;p_this.sceneOrientation=b}}function SetTilt(a){if(a>=269.99999)a=a-360;if(a<-90)a=-90;if(a>90)a=90;p_this.tilt=a;p_this._needsPivotOperation=true}function SetDirection(a){if(a<0||a>=360)a=0;p_this.direction=a;p_this._needsPivotOperation=true}function SetAltitude(a){if(a<-1000||a>15000000)a=-1000;p_this.altitude=a}function GetTilt(){return p_this.tilt}function GetDirection(){return p_this.direction}function GetAltitude(){return p_this.altitude}function GetX(a){if(a)return p_this.center.x*Math.pow(2,a-p_this.zoomLevel);return p_this.center.x}function GetY(a){if(a)return p_this.center.y*Math.pow(2,a-p_this.zoomLevel);return p_this.center.y}function GetCenter(a){if(a==undefined){var b=p_this.center.x+mapInstance.GetCenterOffset().x,c=p_this.center.y+mapInstance.GetCenterOffset().y;return new Msn.VE.Pixel(b,c)}b=(p_this.center.x+mapInstance.GetCenterOffset().x)*Math.pow(2,a-p_this.zoomLevel);c=(p_this.center.y+mapInstance.GetCenterOffset().y)*Math.pow(2,a-p_this.zoomLevel);return new Msn.VE.Pixel(b,c)}function GetZoomLevel(){return p_this.zoomLevel}function GetLatLongRectangle(){return p_this.latlongRect}function GetPixelRectangle(){return p_this.pixelRect}function GetCenterLatLong(){var b=p_this.center.x+mapInstance.GetCenterOffset().x,c=p_this.center.y+mapInstance.GetCenterOffset().y,a=mapInstance.GetCurrentMode().PixelToLatLong(new Msn.VE.Pixel(b,c),p_this.zoomLevel);return a==null?p_this.latlong:a}function Resolve(a,c,b){switch(viewType){case "pixel":p_this.latlong=a.PixelToLatLong(p_this.center,p_this.zoomLevel);break;case "latlong":p_this.center=a.LatLongToPixel(p_this.latlong,p_this.zoomLevel);if(p_this.center!=null){p_this.center.x-=mapInstance.GetCenterOffset().x;p_this.center.y-=mapInstance.GetCenterOffset().y}break;case "pixelRect":ResolveRectangle(a,c,b);break;case "latlongRect":if(p_this.mapStyle=="o"){p_this.zoomLevel=1;var d=a.GetScene();if(!d.ContainsLatLong(p_this.latlongRect.northwest)||!d.ContainsLatLong(p_this.latlongRect.southeast)){p_this.latlong=p_this.latlongRect.Center();p_this.center=a.LatLongToPixel(p_this.latlong,p_this.zoomLevel)}else{p_this.pixelRect.topLeft=a.LatLongToPixel(p_this.latlongRect.northwest,p_this.zoomLevel);p_this.pixelRect.bottomRight=a.LatLongToPixel(p_this.latlongRect.southeast,p_this.zoomLevel);ResolveRectangle(a,c,b)}}else{p_this.zoomLevel=12;p_this.altitude=-1000;p_this.pixelRect.topLeft=a.LatLongToPixel(p_this.latlongRect.northwest,p_this.zoomLevel);p_this.pixelRect.bottomRight=a.LatLongToPixel(p_this.latlongRect.southeast,p_this.zoomLevel);ResolveRectangle(a,c,b)}break}if(p_this.cameraLatlong==null)if(!p_this._UpdateCamera(a)){p_this.tilt=-90;p_this.cameraLatlong=p_this.latlong}viewType="pixel"}function ResolveRectangle(i,k,j){var c=19,a=Math.pow(2,c-p_this.zoomLevel),g=MathMax(1,MathAbs(p_this.pixelRect.topLeft.x-p_this.pixelRect.bottomRight.x)*a),f=MathMax(1,MathAbs(p_this.pixelRect.topLeft.y-p_this.pixelRect.bottomRight.y)*a),d=Math.log(2),e=c-Math.ceil(Math.log(g/k)/d),h=c-Math.ceil(Math.log(f/j)/d),b=MathMin(e,h);if(b<=0)b=1;a=Math.pow(2,b-p_this.zoomLevel);p_this.center.x=0.5*(p_this.pixelRect.topLeft.x+p_this.pixelRect.bottomRight.x)*a-mapInstance.GetCenterOffset().x;p_this.center.y=0.5*(p_this.pixelRect.topLeft.y+p_this.pixelRect.bottomRight.y)*a-mapInstance.GetCenterOffset().y;p_this.zoomLevel=b;p_this.altitude=-1000;p_this.latlong=i.PixelToLatLong(p_this.center,p_this.zoomLevel)}function _UpdateCamera(viewMode){if(p_this.latlong==null)if(p_this.center!=null&&p_this.zoomLevel!=null&&typeof viewMode._InternalOrthoMode=="function"){var orthoMode=viewMode._InternalOrthoMode();p_this.latlong=orthoMode.PixelToLatLong(p_this.center,p_this.zoomLevel);if(p_this.latlong!=null){p_this.tilt=-90;p_this.direction=0}}if(p_this.latlong==null)return false;p_this._needsPivotOperation=false;if(mapInstance.IsModeEnabled(Msn.VE.MapActionMode.Mode3D)){var control=mapInstance.Get3DControl();if(control!=null){var cam=control.CameraPositionGivenTarget(p_this.latlong.latitude,p_this.latlong.longitude,p_this.altitude,p_this.zoomLevel,p_this.tilt,p_this.direction);if(cam!=null){var lat,lon;eval(cam);p_this.cameraLatlong=new Msn.VE.LatLong;p_this.cameraLatlong.latitude=lat;p_this.cameraLatlong.longitude=lon}else return false}}return true}this.MakeCopy=MakeCopy;this.Copy=Copy;this.Equals=Equals;this.ToString=ToString;this.SetCenter=SetCenter;this.SetCenterLatLong=SetCenterLatLong;this.SetPixelRectangle=SetPixelRectangle;this.SetLatLongRectangle=SetLatLongRectangle;this.SetZoomLevel=SetZoomLevel;this.SetMapStyle=SetMapStyle;this.SetTilt=SetTilt;this.SetDirection=SetDirection;this.SetAltitude=SetAltitude;this.GetTilt=GetTilt;this.GetDirection=GetDirection;this.GetAltitude=GetAltitude;this.GetX=GetX;this.GetY=GetY;this.GetCenter=GetCenter;this.Resolve=Resolve;this.SetZoomLevel=SetZoomLevel;this.GetZoomLevel=GetZoomLevel;this.GetLatLongRectangle=GetLatLongRectangle;this.GetPixelRectangle=GetPixelRectangle;this.GetCenterLatLong=GetCenterLatLong;this._UpdateCamera=_UpdateCamera};Msn.VE.ViewChangeType=function(){};Msn.VE.ViewChangeType.Zoom=1;Msn.VE.ViewChangeType.Pan=2;Msn.VE.ViewChangeType.Hybrid=3;Msn.VE.ViewChangeType.IsValid=function(a){return typeof a=="number"&&a>0&&a<4};Msn.VE.ObliqueScene=function(i,y,q,u,x,A,a,b,l,k,f,w){var h=256;this.neighborScenes=f;var z=new Msn.VE.Bounds(1,2,0,0,a/2,b/2);function p(d,e){var c=Math.pow(2,e-2),f=[[d.x/c],[d.y/c],[1]],a=MatrixMultiply(l,f),b=new Msn.VE.LatLong;b.longitude=a[0][0]/a[2][0];b.latitude=a[1][0]/a[2][0];return b}function c(d,e){var c=Math.pow(2,e-2),f=[[d.longitude],[d.latitude],[1]],a=MatrixMultiply(k,f),b=new Msn.VE.Pixel;b.x=a[0][0]/a[2][0]*c;b.y=a[1][0]/a[2][0]*c;return b}function t(c,d,e){if(c<0||d<0)return false;if(e==1)return c<a/2&&d<b/2;return c<a&&d<b}function B(){return i}function n(c,e,b){var d=e*(b==1?a/2:a)+c;return "http://c"+c%2+".p"+A+".oblique.tiles.virtualearth.net/tiles/o"+y+"-"+q+"-"+(x+b-2)+"-"+d+".jpeg?g=51"}function j(){return "http://thumbs.oblique.tiles.virtualearth.net/tiles/ot"+i+".jpeg?g=51"}function r(b){var a=f[b];if(a==null||a==-1)return null;return new Msn.VE.ObliqueScene(a)}function s(b){var a=w[b];if(a==null||a==-1)return null;return new Msn.VE.ObliqueScene(a)}function o(){return u}function v(){return z}function g(){return a*h}function e(){return b*h}function m(a){if(!a)return false;var b=c(a,2);return d(b,2)}function d(b,f){var a=Math.pow(2,2-f),c=b.x*a,d=b.y*a;return c>=0&&d>=0&&c<g()&&d<e()}this.PixelToLatLong=p;this.LatLongToPixel=c;this.IsValidTile=t;this.GetID=B;this.GetTileFilename=n;this.GetThumbnailFilename=j;this.GetNeighbor=r;this.GetRotation=s;this.GetOrientation=o;this.GetBounds=v;this.GetWidth=g;this.GetHeight=e;this.ContainsLatLong=m;this.ContainsPixel=d};Msn.VE.Orientation=new function(){this.North="North";this.East="East";this.West="West";this.South="South"};Msn.VE.Pixel=function(a,b){this.x=a;this.y=b;this.ToString=function(){return "("+this.x+", "+this.y+")"};this.Copy=function(a){if(!a)return;this.x=a.x;this.y=a.y}};Msn.VE.PixelRectangle=function(b,a){this.topLeft=b;this.bottomRight=a;this.ToString=function(){return "("+(this.topLeft?this.topLeft.ToString():"null")+", "+(this.bottomRight?this.bottomRight.ToString():"null")+")"};this.Copy=function(a){if(!a)return;if(!this.topLeft)this.topLeft=new Msn.VE.Pixel;if(!this.bottomRight)this.bottomRight=new Msn.VE.Pixel;this.topLeft.Copy(a.topLeft);this.bottomRight.Copy(a.bottomRight)};this.Contains=function(a){if(a instanceof Msn.VE.Pixel)return a.x>this.topLeft.x&&a.y>this.topLeft.y&&a.x<this.bottomRight.x&&a.y<this.bottomRight.y}};Msn.VE.LineRegion=function(b,a,c){this.boundingRectangle=b;this.indices=a;this.childRegions=c;function d(){return "Bounding Rectangle: "+this.boundingRectangle[0].ToString()+" to "+this.boundingRectangle[1].ToString()+" | Indices: ["+a+"]"}this.ToString=d};var L_integerencodingoutofrange_text="VEIntegerEncoding: The number encoded is out of supported range",L_floatintegermapencodingoutofrange_text="VEFloatIntegerMap: The number encoded is out of supported range",L_integerencodinginvalidstringlength_text="VEIntegerEncoding: Invalid string length",L_integerencodingunknowndigit_text="VEIntegerEncoding: The encoded string has an unknown digit";function VEIntegerEncoding(g,j){var e=g,d=g.length,a=j,h=1;for(var i=0;i<a;++i)h*=d;var f=h-1,c=[];for(var b=0;b<e.length;++b)c[e.substr(b,1)]=b;this.MaxValue=function(){return f};this.ValueLength=function(){return a};this.Encode=function(c){if(c<=f){var h="",g=[];for(var b=0;b<a;++b)g[b]=0;var i=a-1;while(c>0){g[i]=Math.floor(c%d);c=Math.floor(c/d);--i}for(b=0;b<g.length;++b)h+=e.substr(g[b],1);return h}else throw L_integerencodingoutofrange_text};this.Decode=function(c){if(c.length==a){var b=0;for(var e=0;e<c.length;++e){b*=d;b+=this.DigitValue(c.substr(e,1))}return b}else throw L_integerencodinginvalidstringlength_text};this.DigitValue=function(a){if(c[a]!=null&&c[a]!="undefined")return c[a];else throw L_integerencodingunknowndigit_text}}function VEFloatIntegerMap(e,d,f){var a=e,c=d,b=f;this.MinFloat=function(){return a};this.MaxFloat=function(){return c};this.MaxInt=function(){return b};this.FloatToInt=function(d){if(d>=a&&d<=c){var e=(d-a)/(c-a),f=e*b+0.5;return Math.min(Math.floor(f),b)}else throw L_floatintegermapencodingoutofrange_text};this.IntToFloat=function(d){if(d<=b){var f=d/b,e=a+f*(c-a);return e}else throw L_floatintegermapencodingoutofrange_text}}var L_velatlongencodinginvalidstringlength_text="VELatLongEncoding: Invalid string length";function VELatLongEncoding(){var g=-90,f=90,e=-180,d=180,i="0123456789bcdfghjkmnpqrstvwxyz",h=6,a=new VEIntegerEncoding(i,h),c=new VEFloatIntegerMap(g,f,a.MaxValue()),b=new VEFloatIntegerMap(e,d,a.MaxValue());this.Encode=function(e,d){var f=a.Encode(c.FloatToInt(e))+a.Encode(b.FloatToInt(d));return f};this.Decode=function(f){if(f.length==2*a.ValueLength()){var e=a.ValueLength(),j=f.substr(0,e),h=f.substr(e,e),i=a.Decode(j),g=a.Decode(h),d=[];d[0]=c.IntToFloat(i);d[1]=b.IntToFloat(g);return d}else throw L_velatlongencodinginvalidstringlength_text}}var Shims=["help","msve_ScratchPad","whereambiglist","VE_MessageControl","contextMenu","dashboard"],vedomain="http://maps.live.com";function initShimElements(){for(var a=0;a<Shims.length;a++)UpdateIFrameShim(Shims[a])}function hookResizeEvent(a){if(a.onresize==null)a.onresize=function(){var b=event.srcElement,a=b.shimElement;if(a)SetShimPosition(a,b)}}function destroyShimElements(){for(var a=0;a<Shims.length;a++)destroyIFrameShim(Shims[a]);var b=$ID("msve_ScratchPad");if(b)b.onresize=null}function SetShimPosition(a,b){a.style.top=GetElementTopPosition(b,a.parentNode);a.style.left=GetElementLeftPosition(b,a.parentNode);a.width=b.offsetWidth;a.height=b.offsetHeight;a.style.clip=b.style.clip}function UpdateIFrameShim(c,d){var a=typeof c=="object"?c:$ID(c);if(!a)return;if(!a.shimElement)addIFrameShim(a,d);var b=a.shimElement;SetShimPosition(b,a);if(Microsoft.Web.Css.Functions.getComputedStyle(a,"display")=="none"||Microsoft.Web.Css.Functions.getComputedStyle(a,"visibility")=="hidden")b.style.display="none";else b.style.display="block"}function RepositionShims(){if(!view3DMode)return;for(var b=0;b<Shims.length;b++){var a=$ID(Shims[b]);if(a&&a.shimElement&&a.shimElement.style.display!="none")SetShimPosition(a.shimElement,a)}}function addIFrameShim(b,e){var a=document.createElement("iframe");a.frameBorder="0";a.scrolling="no";a.style.position="absolute";a.style.zIndex="1";b.shimElement=a;HideShim(b);var c=e;if(c==null)c=b;var d=c.parentNode;if(d==null)d=document.body;d.insertBefore(a,c);if(b.id=="msve_ScratchPad"||b.id&&b.id.indexOf("_vefindcontrolinput")>0)hookResizeEvent(b);return a}function destroyIFrameShim(b){var a=$ID(b);if(a!=null&&a.shimElement){a.shimElement.removeNode(true);a.shimElement=null}}function ShowShim(a,b){UpdateIFrameShim(a,b);if(a!=null&&a.shimElement)a.shimElement.style.display="block"}function HideShim(a){if(a!=null&&a.shimElement)a.shimElement.style.display="none"}function RollShim(b){var a=b.Recipient;if(a.shimElement)a.shimElement.style.clip=a.style.clip}function OnView3DKeyDown(c,b){CloseContextMenu();ero.hide();var a=GetMapControlInstance(b);if(a==null)return;var d=parseInt(c);switch(d){case 65:a.SetMapStyle("a");break;case 72:a.SetMapStyle("h");break;case 82:case 86:a.SetMapStyle("r");break;case 50:case 98:a.EnableMode(Msn.VE.MapActionMode.Mode2D);break}}function OnNavigationHelpFired(){VE_Help.OpenLiveHelp("wl_local","topic","WL_LOCAL_PROC_3D_NavigateMap.htm")}function OnHardwareAccelHelpFired(){VE_Help.OpenLiveHelp("wl_local","topic","WL_LOCAL_TROU_3D_VideoAcceleration.htm")}function OnView3DMouseDown(){CloseContextMenu();ero.hide()}function OnView3DDropGeometry(pinPosition){var layerId,pushpinId,lat,lon,alt;eval(pinPosition);var result=VE_MapManager.GetAnnotationById(pushpinId);if(result)VE_Annotations.MovePushpin(null,new Msn.VE.LatLong(lat,lon))}function OnView3DLatLonAltClicked(position){var lat,lon,alt;eval(position);VE_MapUpdateView_AutoSaveEntity();VE_EditControl.AddPoint(null,lat,lon)}function OnBeginFlyTo(c,b){var a=GetMapControlInstance(b);if(a!=null)a.OnBeginCameraUpdate()}function OnView3DUpdateViewpoint(viewpoint,mapGuid){var lat,lon,zoom,alt,heading,pitch,targetLat,targetLon;eval(viewpoint);var mapcontrolinstance=GetMapControlInstance(mapGuid);if(mapcontrolinstance==null)return;mapcontrolinstance.OnEndCameraUpdate();var ePosition=1E-06,eOrientation=0.1,eAltitude=0.01,view=mapcontrolinstance.GetCurrentMapView(),orientationEqual=Math.abs(heading-view.GetDirection())<eOrientation&&Math.abs(pitch-view.GetTilt())<eOrientation,latlongEqual=view.cameraLatlong!=null&&Math.abs(lat-view.cameraLatlong.latitude)<ePosition&&Math.abs(lon-view.cameraLatlong.longitude)<ePosition,altEqual=Math.abs(alt-view.GetAltitude())<eAltitude&&view.GetZoomLevel()==zoom,animationFinished=latlongEqual&&orientationEqual&&(view.GetAltitude()<=-1000&&view.GetZoomLevel()==zoom);if(!animationFinished){var onAnimationInterruptedCallback=mapcontrolinstance.GetOn3DAnimationInterruptedCallback();if(onAnimationInterruptedCallback)onAnimationInterruptedCallback()}view=new Msn.VE.MapView(mapcontrolinstance);view.latlong=new Msn.VE.LatLong(targetLat,targetLon);view.cameraLatlong=new Msn.VE.LatLong(lat,lon);view.SetZoomLevel(zoom);view.SetMapStyle(mapcontrolinstance.GetMapStyle());view.SetAltitude(alt);view.SetDirection(heading);view.SetTilt(pitch);view._supressFlyToCall=true;mapcontrolinstance.Fire("onendcontinuouspan");mapcontrolinstance.Fire("onchangeview");mapcontrolinstance.SetView(view)}function ProcessQueuedRequest(c,b){var a=GetVEMapInstance(b);if(a!=null)a._ProcessQueuedRequest()}function OnView3DHoverEnd(){ero.hide()}function CloseContextMenu(){VE_MapUpdateView_AutoSaveEntity();VE_MapUpdateView_AutoSaveEntity();if(VE_ContextMenu.MenuOpen){VE_ContextMenu.RemoveContextPin();VE_ContextMenu.CloseMenu()}}function OnView3DPushpinHover(pushPinEval,mapGuid){if(typeof VE_Annotations!="undefined")if(VE_Annotations.PanelOpen)return;var layerId,pushpinId,rX1,rY1,rX2,rY2;eval(pushPinEval);var vmap,mapcontrol,mapid;try{if(typeof Msn.VE.API=="undefined"||Msn.VE.API==null){vmap=null;mapcontrol=map;mapid="mapcontainer"}else{vmap=GetVEMapInstance(mapGuid);if(vmap==null)return;mapcontrol=vmap.vemapcontrol;mapid=vmap.ID}}catch(a){return}var mapdiv=$ID(mapid);if(mapdiv==null)return;var mapx,mapy;mapx=GetLeftPosition(mapdiv);mapy=GetTopPosition(mapdiv);var rect=new Microsoft.Web.Geometry.Rectangle(new Microsoft.Web.Geometry.Point(rX1+mapx,rY1+mapy),new Microsoft.Web.Geometry.Point(rX2+mapx,rY2+mapy));if(vmap!=null){var pushpins=vmap.pushpins;if(pushpins!=null){var len=pushpins.length;for(var i=0;i<len;i++){var p=pushpins[i];if(p!=null&&p.ID==pushpinId){ero.hide();VEPushpin.Show3D(rect,p.Title,p.Details,p.TitleStyle,p.DetailsStyle);return}}}return}else{var result=VE_MapManager.GetAnnotationById(pushpinId);if(result){var entity=result;try{if(entity!="undefined"&&entity!=""&&entity){var content=null,col=null;col=VE_MapManager.GetCollectionByAnId(pushpinId);if(col.GetType()==MC_COL_TYPE_COLLECTION)content=VE_MapViewPreUpdate.CreateEroContent(pushpinId);else content=VE_MapViewPreUpdate.Viewer.CreatePopupContent(entity);if(content&&content!="undefined"&&content!=""&&content.length>0){CloseContextMenu();ero.setContent(content);ero.dockToRect(rect,null,-1,true,true)}}}catch(a){alert(a.message)}return}}var re=/veDDstep_(.*)_pin_pinDiv/g,result=re.exec(pushpinId);if(result!=null&&result.length>=2){var instNum=result[1];ero.clearActions();content=VE_Directions.routeDisplayManager.GeneratePopupContent(instNum);CloseContextMenu();ero.setContent(content);ero.dockToRect(rect,null,-1,true,true);return}re=/pin_traffic_market_(.*)/g;result=re.exec(pushpinId);if(result!=null&&result.length>=2){entity=VE_TrafficManager.GetEntity(pushpinId);if(entity!=null){content=VE_TrafficManager.CreateZoomPopupContent(entity);if(content!=null&&content!=""&&content!="undefined"){CloseContextMenu();ero.setContent(content);ero.dockToRect(rect,null,-1,true,true);return}}}re=/pin_traffic_incident_(.*)/g;result=re.exec(pushpinId);if(result!=null&&result.length>=2){entity=VE_TrafficManager.GetEntity(pushpinId);if(entity!=null){content=VE_TrafficManager.CreatePopupContent(entity,true);if(content!=null&&content!=""&&content!="undefined"){CloseContextMenu();ero.setContent(content);ero.dockToRect(rect,null,-1,true,true);return}}}if(pushpinId=="autolocate"){pushpins=mapcontrol.GetPushpins();if(pushpins)for(i=0;i<pushpins.length;++i)if(pushpins[i].pin.id=="autolocate"){var pinDOM=pushpins[i].pin;pinDOM.onmouseover(rect);return}}re=/pin_(.*)_(.*)/g;result=re.exec(pushpinId);if(result!=null&&result.length>=3){var searchIndex=result[1],resultIndex=result[2],s=VE_SearchManager.FindByIndex(searchIndex);if(s!=null){var r=s.GetEntity(resultIndex);if(r!=null){VE_SearchManager.SetLatLong(r.latitude,r.longitude);content=VE_SearchManager.CreatePopupContent(r,true,searchIndex);CloseContextMenu();ero.setContent(content);VE_SearchManager.AddClick2CallSend2Phone(r,resultIndex);ero.dockToRect(rect,null,-1,true,true)}}return}}function OnHardwareCapabilitiesUpdate(){if(typeof view3DMode!="undefined"&&view3DMode){var a=map.Get3DControl();if(3==a.HardwareClassificationLevel){a.AddElevationSource("Terrain","DEM",vedomain+"/Manifests/HighDemContentManifest.xml",0);a.AddModelSource("Model","Model",vedomain+"/Manifests/ModelContentManifest.xml")}else if(2==a.HardwareClassificationLevel){a.AddElevationSource("Terrain","DEM",vedomain+"/Manifests/DemContentManifest.xml",0);a.AddModelSource("Model","Model",vedomain+"/Manifests/MedModelContentManifest.xml")}else{a.AddElevationSource("Terrain","DEM",vedomain+"/Manifests/DemContentManifest.xml",0);a.RemoveModelSource("Model","Model")}}}function View3DMovePin(a){map.Get3DControl().PickupGeometry("UniqueLayer_Hack",a)}function HandleModeNotInstalled(a){if(a==Msn.VE.MapActionMode.Mode3D){map.EnableMode(Msn.VE.MapActionMode.Mode2D);View3DInstall()}}function View3DInstall(){try{VE_Help.Open(l795dkt,"Help/"+window.locale+"/View3DInstall.htm")}catch(a){}}function Install3DView(){OpenNewWindow(state.Get3DViewDownloadUrl(),l220djt,"all");if(navigator.userAgent.indexOf(".NET CLR 2.")!=-1)VE_Help.Open(l795dkt,"Help/"+window.locale+"/View3DDuringInstall.htm");else VE_Help.Open(l795dkt,"Help/"+window.locale+"/View3DRestartNeeded.htm")}function Start3DView(){if(map)map.EnableMode(Msn.VE.MapActionMode.Mode3D)}function PushpinURL(d,c){var b=vedomain+"/i/bin/"+window.buildVersion+"/";if(typeof d=="undefined"||d==null)return b+"pins/red_circ7px.gif";var a=Msn.VE.PushPinTypes;switch(d){case a.Annotation:if(c===false)return b+"pins/poi_businesslisting.gif";return b+"pins/poi_usergenerated.gif";case a.SearchResult:return b+"pins/poi_"+c+".gif";case a.DirectionStep:return b+"pins/RedCircle"+c+".gif";case a.Direction:case a.DirectionTemp:return b+"pins/mapicon_"+c+".gif";case a.TrafficOthers:return b+"Traffic/Traffic"+c+".gif";case a.YouAreHere:return b+"pins/poi_youarehere.gif";case a.Default:return b+"pins/"+c;case a.AdRoofStandard:case a.AdRoofWide:case a.AdStandard:case a.AdWide:case a.AdCategory:return c;default:}return b+"pins/poi_usergenerated.gif"}function TranslatePushpinURL(g,e,k,h){var b=Msn.VE.PushPinTypes,j,c=null;switch(h){case b.DirectionStep:var d=/RedCircle([0123456789]+)/g,a=d.exec(e);if(a!=null&&a.length>=2)c=a[1];break;case b.Direction:case b.DirectionTemp:d=/mapicon_(start|end).gif/g;a=d.exec(e);if(a!=null&&a.length>=2)c=a[1];break;case b.SearchResult:d=/VE_Pushpin VE_Pushpin_(.*)/g;a=d.exec(g);if(a!=null&&a.length>=2)c=a[1];break;case b.TrafficOthers:d=/VE_Pushpin VE_Traffic_(.*)/g;a=d.exec(g);if(a!=null&&a.length>=2)c=a[1];break;case b.AdRoofStandard:case b.AdRoofWide:case b.AdStandard:case b.AdWide:case b.AdCategory:var f=document.createElement("div");f.innerHTML=e;var i=f.getElementsByTagName("img");if(i.length>=1)c=i[0].getAttribute("src");f=null;break}j=PushpinURL(h,c);return j}function RaiseMouseEvent3D(info,mapGuid,eventName){try{var lat=null,lon=null;eval(info);var mapcontrolinstance=GetMapControlInstance(mapGuid);if(mapcontrolinstance==null)return;var r2d=180/Math.PI,clickEvent=mapcontrolinstance.CreateEvent(lat==null||lon==null?null:new Msn.VE.LatLong(lat*r2d,lon*r2d));mapcontrolinstance.Fire(eventName,clickEvent)}catch(a){}}function OnMouseDown3D(b,a){RaiseMouseEvent3D(b,a,"onmousedown")}function OnMouseUp3D(b,a){RaiseMouseEvent3D(b,a,"onmouseup")}function OnClick3D(b,a){RaiseMouseEvent3D(b,a,"onclick")}function GetMapControlInstance(b){if(typeof Msn.VE.API=="undefined"||Msn.VE.API==null)return map;var a=GetVEMapInstance(b);if(a==null)return null;return a.vemapcontrol}function GetVEMapInstance(a){if(typeof a=="undefined"||a==null){if(Msn.VE.API.Globals.vemapinstances==null||Msn.VE.API.Globals.vemapinstances=="undefined")return null;var c=0;for(var b in Msn.VE.API.Globals.vemapinstances)if(Msn.VE.API.Globals.vemapinstances[b]instanceof VEMap&&Msn.VE.API.Globals.vemapinstances[b].GetMapMode()==VEMapMode.Mode3D){c++;a=b}if(c!=1)return null}return VEMap._GetMapFromGUID(a)}var __vemapcontrolisReady=true,windowWidth=0,windowHeight=0,scrollbarWidth=null;function $ID(a){var b=document;return b.getElementById(a)}function $CE(a){var b=document;return b.createElement(a)}function $CENS(a){var b=document;return b.createElementNS(a)}function GetWindowWidth(){var a=0;if(typeof window.innerWidth=="number")a=window.innerWidth;else if(document.documentElement&&document.documentElement.clientWidth)a=document.documentElement.clientWidth;else if(document.body&&document.body.clientWidth)a=document.body.clientWidth;if(!a||a<100)a=100;return a}function GetWindowHeight(){var a=0;if(typeof window.innerHeight=="number")a=window.innerHeight;else if(document.documentElement&&document.documentElement.clientHeight)a=document.documentElement.clientHeight;else if(document.body&&document.body.clientHeight)a=document.body.clientHeight;if(!a||a<100)a=100;return a}function GetScrollbarWidth(){if(scrollbarWidth)return scrollbarWidth;if(navigator.userAgent.indexOf("IE")>=0){var a=document.createElement("div"),b=null;a.style.visible="hidden";a.style.overflowY="scroll";a.style.position="absolute";a.style.width=0;document.body.insertAdjacentElement("afterBegin",a);b=a.offsetWidth;a.parentNode.removeChild(a);if(!b)b=16;scrollbarWidth=b;return b}else return 0}function GetUrlPrefix(){var a=window.location.pathname.lastIndexOf("/"),b=window.location.protocol+"//"+window.location.hostname+window.location.pathname.substring(0,a+1);return b}function GetUrlParameterString(){var a=window.location.search;if(a.length==0||a.indexOf("?")==-1)return "";return a.substr(a.indexOf("?")+1)}function CheckWipExistence(){var a=GetUrlParameterString();if(a!=""&&a.indexOf("wip=")>-1)return true;return false}function GetUrlParameters(){var b=[],d=GetUrlParameterString();if(!d)return b;var e=d.split("&");for(var c=0;c<e.length;c++){var a=e[c].split("=");if(a.length==2&&a[0]&&a[1]){b.push(unescape(a[0]));b.push(unescape(a[1]))}}return b}function ParseShiftKeyForLinks(a){if(a.shiftKey)return false;return true}Msn.VE.API=new Object;Msn.VE.API.Globals=new Object;Msn.VE.API.Constants=new Object;Msn.VE.API.Globals.vemapinstances=null;Msn.VE.API.Globals.veonbegininvokeevent=null;Msn.VE.API.Globals.veonendinvokeevent=null;Msn.VE.API.Globals.vefindresultsnpanel=null;Msn.VE.API.Globals.language="en";Msn.VE.API.Globals.locale="en-us";Msn.VE.API.Globals.vecurrentversion="1.3.1115150037.31";Msn.VE.API.Globals.vecurrentdomain="http://maps.live.com";Msn.VE.API.Globals.veanalyticsenabled="True";Msn.VE.API.Globals.veomnitureaccount="msnportalearth";Msn.VE.API.Globals.vedebug=false;Msn.VE.API.Globals.analyticsInitialized=false;Msn.VE.API.Constants.omnitureurl="http://stj.msn.com/br/om/js/s_code.js";Msn.VE.API.Constants.imageryurl=Msn.VE.API.Globals.vecurrentdomain+"/imagery.ashx";Msn.VE.API.Constants.iconurl=Msn.VE.API.Globals.vecurrentdomain+"/i/bin/"+Msn.VE.API.Globals.vecurrentversion+"/pins/poi_usergenerated.gif";Msn.VE.API.Constants.mapcontroljs=Msn.VE.API.Globals.vecurrentdomain+"/mapcontrol.ashx";Msn.VE.API.Constants.searchservice=Msn.VE.API.Globals.vecurrentdomain+"/search.ashx";Msn.VE.API.Constants.directionsservice=Msn.VE.API.Globals.vecurrentdomain+"/directions.ashx";Msn.VE.API.Constants.collectionservice=Msn.VE.API.Globals.vecurrentdomain+"/UserCollections.aspx";Msn.VE.API.Constants.atlascompatjs=Msn.VE.API.Globals.vecurrentdomain+"/js/atlascompat.js";Msn.VE.API.Constants.stylesheet=Msn.VE.API.Globals.vecurrentdomain+"/css/bin/"+Msn.VE.API.Globals.vecurrentversion+"/"+Msn.VE.API.Globals.language+"/api.css";Msn.VE.API.Constants.erostylesheet=Msn.VE.API.Globals.vecurrentdomain+"/css/bin/"+Msn.VE.API.Globals.vecurrentversion+"/"+Msn.VE.API.Globals.language+"/ero.css";Msn.VE.API.Constants.vedirectionsstarticon=Msn.VE.API.Globals.vecurrentdomain+"/i/bin/"+Msn.VE.API.Globals.vecurrentversion+"/pins/mapicon_start.gif";Msn.VE.API.Constants.vedirectionsendicon=Msn.VE.API.Globals.vecurrentdomain+"/i/bin/"+Msn.VE.API.Globals.vecurrentversion+"/pins/mapicon_end.gif";Msn.VE.API.Constants.vedirectionsstepicon=Msn.VE.API.Globals.vecurrentdomain+"/i/bin/"+Msn.VE.API.Globals.vecurrentversion+"/pins/RedCircle%1.gif";Msn.VE.API.Constants.trafficstylesheet=Msn.VE.API.Globals.vecurrentdomain+"/css/bin/"+Msn.VE.API.Globals.vecurrentversion+"/"+Msn.VE.API.Globals.language+"/Traffic.css";Msn.VE.API.Constants.trafficiconurl=Msn.VE.API.Globals.vecurrentdomain+"/i/bin/"+Msn.VE.API.Globals.vecurrentversion+"/Traffic/Traffic%1.gif";Msn.VE.API.Constants.mapguid="mapguid";Msn.VE.API.Constants.contextid="contextid";Msn.VE.API.Globals.vemapmode=Msn.VE.MapActionMode.Mode2D;Msn.VE.API.Globals.vemapheight=400;Msn.VE.API.Globals.vemapwidth=600;Msn.VE.API.Globals.vemapzoom=4;Msn.VE.API.Globals.vemaplatitude=43.75;Msn.VE.API.Globals.vemaplongitude=-99.71;Msn.VE.API.Globals.vemapstyle="r";Msn.VE.API.Globals.vemaxzoom=26;Msn.VE.API.Globals.vepushpinpanelzIndex=999;Msn.VE.API.Globals.vemessagepanelheight=75;Msn.VE.API.Globals.vemessagepanelzIndex=99;Msn.VE.API.Globals.veplacelistpanelheight=200;Msn.VE.API.Globals.veplacelistpanelwidth=350;Msn.VE.API.Globals.veplacelistpanelzIndex=300;Msn.VE.API.Globals.vefindresultsnpanelwidth=200;Msn.VE.API.Globals.vefindresultsnpanelzIndex=99;Msn.VE.API.Globals.vefindresultsnpanelcolor="blue";Msn.VE.API.Globals.vecurrentsearchindex=1;Msn.VE.API.Globals.vesearchpoiresults=null;Msn.VE.API.Globals.vesearchlocresults=null;Msn.VE.API.Globals.veiscommercialcontrol=false;Msn.VE.API.Globals.veobliqueMode=null;Msn.VE.API.Globals.Dispose=function(){Msn.VE.API.Globals.veonbegininvokeevent=null;Msn.VE.API.Globals.veonendinvokeevent=null;Msn.VE.API.Globals.vefindresultsnpanel=null};Msn.VE.API.Globals.PosX=function(a){var b=0;if(!a)a=window.event;if(a.pageX)b=a.pageX;else if(a.clientX)b=a.clientX+document.body.scrollLeft;return b};Msn.VE.API.Globals.PosY=function(a){var b=0;if(!a)a=window.event;if(a.pageY)b=a.pageY;else if(a.clientY)b=a.clientY+document.body.scrollTop;return b};function VE_Help(){}RegisterNamespaces("Msn.VE.Constants.Css");var header=document.getElementsByTagName("body")[0],VE_ContextMenu=null;s_account=Msn.VE.API.Globals.veomnitureaccount;Msn.MVC.AbstractView.prototype.GetMoveMenuOptionAsHtml=function(a){return a};Msn.MVC.View3D.prototype.GetMoveMenuOptionAsHtml=function(d,c){var e=c.GetPrimitiveCount();for(var a=0;a<e;a++){var b=c.GetPrimitive(a).type;if(b==MC_GEO_TYPE_POLYLINE||b==MC_GEO_TYPE_POLYGON)return ""}return d};Msn.MVC.ViewFacade.prototype.GetMoveMenuOptionAsHtml=function(a,b){if(this._curMvcView==null)return "";return this._curMvcView.GetMoveMenuOptionAsHtml(a,b)};function RegisterNamespaces(){for(var d=0;d<arguments.length;d++){var b=arguments[d].split("."),c=window;for(var a=0;a<b.length;a++){if(!c[b[a]])c[b[a]]=new Object;c=c[b[a]]}}}function VE_SelectItem(b,a){this.data=b;this.description=a}VE_SelectItem.prototype.toString=function(){return this.description};function VE_Select(h,l,k,j){this.isVisible=false;var b=[],a=document.createElement("div");a.setAttribute("id",h);this.id=h;var v=h,d=this,c=-1,r=k?k:"",m=l?l:"",p=j?j:"",e="";function y(d){if(!(d instanceof VE_SelectItem))d=new VE_SelectItem(d,d.toString());b.push(d);var c=document.createElement("div");c.setAttribute("id",v+"_"+(b.length-1));c.onclick=w;c.onmouseover=q;c.onmouseout=s;c.innerHTML=d.description;a.appendChild(c)}function x(){return b.length}function u(){return a}function w(e){var c=GetTarget(e),a=f(c);i(a);if(d.OnClick)d.OnClick(a,b[a]);if(d.OnSelect)d.OnSelect(a,b[a])}function q(g){var a=GetTarget(g),c=f(a);e=a.className;a.className=p;if(d.OnMouseOver)d.OnMouseOver(c,b[c])}function s(g){var a=GetTarget(g),c=f(a);a.className=e;if(d.OnMouseOut)d.OnMouseOut(c,b[c])}function i(d){if(d>=0&&d<b.length){var f=g();if(f>=0)a.childNodes[f].className=m;c=d;a.childNodes[d].className=r;e=a.childNodes[d].className}else{f=g();if(f>=0)a.childNodes[f].className=m;c=-1}}function g(){return c}function o(){if(c>=0&&c<b.length)return b[c];return null}function n(d){if(d<0||d>=b.length)return;if(d<c)c-=1;else if(d==c)c=-1;b.splice(d,1);a.removeChild(a.childNodes[d])}function f(c){for(var b=0;b<a.childNodes.length;++b)if(c==a.childNodes[b])return b;return -1}function t(){while(b.length>0)b.pop();while(a.childNodes.length>0)a.removeChild(a.lastChild);c=-1}function A(){a.style.display="block";this.isVisible=true}function z(){a.style.display="none";this.isVisible=false}this.OnClick=null;this.GetCount=x;this.GetElement=u;this.GetSelectedIndex=g;this.GetSelectedItem=o;this.SelectItemAtIndex=i;this.OnSelect=null;this.AddItem=y;this.OnMouseOver=null;this.OnSelect=null;this.OnMouseOut=null;this.ClearItems=t;this.RemoveItemAtIndex=n;this.Show=A;this.Hide=z}function OutputEncoder_URLEncodeUTF8(e){if(e==null)return "";var d=["%00","%01","%02","%03","%04","%05","%06","%07","%08","%09","%0a","%0b","%0c","%0d","%0e","%0f","%10","%11","%12","%13","%14","%15","%16","%17","%18","%19","%1a","%1b","%1c","%1d","%1e","%1f","%20","%21","%22","%23","%24","%25","%26","%27","%28","%29","%2a","%2b","%2c","%2d","%2e","%2f","%30","%31","%32","%33","%34","%35","%36","%37","%38","%39","%3a","%3b","%3c","%3d","%3e","%3f","%40","%41","%42","%43","%44","%45","%46","%47","%48","%49","%4a","%4b","%4c","%4d","%4e","%4f","%50","%51","%52","%53","%54","%55","%56","%57","%58","%59","%5a","%5b","%5c","%5d","%5e","%5f","%60","%61","%62","%63","%64","%65","%66","%67","%68","%69","%6a","%6b","%6c","%6d","%6e","%6f","%70","%71","%72","%73","%74","%75","%76","%77","%78","%79","%7a","%7b","%7c","%7d","%7e","%7f","%80","%81","%82","%83","%84","%85","%86","%87","%88","%89","%8a","%8b","%8c","%8d","%8e","%8f","%90","%91","%92","%93","%94","%95","%96","%97","%98","%99","%9a","%9b","%9c","%9d","%9e","%9f","%a0","%a1","%a2","%a3","%a4","%a5","%a6","%a7","%a8","%a9","%aa","%ab","%ac","%ad","%ae","%af","%b0","%b1","%b2","%b3","%b4","%b5","%b6","%b7","%b8","%b9","%ba","%bb","%bc","%bd","%be","%bf","%c0","%c1","%c2","%c3","%c4","%c5","%c6","%c7","%c8","%c9","%ca","%cb","%cc","%cd","%ce","%cf","%d0","%d1","%d2","%d3","%d4","%d5","%d6","%d7","%d8","%d9","%da","%db","%dc","%dd","%de","%df","%e0","%e1","%e2","%e3","%e4","%e5","%e6","%e7","%e8","%e9","%ea","%eb","%ec","%ed","%ee","%ef","%f0","%f1","%f2","%f3","%f4","%f5","%f6","%f7","%f8","%f9","%fa","%fb","%fc","%fd","%fe","%ff"],b,a=[],g=e.length;for(var f=0;f<g;f++){var c=e.charCodeAt(f),b=e.charAt(f);if("A"<=b&&b<="Z")a=a+b;else if("a"<=b&&b<="z")a=a+b;else if("0"<=b&&b<="9")a=a+b;else if(b==" ")a=a+"+";else if(b=="-"||b=="_"||b=="."||b=="!"||b=="~"||b=="*"||b=="'"||b=="("||b==")")a=a+String.fromCharCode(c);else if(c<=127)a=a+d[c];else if(c<=2047){a=a+d[192|c>>6];a=a+d[128|c&63]}else{a=a+d[224|c>>12];a=a+d[128|c>>6&63];a=a+d[128|c&63]}}return a}function OutputEncoder_EncodeHtml(c){var a,b="";if(c==null)return "";for(var d=0;d<c.length;d++){a=c.charCodeAt(d);if(a>96&&a<123||a>64&&a<91||a==32||a>47&&a<58||a==46||a==44||a==45||a==95)b=b+String.fromCharCode(a);else b=b+"&#"+a+";"}return b}function OutputEncoder_EncodeHtmlAttribute(c){var a,b="";if(c==null)return "";for(var d=0;d<c.length;d++){a=c.charCodeAt(d);if(a>96&&a<123||a>64&&a<91||a>47&&a<58||a==46||a==44||a==45||a==95)b=b+String.fromCharCode(a);else b=b+"&#"+a+";"}return b}function OutputEncoder_EncodeXml(a){return OutputEncoder_EncodeHtml(a)}function OutputEncoder_EncodeXmlAttribute(a){return OutputEncoder_EncodeHtmlAttribute(a)}function OutputEncoder_EncodeJs(c){var a,b="";if(c==null)return "";for(var d=0;d<c.length;d++){a=c.charCodeAt(d);if(a>96&&a<123||a>64&&a<91||a==32||a>47&&a<58||a==46||a==44||a==45||a==95)b=b+String.fromCharCode(a);else if(a>127)b=b+"\\u"+OutputEncoder_TwoByteHex(a);else b=b+"\\x"+OutputEncoder_SingleByteHex(a)}return "'"+b+"'"}function OutputEncoder_EncodeVbs(d){var b,a="",c=false;if(d==null)return "";for(var e=0;e<d.length;e++){b=d.charCodeAt(e);if(b>96&&b<123||b>64&&b<91||b==32||b>47&&b<58||b==46||b==44||b==45||b==95){if(!c){a=a+'&"';c=true}a=a+String.fromCharCode(b)}else{if(c){a=a+'"';c=false}a=a+"&chrw("+b+")"}}if(a.charAt(0)=="&")a=a.substring(1);if(a.length==0)a='""';if(c)a=a+'"';return a}function OutputEncoder_AsUrl(a){if(a==null)return "";if(a.search(/^(?:http|https|ftp):\/\/[a-zA-Z0-9\.\-]+(?:\:\d{1,5})?(?:[A-Za-z0-9\.\;\:\@\&\=\+\$\,\?\/]|%u[0-9A-Fa-f]{4}|%[0-9A-Fa-f]{2})*$/i))throw"Unsanitized value passed to AsUrl";return a}function OutputEncoder_QualifyUrl(a){if(a==null)return "";if(a.search(/^(?:http|https|ftp):\/\//i))if(document.location.protocol=="HTTPS")return "https://"+document.location.hostname+OutputEncoder_QualifyUrl_MakePath(a);else return "http://"+document.location.hostname+OutputEncoder_QualifyUrl_MakePath(a);else return a}function OutputEncoder_QualifyUrl_MakePath(a){if(a==null)return "";if(!a.search(/^[\/\\]/))return a;var b=/^(\/(?:.*\/|))(?:[^\/\\]*\.\w+|\w*)$/;if(!document.location.pathname.search(b)){var c=b.exec(document.location.pathname);return c[1]+a}return "/"+a}function OutputEncoder_AsNumeric(a){if(a==null)return "";if(isNaN(parseFloat(a)))throw"IOSec.AsNumeric(): Error input ["+a+"] not a valid number.";return a}function OutputEncode_TruncateUrlSafe(a,b,e){if(a.length<=b)return a;var d="";if(e&&e.length>0){d=OutputEncoder_EncodeUrl(e);b-=d.length}a=a.substring(0,b);for(var c=1;c<6;c++)if(a.charAt(b-c)=="%"){a=a.substring(0,b-c);break}return a+d}function OutputEncode_EncodeUrlDelims(f,c){if(!f)return c;var a,h,b="";for(var d=0;d<c.length;d++){a=c.charCodeAt(d);if(37==a){b=b+"%"+OutputEncoder_SingleByteHex(a);continue}var e=c.charAt(d);for(var g=0;g<f.length;g++){h=f.charCodeAt(g);if(h==a){if(a>127)e="%u"+OutputEncoder_TwoByteHex(a);else e="%"+OutputEncoder_SingleByteHex(a);break}}b+=e}return b}function OutputEncoder_EncodeUrl(c){if(c==null)return "";var a,b="";for(var d=0;d<c.length;d++){a=c.charCodeAt(d);if(a>96&&a<123||a>64&&a<91||a>47&&a<58||a==46||a==45||a==95)b=b+String.fromCharCode(a);else if(a>127)b=b+"%u"+OutputEncoder_TwoByteHex(a);else b=b+"%"+OutputEncoder_SingleByteHex(a)}return b}function OutputEncoder_SingleByteHex(b){if(b==null)return "";var a=b.toString(16);for(var c=a.length;c<2;c++)a="0"+a;return a}function OutputEncoder_TwoByteHex(b){if(b==null)return "";var a=b.toString(16);for(var c=a.length;c<4;c++)a="0"+a;return a}function OutputEncoder(){this.EncodeHtml=OutputEncoder_EncodeHtml;this.EncodeHtmlAttribute=OutputEncoder_EncodeHtmlAttribute;this.EncodeXml=OutputEncoder_EncodeXml;this.EncodeXmlAttribute=OutputEncoder_EncodeXmlAttribute;this.EncodeJs=OutputEncoder_EncodeJs;this.EncodeVbs=OutputEncoder_EncodeVbs;this.AsNumeric=OutputEncoder_AsNumeric;this.EncodeUrl=OutputEncoder_EncodeUrl;this.EncodeUrlDelims=OutputEncode_EncodeUrlDelims;this.TruncateUrlSafe=OutputEncode_TruncateUrlSafe;this.SingleByteHex=OutputEncoder_SingleByteHex;this.TwoByteHex=OutputEncoder_TwoByteHex;this.AsUrl=OutputEncoder_AsUrl;this.QualifyUrl=OutputEncoder_QualifyUrl;this.EncodeUrlUTF8=OutputEncoder_URLEncodeUTF8}var IOSec=new OutputEncoder;function VE_Panel(b,l,m,j,h,d,c,i,k,g,n,f,e){this.index=0;this.x=l;this.y=m;this.width=j;this.height=h;this.dynamicHeightMax=250;this.color=d;this.toolbarHeight=20;this.footerHeight=20;this.min=false;this.visible=true;this.onTitleClick=null;this.onCloseClick=null;this.onMaximize=null;this.onMinimize=null;var a=VE_Panel._CreateElement("div",b,"VE_Panel_el",c);this.el=a;this.titleDisabled=false;this.title=document.createElement("a");this.title.id=b+"_title";this.title.className="VE_Panel_title";this.title.appendChild(document.createElement("h1"));this.title.onclick=function(a){VE_Panel._OnTitleClick(a);return false};this.title.href="#";a.appendChild(this.title);this.SetTitle(i);this.closeboxDisabled=false;this.cb=VE_Panel._CreateElement("a",b+"_cb","VE_Panel_cb VE_Panel_cb_"+d,c+1);this.cb.onclick=function(a){VE_Panel._OnCloseClick(a);return false};this.cb.href="#";this.cb.unselectable="on";a.appendChild(this.cb);this.tb=VE_Panel._CreateElement("div",b+"_tb","VE_Panel_tb VE_Panel_tb_"+d,c+1);this.tb.unselectable="on";a.appendChild(this.tb);this.body=VE_Panel._CreateElement("div",b+"_body","VE_Panel_body",c+1);this.body.innerHTML=k;a.appendChild(this.body);this.foot=VE_Panel._CreateElement("div",b+"_foot","VE_Panel_foot VE_Panel_foot_"+d,c+1);this.foot.innerHTML=g;this.foot.unselectable="on";a.appendChild(this.foot);if(!f)this.SetOpacity(90);VE_Panel.panels.push(this);if(!e)e=document.body;e.appendChild(a)}VE_Panel.panels=[];VE_Panel.shadowThickness=3;VE_Panel._CreateElement=function(d,e,b,c){var a=document.createElement(d);a.id=e;a.className=b;a.style.zIndex=c;return a};VE_Panel._PositionElement=function(a,d,e,c,b){a.style.top=e+"px";a.style.left=d+"px";a.style.width=c+"px";a.style.height=b+"px"};VE_Panel.prototype.SetPosition=function(c,d,b,a){this.x=c;this.y=d;this.width=b;this.height=a;if(this.el.shimElement&&map.IsModeEnabled(Msn.VE.MapActionMode.Mode3D))UpdateIFrameShim(this.el)};VE_Panel.prototype.SetToolbarSize=function(toolbarHeight){this.toolbarHeight=toolbarHeight;var d=eval(toolbarHeight)>0?"block":"none";this.tb.style.display=d;this.Resize()};VE_Panel.prototype.SetFooterSize=function(footerHeight){this.footerHeight=footerHeight;var d=eval(footerHeight)>0?"block":"none";this.foot.style.display=d;this.Resize()};VE_Panel.prototype.Resize=function(){if(typeof header=="undefined"||header=="undefined"||header==null||typeof footer=="undefined"||footer=="undefined"||footer==null)return;var taskAreaHeight=document.body.clientHeight-(scopingBar_separator.offsetTop+scopingBar_separator.offsetHeight)-footer.offsetHeight;if(document.all){var css=footer.currentStyle;if(css&&typeof css!="undefined"){var strBottom=css["bottom"];if(strBottom&&typeof strBottom!="undefined"){var nBottom=Math.abs(parseInt(strBottom));taskAreaHeight+=nBottom}}}if(taskAreaHeight>=0&&typeof taskAreaHeight=="number"){taskArea_transparency.style.height=taskAreaHeight+"px";taskArea_positioner.style.height=taskAreaHeight+"px"}if(this.el.id=="contextMenu"||this.el.id=="scratchpad"||this.el.id=="annotationPanel"||this.el.id=="annotationPopup"||this.el.id=="searchPopup"||this.el.id=="help"){if(this.height!="auto"&&typeof this.height=="number")this.el.style.height=eval(this.height)+"px";if(this.width!="auto"&&typeof this.width=="number")this.el.style.width=eval(this.width)+"px";if(this.x!="auto"&&typeof this.x=="number")this.el.style.left=eval(this.x)+"px";if(this.y!="auto"&&typeof this.y=="number")this.el.style.top=eval(this.y)+"px"}else{var count=taskArea.getCount(),titleMargin=3,titleHeight=this.title.offsetHeight+titleMargin,bodyHeight=taskArea_transparency.offsetHeight-titleHeight*count-this.tb.offsetHeight-this.foot.offsetHeight;if(bodyHeight>=0&&typeof bodyHeight=="number")this.body.style.height=bodyHeight+"px"}if(this.el.shimElement)ShowShim(this.el)};VE_Panel.prototype.SetHeightToFit=function(){var contentid=this.id+"_body_table",content=$ID(contentid);if(!content)return false;this.height=0;var width=Math.max(eval(this.width),100);if(content.offsetWidth>width-14)this.height+=scrollbarWidth;this.height+=this.titleDisabled?14:21+14;this.height+=this.toolbarHeight;this.height+=content.offsetHeight;this.height+=this.footerHeight;this.height=Math.min(this.dynamicHeightMax,this.height)};VE_Panel.prototype.DisableClosebox=function(){if(this.closeboxDisabled)return;this.closeboxDisabled=true;this.el.removeChild(this.cb)};VE_Panel.prototype.EnableClosebox=function(){if(!this.closeboxDisabled)return;this.closeboxDisabled=false;this.el.insertBefore(this.cb,this.tb)};VE_Panel.prototype.DisableTitle=function(){if(this.titleDisabled)return;this.titleDisabled=true;this.el.removeChild(this.cb);this.el.removeChild(this.title)};VE_Panel.prototype.EnableTitle=function(){if(!this.titleDisabled)return;this.titleDisabled=false;this.el.insertBefore(this.cb,this.tb);this.el.insertBefore(this.title,this.cb)};VE_Panel.prototype.SetTitle=function(c){var b=document.createTextNode(c),a=this.title.firstChild;if(a)if(a.firstChild)a.replaceChild(b,a.firstChild);else a.appendChild(b)};VE_Panel.prototype.SetToolbar=function(a){this.tb.innerHTML=a};VE_Panel.prototype.SetBody=function(a){this.body.innerHTML=a};VE_Panel.prototype.SetDynamicBody=function(a){this.body.innerHTML='<table id="'+this.id+'_body_table"><tr><td>'+a+"</td></tr></table>"};VE_Panel.prototype.SetFooter=function(a){this.foot.innerHTML=a};VE_Panel.prototype.SetOpacity=function(o){if(o>=100)o=99.99;with(this.el.style){filter="alpha(opacity:"+o+")";o*=0.01;KHTMLOpacity=o;MozOpacity=o;opacity=o}};VE_Panel.prototype.SetColor=function(a){this.color=a;this.title.className="VE_Panel_title VE_Panel_title_"+a;this.foot.className="VE_Panel_foot VE_Panel_foot_"+a;this.cb.className="VE_Panel_cb VE_Panel_cb_"+a};VE_Panel.prototype.Minimize=function(){this.el.className=" VE_Panel_el_minimized";if(this.onMinimize)this.onMinimize(this._CreateEvent())};VE_Panel.prototype.Maximize=function(){this.el.className="VE_Panel_el";if(this.onMaximize)this.onMaximize(this._CreateEvent());this.Resize()};VE_Panel.prototype.isMaximized=function(){return this.el.className=="VE_Panel_el"};VE_Panel.prototype.Show=function(){this.el.style.display="block";this.visible=true;mvcViewFacade.ShowShimIfSupported(this.el)};VE_Panel.prototype.Hide=function(){this.el.style.display="none";this.visible=false;if(typeof view3DMode!="undefined")HideShim(this.el)};VE_Panel.prototype.Destroy=function(){this.el.parentNode.removeChild(this.el);var b=VE_Panel.panels;for(var a=0;a<b.length;a++)if(b[a]==this){b.splice(a,1);return}this.onTitleClick=null;this.onCloseClick=null;this.onMaximize=null};function VE_PanelEvent(a){this.srcPanel=a}VE_Panel.prototype._CreateEvent=function(){return new VE_PanelEvent(this)};VE_Panel._OnTitleClick=function(c){if(!c)c=window.event;var d=GetTarget(c),b=VE_Panel.panels;for(var a=0;a<b.length;a++)if(b[a].title==d||b[a].title==d.parentNode){if(b[a].onTitleClick)b[a].onTitleClick(b[a]._CreateEvent());return}};VE_Panel._OnCloseClick=function(c){if(!c)c=window.event;var d=GetTarget(c),b=VE_Panel.panels;for(var a=0;a<b.length;a++)if(b[a].cb==d){if(b[a].onCloseClick)b[a].onCloseClick(b[a]._CreateEvent());return}};function VE_SearchResult(s,q,f,p,o,r,i,g,l,b,h,k,d,a,e,m,n,j){this.id=s;this.name=q;this.description=f;this.phone=p;this.rating=o;this.type=r;this.latitude=i;this.longitude=g;this.pushPin=null;this.pinId=null;this.keywords=h;this.infoUrl=l;this.photoUrl=typeof b!="undefined"?b:"";this.country=k;var c=null;this.SetGeoRef=function(a){c=a};this.GetGeoRef=function(){return c};this.insideBoundingBox=d;a=a;this.GetDistanceFromCenter=function(b,c){if(typeof a=="number"&&Msn.VE.DistanceUnit.IsValidType(b))if(b=="mi"){if(a.toFixed)return c?a.toFixed(1)+l491eLt:a.toFixed(1)}else if(b=="km")if(a.toFixed)return c?(a*1.609344).toFixed(1)+l937eMt:(a*1.609344).toFixed(1)};this.highlighted=e;this.roofLatitude=m;this.roofLongitude=n;this.brandid=j}function VE_WebSearchResult(h,g,i,j,k){var c=a(h),d=a(g),e=a(i),b=a(j),f=a(k);this.GetCaptionUrl=function(){return c};this.SetCaptionUrl=function(b){c=a(b)};this.GetDescription=function(){return d};this.SetDescription=function(b){d=a(b)};this.GetDisplayUrl=function(){return e};this.SetDisplayUrl=function(b){e=a(b)};this.GetTitle=function(){return b};this.SetTitle=function(c){b=a(c)};this.GetUrl=function(){return f};this.SetUrl=function(b){f=a(b)};function a(a){if(typeof a=="string"&&a.length>=0)return a;return null}}VE_SearchResult.prototype.Equals=function(a){if(a==null||a=="undefined")return false;try{var b=this.name==a.name&&this.description==a.description&&this.phone==a.phone&&this.rating==a.rating&&this.type==a.type&&this.latitude==a.latitude&&this.longitude==a.longitude;return b}catch(c){return false}};VE_WebSearchResult.prototype.Equals=function(a){if(a instanceof VE_WebSearchResult){var b=this.GetCaptionUrl()==a.GetCaptionUrl()&&this.GetDescription()==a.GetDescription()&&this.GetTitle()==a.GetTitle()&&this.GetDisplayUrl()==a.GetDisplayUrl()&&this.GetUrl()==a.GetUrl();return b}return false};VE_SearchResult.prototype.GetSerializedId=function(){switch(this.type){case "al":return "";case "adr":return "adr"+"."+this.name;case "aN":return VE_AnnotationData.SerializeAnnotation(this.pinId);default:return this.type+"."+this.id.toString()}};function VE_SearchResultCategory(b,a){this.id=b;this.name=a;this.IsValid=function(){return typeof parseInt(b)=="number"&&typeof a=="string"&&a.length>0};this.Destroy=function(){this.id=null;this.name=null}}function Ad(h,j,a,e,b,c,d,i,g,f,k){this.title=h;this.url=j;this.description=a;this.latitude=e;this.longitude=b;this.address1=c;this.address2=d;this.city=i;this.state=g;this.country=f;this.zip=k}Ad.prototype.ToHtml=function(){var a="<li>"+'<a href = "'+this.url+'" target = "_blank">'+IOSec.EncodeHtml(this.title)+"</a>"+"$AdDescription$"+"</li>";if(this.description&&this.description.length>0)a=a.replace("$AdDescription$","<p>"+IOSec.EncodeHtml(this.description)+"</p>");return a};Ad.prototype.HasAddress=function(){return this.address1.length>0&&this.city.length>0&&this.state.length>0&&this.zip.length>0};Ad.prototype.GetAdDescription=function(){var a=this.description;if(this.HasAddress())a=this.address1+", "+this.city+", "+this.state+" "+this.zip;return a};Msn.VE.DirectionsDecoder=function(){var b=4,c=1000000;function d(a,c,m,l){if(!a||a.length<c)return [];var k=a.length-a.length%c,i=[],f=false,b=0,j=c-1;for(var d=0;d<k;d++){var e=a.charCodeAt(d),h=d%c;if(l&&h==0){f=e&128;e&=127}b|=e;if(h==j){var g=b/m;i.push(f?-g:g);b=0;f=false}else b<<=8}return i}function a(a){return d(a,b,c,true)}this.DecodeCoordinatesString=a};RegisterNamespaces("Msn.Drawing");MC_PointID=10000;MC_PolylineID=30000;MC_PolygonID=50000;MC_SYMBOL_IID=70000;MC_TEXT_IID=90000;MC_ENTITY_IID=200000;MC_COL_IID=1000;MC_GEO_TYPE_SYMBOL="Symbol";MC_GEO_TYPE_POINT="Point";MC_GEO_TYPE_POLYLINE="Polyline";MC_GEO_TYPE_POLYGON="Polygon";MC_GEO_TYPE_TEXT="Text";MC_GEO_TYPE_COL="Collection";MC_GEO_TYPE_ENTITY="Entity";Msn.Drawing.GetGeoUID=function(b){var a="";switch(b){case MC_GEO_TYPE_POLYGON:a=MC_PolygonID++;break;case MC_GEO_TYPE_POINT:a=MC_PointID++;break;case MC_GEO_TYPE_POLYLINE:a=MC_PolylineID++;break;case MC_GEO_TYPE_SYMBOL:a=MC_SYMBOL_IID++;break;case MC_GEO_TYPE_TEXT:a=MC_TEXT_IID++;break;case MC_GEO_TYPE_COL:a=MC_COL_IID++;break;case MC_GEO_TYPE_ENTITY:a=MC_ENTITY_IID++;break}return a.toString()};Msn.Drawing.Exception=function(a){this.message=a;this.name="Msn.Drawing.Exception"};Msn.Drawing.Exception.prototype.toString=function(){return this.name+": "+this.message};Msn.Drawing.Point=function(a,b){this.id=0;this.points=[];this.points.push(a);this.points.push(b);this.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_POINT)};Msn.Drawing.Point.prototype.type=MC_GEO_TYPE_POINT;Msn.Drawing.Point.prototype.name=null;Msn.Drawing.Point.prototype.symbol=null;Msn.Drawing.Point.prototype.isLabel=false;Msn.Drawing.Point.prototype.isOnLegend=false;Msn.Drawing.Point.prototype.Destroy=function(){this.symbol=null;this.points=null};Msn.Drawing.Point.prototype.toString=function(){return this.points[0]+","+this.points[1]};Msn.Drawing.PolyLine=function(a){this.id=0;this.points=a?a:[]};Msn.Drawing.PolyLine.prototype.toString=function(){if(this.points!=null)return this.points.join(" ");else return ""};Msn.Drawing.PolyLine.prototype.minX=null;Msn.Drawing.PolyLine.prototype.minY=null;Msn.Drawing.PolyLine.prototype.maxX=null;Msn.Drawing.PolyLine.prototype.maxY=null;Msn.Drawing.PolyLine.prototype.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_POLYLINE);Msn.Drawing.PolyLine.prototype.labelPosX=null;Msn.Drawing.PolyLine.prototype.labelPosY=null;Msn.Drawing.PolyLine.prototype.name=null;Msn.Drawing.PolyLine.prototype.type=MC_GEO_TYPE_POLYLINE;Msn.Drawing.PolyLine.prototype.symbol=null;Msn.Drawing.PolyLine.prototype.isLabel=false;Msn.Drawing.PolyLine.prototype.isOnLegend=false;Msn.Drawing.PolyLine.prototype.Destroy=function(){this.symbol=null;this.points=null;this.minX=null;this.minY=null;this.maxX=null;this.maxY=null};Msn.Drawing.Polygon=function(a){this.id=0;this.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_POLYGON);this.points=a;this.minX=null;this.minY=null;this.maxX=null;this.maxY=null;return this};Msn.Drawing.Polygon.prototype.labelPosX=null;Msn.Drawing.Polygon.prototype.labelPosY=null;Msn.Drawing.Polygon.prototype.symbol=null;Msn.Drawing.Polygon.prototype.isLabel=false;Msn.Drawing.Polygon.prototype.isOnLegend=false;Msn.Drawing.Polygon.prototype.type=MC_GEO_TYPE_POLYGON;Msn.Drawing.Polygon.prototype.name=null;Msn.Drawing.Polygon.prototype.Destroy=function(){this.symbol=null;this.points=null;this.minX=null;this.minY=null;this.maxX=null;this.maxY=null};Msn.Drawing.Stroke=function(){this.width=1;this.linecap="round";this.opacity=1;this.linejoin="miter";this.color=new Msn.Drawing.Color(255,255,255,1);this.fillcolor=new Msn.Drawing.Color(0,255,0,1)};Msn.Drawing.Color=function(d,c,b,a){this.R=d?d:0;this.G=c?c:0;this.B=b?b:0;this.A=a?a:1;this.ToHexString=function(){return "#"+Number(this.R).toString(16)+(this.R<16?"0":"")+Number(this.G).toString(16)+(this.G<16?"0":"")+Number(this.B).toString(16)+(this.B<16?"0":"")}};Msn.Drawing.MapSymbol=function(){this.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_SYMBOL);this.id=this.iid};Msn.Drawing.MapSymbol.prototype.point_type="v:rect";Msn.Drawing.MapSymbol.prototype.name="symbol";Msn.Drawing.MapSymbol.prototype.highlight_stroke_color="#336666";Msn.Drawing.MapSymbol.prototype.highlight_fill_color="#FFCC33";Msn.Drawing.MapSymbol.prototype.shape_drawtype="v:shape";Msn.Drawing.MapSymbol.prototype.shape_fill="false";Msn.Drawing.MapSymbol.prototype.shape_filled="false";Msn.Drawing.MapSymbol.prototype.shape_unselectable="off";Msn.Drawing.MapSymbol.prototype.style_zIndex=60;Msn.Drawing.MapSymbol.prototype.style_position="absolute";Msn.Drawing.MapSymbol.prototype.style_filter="alpha(opacity=30)";Msn.Drawing.MapSymbol.prototype.style_width="10";Msn.Drawing.MapSymbol.prototype.style_height="10";Msn.Drawing.MapSymbol.prototype.style_visibility="visible";Msn.Drawing.MapSymbol.prototype.style_display="block";Msn.Drawing.MapSymbol.prototype.stroke_drawtype="v:stroke";Msn.Drawing.MapSymbol.prototype.stroke_on="true";Msn.Drawing.MapSymbol.prototype.stroke_joinstyle="miter";Msn.Drawing.MapSymbol.prototype.stroke_endcap="round";Msn.Drawing.MapSymbol.prototype.stroke_opacity="100%";Msn.Drawing.MapSymbol.prototype.stroke_color="#0000FF";Msn.Drawing.MapSymbol.prototype.stroke_weight="2pt";Msn.Drawing.MapSymbol.prototype.stroke_style="Single";Msn.Drawing.MapSymbol.prototype.stroke_filltype="solid";Msn.Drawing.MapSymbol.prototype.stroke_color2="red";Msn.Drawing.MapSymbol.prototype.stroke_dashstyle="Solid";Msn.Drawing.MapSymbol.prototype.stroke_startarrow="none";Msn.Drawing.MapSymbol.prototype.stroke_startarrowwidth="medium";Msn.Drawing.MapSymbol.prototype.stroke_startarrowlength="medium";Msn.Drawing.MapSymbol.prototype.stroke_endarrow="none";Msn.Drawing.MapSymbol.prototype.stroke_endarrowwidth="medium";Msn.Drawing.MapSymbol.prototype.stroke_endarrowlength="medium";Msn.Drawing.MapSymbol.prototype.fill_drawtype="v:fill";Msn.Drawing.MapSymbol.prototype.fill_color="#008000";Msn.Drawing.MapSymbol.prototype.fill_colors="30% yellow";Msn.Drawing.MapSymbol.prototype.fill_color2="blue";Msn.Drawing.MapSymbol.prototype.fill_type="solid";Msn.Drawing.MapSymbol.prototype.fill_opacity="30%";Msn.Drawing.MapSymbol.prototype.fill_on="false";Msn.Drawing.MapSymbol.prototype.textbox_drawtype="v:textbox";Msn.Drawing.MapSymbol.prototype.textbox_text="name";Msn.Drawing.MapSymbol.prototype.textbox_color="black";Msn.Drawing.MapSymbol.prototype.textbox_bold=false;Msn.Drawing.MapSymbol.prototype.textbox_italic=false;Msn.Drawing.MapSymbol.prototype.textbox_underscore=false;Msn.Drawing.MapSymbol.prototype.imagedata_on=false;Msn.Drawing.MapSymbol.prototype.imagedata_src="http://i2.microsoft.com/h/en-us/i/msnlogo.gif";Msn.Drawing.MapSymbol.prototype.Clone=function(){var a=new Msn.Drawing.MapSymbol;a.point_type=this.point_type;a.name=this.name;a.line_color=this.line_color;a.line_width=this.line_width;a.line_dasharray=this.line_dasharray;a.highlight_stroke_color=this.highlight_stroke_color;a.highlight_fill_color=this.highlight_fill_color;a.shape_drawtype=this.shape_drawtype;a.shape_fill=this.shape_fill;a.shape_filled=this.shape_filled;a.shape_unselectable=this.shape_unselectable;a.style_zIndex=this.style_zIndex;a.style_position=this.style_position;a.style_filter=this.style_filter;a.style_width=this.style_width;a.style_height=this.style_height;a.style_visibility=this.style_visibility;a.style_display=this.style_display;a.stroke_drawtype=this.stroke_drawtype;a.stroke_on=this.stroke_on;a.stroke_joinstyle=this.stroke_joinstyle;a.stroke_endcap=this.stroke_endcap;a.stroke_opacity=this.stroke_opacity;a.stroke_color=this.stroke_color;a.stroke_weight=this.stroke_weight;a.stroke_style=this.stroke_style;a.stroke_filltype=this.stroke_filltype;a.stroke_color2=this.stroke_color2;a.stroke_dashstyle=this.stroke_dashstyle;a.stroke_startarrow=this.stroke_startarrow;a.stroke_startarrowwidth=this.stroke_startarrowwidth;a.stroke_startarrowlength=this.stroke_startarrowlength;a.stroke_endarrow=this.stroke_endarrow;a.stroke_endarrowwidth=this.stroke_endarrowwidth;a.stroke_endarrowlength=this.stroke_endarrowlength;a.fill_drawtype=this.fill_drawtype;a.fill_color=this.fill_color;a.fill_colors=this.fill_colors;a.fill_color2=this.fill_color2;a.fill_type=this.fill_type;a.fill_opacity=this.fill_opacity;a.fill_on=this.fill_on;a.textbox_drawtype=this.textbox_drawtype;a.textbox_text=this.textbox_text;a.textbox_color=this.textbox_color;a.textbox_bold=this.textbox_bold;a.textbox_italic=this.textbox_italic;a.textbox_underscore=this.textbox_underscore;a.imagedata_on=this.imagedata_on;a.imagedata_src=this.imagedata_src;return a};function VE_MapLineClip(){var b=-360,c=360,d=-180,e=180,a={LEFT:1,RIGHT:2,BOTTOM:4,TOP:8};function h(i,s,u,t,v){b=s;c=t;d=u;e=v;if(typeof i=="undefined"||i==null||i.length<4)return null;var m=false,o=i.length;if(i[o-2]==i[0]&&i[o-1]==i[1])m=true;var f=[];for(var l=0;l<i.length;l++)f.push(i[l]);var k=a.LEFT;while(k<=8){var q=f[f.length-2],r=f[f.length-1];f.push(q);f.push(r);var h=[],p=f.length;for(var j=0;j<p-2;j=j+2)g(h,k,f[j],f[j+1],f[j+2],f[j+3]);if(m){var n=h.length;if(h[n-2]!=h[0]||h[n-1]!=h[1]){h.push(h[0]);h.push(h[1])}}f=null;k=k*2;f=h}return f}function g(g,j,h,i,k,l){var n=f(h,i),o=f(k,l);if((j&n)==0&&(j&o)==0){g.push(h);g.push(i)}else if((j&n)==0||(j&o)==0){var m=(j&n)==0?true:false;if(j==a.LEFT){var q=i+(l-i)*(b-h)/(k-h);if(m){g.push(h);g.push(i)}g.push(b);g.push(q)}else if(j==a.RIGHT){q=i+(l-i)*(c-h)/(k-h);if(m){g.push(h);g.push(i)}g.push(c);g.push(q)}else if(j==a.TOP){var p=h+(k-h)*(e-i)/(l-i);if(m){g.push(h);g.push(i)}g.push(p);g.push(e)}else if(j==a.BOTTOM){p=h+(k-h)*(d-i)/(l-i);if(m){g.push(h);g.push(i)}g.push(p);g.push(d)}};}function f(g,h){var f=0;if(g<b)f=f|a.LEFT;else if(g>c)f=f|a.RIGHT;if(h<d)f=f|a.BOTTOM;else if(h>e)f=f|a.TOP;return f}this.Clip=h}VE_LineClip=new VE_MapLineClip;L_GraphicsInitError_Text="Your Web browser does not support SVG or VML. Some graphics features may not function properly.";RegisterNamespaces("Msn.Drawing");Msn.Drawing.Graphic=function(){};Msn.Drawing.Graphic.CreateGraphic=function(f,b){if(document.all)return new Msn.Drawing.VMLGraphic(f,b);else{var c=0,e=0,g=new RegExp("Firefox/(.*)"),d=g.exec(navigator.userAgent);if(d[1]){var a=d[1].split(".");if(a){c=a[0];e=a[1];if(parseInt(c)>0&&parseInt(e)>=5)return new Msn.Drawing.SVGGraphic(f,b)}}throw new Msn.Drawing.Exception(L_GraphicsInitError_Text)}};Msn.Drawing.BaseGraphic=function(){this._stroke=new Msn.Drawing.Stroke};Msn.Drawing.BaseGraphic.prototype.CreatePrimitive=function(){};Msn.Drawing.BaseGraphic.prototype.DrawPrimitive=function(d,c,a){var b=new Msn.Drawing.MapSymbol;if(a._stroke){b.stroke_weight=a._stroke.width;b.joinstyle=a._stroke.linejoin;b.stroke_color=a._stroke.color.ToHexString();b.stroke_dashstyle=a._stroke.linecap;b.stroke_opacity=a._stroke.color.A.toString();b.fill_color=a._stroke.fillcolor.ToHexString();b.fill_opacity=a._stroke.fillcolor.A.toString()}c.symbol=b;var e=a.CreatePrimitive(d,c,"");return e};Msn.Drawing.BaseGraphic.prototype.SetStroke=function(a){this._stroke=a};Msn.Drawing.VMLGraphic=function(c,d){Msn.Drawing.BaseGraphic.call();var g=new Msn.Drawing.Color(255,0,0,1),f=new Msn.Drawing.Color(255,0,0,1),e=1,a=c;c.unselectable="on";var b=[];this.DrawPrimitive=function(e){var c=Msn.Drawing.VMLGraphic.prototype.DrawPrimitive(d,e,this);if(a&&c){a.appendChild(c);b.push(c)}};this.resetOffset=function(){};this.SetZIndex=function(a){e=a};this.Clear=function(){var a=null,c=null;while(a=b.pop()){c=a.parentElement;if(c)c.removeChild(a);a=null}};this.Destroy=function(){this.Clear();a=null}};Msn.Drawing.VMLGraphic.prototype=new Msn.Drawing.BaseGraphic;Msn.Drawing.VMLGraphic.prototype.CreatePrimitive=function(d,a){var b=null;if(a.type==MC_GEO_TYPE_POINT){if(a.symbol.shape_drawtype=="v:oval"||a.symbol.shape_drawtype=="v:rect"||a.symbol.shape_drawtype=="v:roundrect")b=document.createElement(a.symbol.shape_drawtype);else b=document.createElement("v:roundrect");var f=LatLongtoRoundedPixel(d,a.points[1],a.points[0]);b.style.width=a.symbol.style_width;b.style.height=a.symbol.style_height;b.style.left=-5+f.x+d.GetOffsetX()+"px";b.style.top=-5+f.y+d.GetOffsetY()+"px";b.style.position=a.symbol.style_position}else{b=document.createElement("v:shape");var g=null;g=GetVmlPath(d,a);var h=d.GetMapWidth(),i=d.GetMapHeight();b.style.top=d.GetOffsetY()+"px";b.style.left=d.GetOffsetX()+"px";b.style.width=h+"px";b.style.height=i+"px";b.coordsize=h+" "+i;b.style.position=a.symbol.style_position;b.path=g}b.id=a.id!=0?a.id:a.iid;b.style.zIndex=a.symbol.style_zIndex;b.unselectable=a.symbol.shape_unselectable;var c=document.createElement("v:stroke");c.joinstyle=a.symbol.stroke_joinstyle;c.endcap=a.symbol.stroke_endcap;c.opacity=a.symbol.stroke_opacity;c.dashstyle=a.symbol.stroke_dashstyle;c.filltype=a.symbol.stroke_filltype;c.color2=a.symbol.stroke_color2;c.color=a.symbol.stroke_color;c.weight=a.symbol.stroke_weight;c.linestyle=a.symbol.stroke_style;if(a.type==MC_GEO_TYPE_POLYGON){var e=document.createElement("v:fill");e.color=a.symbol.fill_color;e.colors=a.symbol.fill_colors;e.color2=a.symbol.fill_color2;e.type=a.symbol.fill_type;e.opacity=a.symbol.fill_opacity;b.appendChild(e)}else if(a.type==MC_GEO_TYPE_POLYLINE){b.fill=false;b.filled=false}else if(a.type==MC_GEO_TYPE_POINT){b.style.filter=a.symbol.style_filter;b.style.zIndex=a.symbol.style_zIndex;b.style.display=a.symbol.style_display;b.unselectable=a.symbol.shape_unselectable;b.fill=true;b.filled=true;b.fillcolor=a.symbol.fill_color}b.appendChild(c);return b};Msn.Drawing.SVGGraphic=function(c,b){Msn.Drawing.BaseGraphic.call();var g=new Msn.Drawing.Color(255,0,0,1),f=new Msn.Drawing.Color(0,255,0,1);_curmap=b;this._svgLayer=null;var d=60,e=c,a=[];this.DrawPrimitive=function(d){var c=Msn.Drawing.SVGGraphic.prototype.DrawPrimitive(b,d,this);if(c)a.push(c)};this.resetOffset=function(){_curmap.resetSvgLayer()};this.SetZIndex=function(a){d=a;if(this._svgLayer!=null)this._svgLayer.SetZIndex(a)};this.Destroy=function(){this.Clear()};this.Clear=function(){if(this._svgLayer==null)return;var b=null,c=null;while(b=a.pop()){c=b.parentNode;if(c)c.removeChild(b);b=null}}};Msn.Drawing.SVGGraphic.prototype=new Msn.Drawing.BaseGraphic;Msn.Drawing.SVGGraphic.prototype.CreatePrimitive=function(a,b,c){this._svgLayer=a.getSvgLayer();return this._svgLayer.addShape(b,c)};Msn.Drawing.SvgLayer=function(e,f){var c=f,b=null,d=false,g=false;if(d==false){d=true;b=document.createElementNS("http://www.w3.org/2000/svg","svg");b.setAttribute("height","100%");b.setAttribute("width","100%");e.appendChild(b);this.lineDashStyles=[];var a=this.lineDashStyles;a[0]=new Array("Solid","none");a[1]=new Array("ShortDash","6,2");a[2]=new Array("ShortDot","2,2");a[3]=new Array("ShortDashDot","6,2,2,2");a[4]=new Array("ShortDashDotDot","6,2,2,2,2,2");a[5]=new Array("Dot","2,6");a[6]=new Array("Dash","10,6");a[7]=new Array("LongDash","20,6");a[8]=new Array("DashDot","10,6,2,6");a[9]=new Array("LongDashDot","20,6,2,6");a[10]=new Array("LongDashDotDot","20,6,2,6,2,6")}this.addShape=function(d){if(b==null)return;var a=null;if(d.type==MC_GEO_TYPE_POINT){a=document.createElementNS("http://www.w3.org/2000/svg","rect");var h=LatLongtoRoundedPixel(c,d.points[1],d.points[0]);a.setAttribute("x",h.x-6);a.setAttribute("y",h.y-6);a.setAttribute("width","6pt");a.setAttribute("height","6pt");a.setAttribute("stroke-width",d.symbol.stroke_weight);a.setAttribute("stroke",d.symbol.stroke_color);a.setAttribute("fill",d.symbol.fill_color);b.appendChild(a)}else if(d.type==MC_GEO_TYPE_POLYLINE||d.type==MC_GEO_TYPE_POLYGON){a=document.createElementNS("http://www.w3.org/2000/svg","polyline");a.setAttribute("points",GetSvgPath(c,d.points));a.setAttribute("stroke",d.symbol.stroke_color);a.setAttribute("stroke-width",d.symbol.stroke_weight);var g=this.lineDashStyles;for(var f=0;f<g.length;f++)if(d.symbol.stroke_dashstyle==g[f][0])a.setAttribute("stroke-dasharray",g[f][1]);if(d.type==MC_GEO_TYPE_POLYLINE)a.setAttribute("fill","none");else{a.setAttribute("fill",d.symbol.fill_color);var e=d.symbol.fill_opacity;if(e.indexOf("%")>1){e=parseInt(d.symbol.fill_opacity);if(e==NaN)e=0.3;else e/=100}a.setAttribute("fill-opacity",e)}}if(a){a.setAttribute("id",d.id!=0?d.id:d.iid);b.appendChild(a)}return a};this.SetZIndex=function(a){if(!c.bShowSVG)return;c.GetsvgDiv().style.zIndex=a}};function GetSvgPath(f,c){var b="",a=0,d=c.length/2,g=0;while(a<d){var e=LatLongtoRoundedPixel(f,c[a*2+1],c[a*2]);b=b.concat(e.x,",",e.y);a++;if(a<d)b+=","}return b}function LatLongtoRoundedPixel(b,d,e){var c;if(typeof VEMap!="undefined"&&VEMap.prototype.isPrototypeOf(b))c=new VELatLong(d,e);else c=new Msn.VE.LatLong(d,e);var a=b.LatLongToPixel(c,b.GetZoomLevel());if(!a)return null;a.x=MathRound(a.x);a.y=MathRound(a.y);return a}function GetVmlPath(g,a){var c=a.points;if(!c)return null;var e="m ",b=0,h=c.length;if(h>=4){var d=LatLongtoRoundedPixel(g,c[b*2+1],c[b*2]);if(!d)return null;e=e.concat(d.x,",",d.y," ","l ");++b}var f=false;if(a.type!=MC_GEO_TYPE_POINT)if(a.minX==null||a.minY==null||a.maxX==null||a.maxY==null){f=false;a.minX=360;a.minY=360;a.maxX=-360;a.maxY=-360}else f=true;while(b<h/2){if(!f){a.minX=Math.min(a.minX,c[b*2]);a.minY=Math.min(a.minY,c[b*2+1]);a.maxX=Math.max(a.maxX,c[b*2]);a.maxY=Math.max(a.maxY,c[b*2+1]);}d=LatLongtoRoundedPixel(g,c[b*2+1],c[b*2]);if(!d)return null;e=e.concat(d.x,",",d.y," ");++b}e+=" e";return e}function GetCurrentMapViewBounds(b){var o=b.GetCenterLongitude(),p=b.GetCenterLatitude(),a=b.LatLongToPixel(new Msn.VE.LatLong(p,o)),h=b.GetMapWidth(),g=b.GetMapHeight();if(!a||isNaN(a.x)||isNaN(a.y))return new Msn.VE.Bounds(0,0,-Infinity,-Infinity,Infinity,Infinity);var l,n,k,m,j=false,q=b.GetMapStyle(),c=b.PixelToLatLong(new Msn.VE.Pixel(a.x-h/2,a.y+g/2)),d=b.PixelToLatLong(new Msn.VE.Pixel(a.x+h/2,a.y-g/2));if(q=="o"){var e=b.PixelToLatLong(new Msn.VE.Pixel(a.x-h/2,a.y-g/2)),f=b.PixelToLatLong(new Msn.VE.Pixel(a.x+h/2,a.y+g/2));if(c!=null&&d!=null&&e!=null&&f!=null){l=Math.min(c.longitude,d.longitude,e.longitude,f.longitude);n=Math.min(c.latitude,d.latitude,e.latitude,f.latitude);k=Math.max(c.longitude,d.longitude,e.longitude,f.longitude);m=Math.max(c.latitude,d.latitude,e.latitude,f.latitude)}else j=true}else if(c!=null&&d!=null){l=Math.min(c.longitude,d.longitude);n=Math.min(c.latitude,d.latitude);k=Math.max(c.longitude,d.longitude);m=Math.max(c.latitude,d.latitude)}else j=true;var i=null;if(j)i=new Msn.VE.Bounds(0,0,-Infinity,-Infinity,Infinity,Infinity);else i=new Msn.VE.Bounds(0,0,l,n,k,m);return i}function GetBufferedMapViewBounds(b,a){var c=null,e=Math.abs(a.x2-a.x1),d=Math.abs(a.y2-a.y1);c=new Msn.VE.Bounds(0,0,a.x1-b*e,a.y1-b*d,a.x2+b*e,a.y2+b*d);return c}function IsContainedInView(a,b){var c=false;if(b.x1>a.x1&&b.y1>a.y1&&b.x2<a.x2&&b.y2<a.y2)c=true;return c}Msn.Drawing.ComputeBoundingBox=function(a){if(typeof a=="undefined"||a==null||a.length==0)return null;var c=[],f=Infinity,g=Infinity,d=-Infinity,e=-Infinity;for(var b=0;b<a.length;b=b+2){f=Math.min(f,a[b]);g=Math.min(g,a[b+1]);d=Math.max(d,a[b]);e=Math.max(e,a[b+1]);}c[0]=f;c[1]=g;c[2]=d;c[3]=e;return c};function IsBoundsIntersect(a,b){if(a==null)return true;if(b==null)return true;if(a.x2<b.x1||a.x1>b.x2||a.y2<b.y1||a.y1>b.y2)return false;return true}function IsRecIntersect(c,d,a,b,g,h,e,f){if(a<g||c>e||b<h||d>f)return false;return true}var HelpHistory=[];function VE_Help(){}VE_Help.helpZIndex=31;VE_Help.introZIndex=31;VE_Help.introPanel=null;VE_Help.helpPanel=null;VE_Help.margins=110;VE_Help.LiveHelp=new function(){this.Keyword="keyword";this.Search="search";this.Topic="topic"};VE_Help.CreateHelpPanel=function(){var b='<iframe id="helpFrame" src="about:blank" width="100%" height="100%" allowtransparency="true" frameborder="0"></iframe>',a=new VE_Panel("help",220,160,windowWidth-430,windowHeight-220,"blue",VE_Help.helpZIndex,l141yt,b,"");a.body.className="VE_Panel_body_help";a.Hide();a.SetToolbarSize(0);a.SetFooterSize(0);a.SetOpacity(95);a.onCloseClick=function(){VE_Help.DisablePreventLayer();VE_Help.ClosePanel()};VE_Help.helpPanel=a};VE_Help.EnablePreventLayer=function(){var a=$ID("__preventLayer__");if(!a)a=document.createElement("div");a.id="__preventLayer__";a.className="preventLayer";document.body.appendChild(a)};VE_Help.DisablePreventLayer=function(){var a=$ID("__preventLayer__");if(a)document.body.removeChild(a)};VE_Help.EnableDrawingPreventLayer=function(){var e=$ID("msve_Header");if(e){var d=$ID("__preventLayerHeader__");if(!d)d=document.createElement("div");d.id="__preventLayerHeader__";d.className="preventLayer";d.style.left=e.clientLeft;d.style.top=e.clientTop;d.style.width=e.clientWidth;d.style.height=e.clientHeight;document.body.appendChild(d)}var f=$ID("msve_MapActionBar_Menu");if(e&&f){var a=$ID("__preventLayerActionBar__");if(!a)a=document.createElement("div");a.id="__preventLayerActionBar__";a.className="preventLayer";var i=findPosX(f);a.style.left=i;a.style.top=findPosY(f);a.style.width=f.clientWidth;a.style.height=f.clientHeight+6;document.body.appendChild(a);var h=$ID("msve_TaskArea_positioner");if(h&&i>0){var b=$ID("__preventLayerTaskArea__");if(!b)b=document.createElement("div");b.id="__preventLayerTaskArea__";b.className="preventLayer";b.style.left=0;b.style.top=a.style.top;b.style.width=a.style.left;b.style.height=h.clientHeight;document.body.appendChild(b)}}var g=$ID("msve_Footer");if(g){var c=$ID("__preventLayerFooter__");if(!c)c=document.createElement("div");c.id="__preventLayerFooter__";c.className="preventLayer";c.style.left=0;c.style.top=GetWindowHeight()-g.clientHeight;c.style.width=g.clientWidth;c.style.height=g.clientHeight;document.body.appendChild(c)}};VE_Help.DisableDrawingPreventLayer=function(){var d=$ID("__preventLayerHeader__");if(d)document.body.removeChild(d);var b=$ID("__preventLayerTaskArea__");if(b)document.body.removeChild(b);var a=$ID("__preventLayerActionBar__");if(a)document.body.removeChild(a);var c=$ID("__preventLayerFooter__");if(c)document.body.removeChild(c)};function findPosX(a){var b=0;if(a.offsetParent)while(a.offsetParent){b+=a.offsetLeft;a=a.offsetParent}else if(a.x)b+=a.x;return b}function findPosY(a){var b=0;if(a.offsetParent)while(a.offsetParent){b+=a.offsetTop;a=a.offsetParent}else if(a.y)b+=a.y;return b}VE_Help.CreateIntroPanel=function(){var b="";if(typeof window.welcomeUrl==undefined||window.welcomeUrl==""||window.welcomeUrl==null)b='<div class = "loading">'+l94fFt+"</div>";else b='<iframe id="introFrame" src='+window.welcomeUrl+' width="100%" height="100%" allowtransparency="true" frameborder="0"></iframe>';var a=new VE_Panel("intro",0,0,"auto","auto","welcomePanel",VE_Help.introZIndex,l16cbt,b,"","",true,taskArea_data);a.el.className="welcomePanel";a.body.className="VE_Panel_body_help";if(typeof pseudoHover!=undefined)pseudoHover(a.title);a.SetToolbarSize(0);a.SetFooterSize(0);if(typeof window.welcomeUrl==undefined||window.welcomeUrl==""||window.welcomeUrl==null);else{a.onTitleClick=function(){taskArea.setCurrent(this)};a.onCloseClick=function(){var a=this.el.parentElement;if(a)a.removeChild(this.el);taskArea.removeItem(this);VE_Help.introPanel=null};a.onMaximize=function(){resetWhatBox()}}taskArea.addItem(a);VE_Help.introPanel=a};VE_Help.Open=function(b,c){VE_Help.EnablePreventLayer();VE_Help.helpPanel.Show();VE_Help.helpPanel.SetTitle(b);VE_Help.helpPanel.SetBody('<iframe id = "helpFrame" src = "about:blank" width = "100%" allowtransparency = "true" scrolling = "auto" frameborder = "0"></iframe>');var a=$ID("helpFrame");a.src=c;VE_Help.Redraw()};VE_Help.OpenLiveHelp=function(b,a,c){var g="_live_help",f=550,e=575,i=(screen.availWidth-f)*0.5,j=(screen.availHeight-e)*0.5,h="resizable=yes,top="+j+",width="+f+",height="+e+",left="+i;if(typeof b=="undefined"||b==null||b=="")b=liveLocalHelpProjectCode;if(typeof a=="undefined"||a==null||a=="")a=VE_Help.LiveHelp.Keyword;if(typeof c=="undefined"||c==null||c=="")c="qaf";var k=liveHelpUrl+"&project="+b+"&querytype="+a+"&query="+c,d=window.open(k,g,h);if(d!=null&&typeof d=="object")d.focus()};VE_Help.Redraw=function(d){var a=VE_Help.helpPanel;if(!a)return;if(!d){var f=taskArea_transparency?taskArea_transparency.offsetWidth:0,e=scratchPad?scratchPad.getElement().offsetWidth:0;if(document.body.clientWidth>800)var c=document.body.clientWidth-2*VE_Help.margins;else var c=document.body.clientWidth-50,b=document.body.clientHeight-header.offsetHeight-mapActionBar.offsetHeight-VE_Help.margins-30;if(c>0)a.width=c;if(b>0)a.height=b}a.y=mapActionBar.offsetTop+mapActionBar.offsetHeight+8;a.x=VE_Help.margins;a.Resize()};VE_Help.CloseIntro=function(){if(VE_Help.introPanel)VE_Help.introPanel.Hide()};VE_Help.OpenIntro=function(){if(!VE_Help.introPanel)VE_Help.CreateIntroPanel();else taskArea.setCurrent(VE_Help.introPanel);toggleTaskArea(true);$VE_A.Log("VE | Welcome Pane","Welcome")};VE_Help.ClosePanel=function(){if(VE_Help.helpPanel){VE_Help.helpPanel.Hide();VE_Help.DisablePreventLayer()}};function SanitizeHtmlString(a){if(!a||typeof a!="string")return a;return IOSec.EncodeHtml(a)}function GetMousePosX(a){var b=0;if(a.pageX)b=a.pageX;else if(a.clientX)b=a.clientX+document.body.scrollLeft;return b}function GetMousePosY(a){var b=0;if(a.pageY)b=a.pageY;else if(a.clientY)b=a.clientY+document.body.scrollTop;return b}function GetTarget(b){if(!b)var b=window.event,a;if(b.srcElement)a=b.srcElement;else if(b.target)a=b.target;if(a.nodeType==3)a=targ.parentNode;return a}function SelectText(a,c,d){if(!a)return;if(a.createTextRange){var b=a.createTextRange();b.moveStart("character",c);b.moveEnd("character",d);b.select()}else if(a.setSelectionRange)a.setSelectionRange(c,d)}function GetElementLeftPositionByID(a){return GetElementLeftPosition($ID(a))}function GetElementLeftPosition(d,c){var a=d,b=0;while(a&&a!=c){b+=a.offsetLeft;a=a.offsetParent}if(navigator.userAgent.indexOf("Mac")!=-1&&typeof document.body.leftMargin!="undefined")b+=document.body.leftMargin;return b}function GetElementTopPositionByID(a){return GetElementTopPosition($ID(a))}function GetElementTopPosition(d,c){var a=d,b=0;while(a&&a!=c){b+=a.offsetTop;a=a.offsetParent}if(navigator.userAgent.indexOf("Mac")!=-1&&typeof document.body.topMargin!="undefined")b+=document.body.topMargin;return b}function SelectedTextLength(a){if(!a)return 0;if(a.document){var b=a.document.selection.createRange();return b.text.length}else{var c=a.selectionStart,d=a.selectionEnd;return d-c}}function setScrollPosition(a,b,c){if(!a)return;a.scrollTop=c;a.scrollLeft=b}function pseudoHover(a){if(!document.all)return;var c=function(){a.className+=" ms_pseudoHover"},b=function(){a.className=a.className.replace(/\s*ms_pseudoHover/g,"")};a.attachEvent("onmouseover",c);a.attachEvent("onmouseout",b);window.attachEvent("onunload",d);function d(){a.detachEvent("onmouseover",c);a.detachEvent("onmouseout",b)}}function pseudoHoverForChildren(d,a){if(!document.all)return;if(!a)a="LI";var c=d.getElementsByTagName(a);for(var b=0;b<c.length;b++)this.pseudoHover(c[b])}function pseudoHoverRemove(a){if(!document.all)return;a.className=a.className.replace(/\s*ms_pseudoHover/g,"")}function setElementCursor(b,a){b.style.cursor=a}function setElementStyle(c,h,b,a){var i=Microsoft.Web.Css;if(!a)a=Microsoft.Web.Css.Units.Pixels;switch(h){case style.Height:d(c,b,a);break;case style.Width:e(c,b,a);break;case style.Top:g(c,b,a);break;case style.Left:f(c,b,a);break}function d(c,a,b){try{c.style.height=a+b}catch(d){}}function e(c,b,a){try{c.style.width=b+a}catch(d){}}function g(b,c,a){try{b.style.top=c+a}catch(d){}}function f(b,c,a){try{b.style.left=c+a}catch(d){}}}RegisterNamespaces("Msn.VE");Msn.VE.OSType={Windows:1,Windows95:2,Windows98:3,WindowsMillenium:4,WindowsNT:5,WindowsNT4:6,Windows2000:7,Windows2000SP1:8,WindowsXP:9,WindowsXPSP2:10,WindowsServer2003:11,WindowsServer2003SP1:12,WindowsVista:13,MacOS:30,MacOS9:31,MacOSX:32,Linux:40,Unknown:100};Msn.VE.CLRType={CLR10:1,CLR11:2,CLR20:4,CLR30:8};Msn.VE.BrowserType={Firefox:1,MSIE:2,Opera:3,Unknown:10};Msn.VE.BrowserCaps={VML:1,SVG:2,WindowlessSelectElement:4,RightMouseButton:8,AddFavourite:16,VectorCapable:3};Msn.VE.BrowserInfo=function(){var a=this;this.Type=null;this.BrowserCaps=0;this.CLRType=0;this.MajorVersion=null;this.MinorVersion=null;this.versionString=null;this.UserAgent=null;this.OSType=null;this.Locale=null;if(arguments.length==0){this.UserAgent=window.navigator.userAgent;this.currentBrowser=true}else{this.UserAgent=arguments[0];this.currentBrowser=false;if(arguments.length>=2)this.Locale=arguments[1]}this.IsCompatibleWith=function(c){for(var b=0;b<c.length;b++){var a=c[b];if(a.Type==this.Type&&(this.MajorVersion>a.MajorVersion||a.MajorVersion==this.MajorVersion&&a.MinorVersion>=this.MinorVersion))return true}return false};function b(){if(a.UserAgent.indexOf("Mac")==-1&&(a.UserAgent.indexOf("Gecko")!=-1||a.UserAgent.indexOf("MSIE")!=-1))a.BrowserCaps|=Msn.VE.BrowserCaps.RightMouseButton}function c(){if(a.UserAgent.indexOf("MSIE 7")!=-1||a.UserAgent.indexOf("Gecko")!=-1)a.BrowserCaps|=Msn.VE.BrowserCaps.WindowlessSelectElement}function j(){if(a.UserAgent.indexOf("Mac")==-1&&(a.UserAgent.indexOf("MSIE 5")!=-1||a.UserAgent.indexOf("MSIE 6")!=-1||a.UserAgent.indexOf("MSIE 7")!=-1))a.BrowserCaps|=Msn.VE.BrowserCaps.VML}function i(){if(a.UserAgent.indexOf("MSIE")==-1){var c=0,e=0,f=new RegExp("Firefox/(.*)"),d=f.exec(a.UserAgent);if(d[1]){var b=d[1].split(".");if(b){c=b[0];e=b[1];if(parseInt(c)>0&&parseInt(e)>=5)a.BrowserCaps|=Msn.VE.BrowserCaps.SVG}}}}function h(){try{if(a.UserAgent.indexOf("MSIE")!=-1)a.BrowserCaps|=Msn.VE.BrowserCaps.AddFavourite}catch(b){}}this.GetVersionString=function(){if(this.versionString==null)if(a.UserAgent.indexOf("Win")!=-1&&a.UserAgent.indexOf("MSIE")!=-1){var b=null,c;try{b=document.createElement("<DIV STYLE='behavior:url(#default#clientCaps); display: none' ID='__clientCaps'>");document.body.appendChild(b);c=b.getComponentVersion("{89820200-ECBD-11CF-8B85-00AA005B4383}","componentid")}catch(d){c=a.MajorVersion+"."+a.MinorVersion}finally{if($ID("__clientCaps")!=null)$ID("__clientCaps").parentNode.removeChild(b)}this.versionString=c}else if(a.MajorVersion!=null&&a.MajorVersion!=null)this.versionString=a.MajorVersion+"."+a.MinorVersion;else this.versionString="";return this.versionString};function e(){if(a.UserAgent.indexOf("MSIE")!=-1){var c=new RegExp("MSIE ([0-9]).([0-9])"),b=c.exec(a.UserAgent);if(b!=null){a.MajorVersion=parseInt(b[1]);a.MinorVersion=parseInt(b[2]);return}}else if(a.UserAgent.indexOf("Firefox")!=-1){c=new RegExp("Firefox/([0-9]).([0-9])(.*)");b=c.exec(a.UserAgent);if(b!=null){a.MajorVersion=parseInt(b[1]);a.MinorVersion=parseInt(b[2]);return}}else if(a.UserAgent.indexOf("Opera")!=-1){c=new RegExp("Opera/([0-9]).([0-9])");b=c.exec(a.UserAgent);if(b!=null){a.MajorVersion=parseInt(b[1]);a.MinorVersion=parseInt(b[2]);return}}a.MajorVersion=null;a.MinorVersion=null}function g(){if(a.UserAgent.indexOf("Mac OS X")!=-1)a.OSType=Msn.VE.OSType.MacOSX;else if(a.UserAgent.indexOf("Mac")!=-1)a.OSType=Msn.VE.OSType.MacOS;else if(a.UserAgent.indexOf("Linux")!=-1)a.OSType=Msn.VE.OSType.Linux;else if(a.UserAgent.indexOf("Win95")!=-1||a.UserAgent.indexOf("Windows 95")!=-1)a.OSType=Msn.VE.OSType.Windows95;else if(a.UserAgent.indexOf("Win98")!=-1||a.UserAgent.indexOf("Windows 98")!=-1)a.OSType=Msn.VE.OSType.Windows98;else if(a.UserAgent.indexOf("Win 9x 4.90")!=-1)a.OSType=Msn.VE.OSType.WindowsMillenium;else if(a.UserAgent.indexOf("Windows NT 4.0")!=-1)a.OSType=Msn.VE.OSType.WindowsNT4;else if(a.UserAgent.indexOf("Windows NT 5.01")!=-1)a.OSType=Msn.VE.OSType.Windows2000SP1;else if(a.UserAgent.indexOf("Windows NT 5.0")!=-1)a.OSType=Msn.VE.OSType.Windows2000;else if(a.UserAgent.indexOf("Windows NT 5.1")!=-1&&a.UserAgent.indexOf("SV1")!=-1)a.OSType=Msn.VE.OSType.WindowsXPSP2;else if(a.UserAgent.indexOf("Windows NT 5.1")!=-1)a.OSType=Msn.VE.OSType.WindowsXP;else if(a.UserAgent.indexOf("Windows NT 5.2")!=-1&&a.UserAgent.indexOf("SV1")!=-1)a.OSType=Msn.VE.OSType.WindowsServer2003SP1;else if(a.UserAgent.indexOf("Windows NT 5.2")!=-1)a.OSType=Msn.VE.OSType.WindowsServer2003;else if(a.UserAgent.indexOf("Windows NT 6.0")!=-1)a.OSType=Msn.VE.OSType.WindowsVista;else if(a.UserAgent.indexOf("Windows NT")!=-1)a.OSType=Msn.VE.OSType.WindowsNT;else if(a.UserAgent.indexOf("Win")!=-1)a.OSType=Msn.VE.OSType.Windows;else a.OSType=Msn.VE.OSType.Unknown}function d(){if(a.UserAgent.indexOf(".NET CLR 1.0")!=-1)a.CLRType|=Msn.VE.CLRType.CLR10;if(a.UserAgent.indexOf(".NET CLR 1.1")!=-1)a.CLRType|=Msn.VE.CLRType.CLR11;if(a.UserAgent.indexOf(".NET CLR 2.0")!=-1)a.CLRType|=Msn.VE.CLRType.CLR20;if(a.UserAgent.indexOf(".NET CLR 3.0")!=-1)a.CLRType|=Msn.VE.CLRType.CLR30}function f(){if(a.Locale!=null)return;if(a.UserAgent.indexOf("MSIE")!=-1){if(navigator.browserLanguage)a.Locale=navigator.browserLanguage;if(navigator.userLanguage)a.Locale=navigator.userLanguage;if(navigator.systemLanguage)a.Locale=navigator.systemLanguage}else if(a.UserAgent.indexOf("Gecko")!=-1){var c=new RegExp("; (.*); rv:"),b=c.exec(a.UserAgent);if(b[1])a.Locale=b[1].substring(b[1].lastIndexOf(" "),b[1].length+1)}else if(a.UserAgent.indexOf("Opera")!=-1){c=new RegExp(" (.*))");b=c.exec(a.UserAgent);if(b[1])a.Locale=b[1].substring(b[1].lastIndexOf(" "),b[1].length+1)}else a.Locale="en-US"}function k(){if(a.UserAgent.indexOf("Gecko")!=-1)a.Type=Msn.VE.BrowserType.Firefox;else if(a.UserAgent.indexOf("MSIE")!=-1)a.Type=Msn.VE.BrowserType.MSIE;else if(a.UserAgent.indexOf("Opera")!=-1)a.Type=Msn.VE.BrowserType.Opera;else a.Type=Msn.VE.BrowserType.Unknown;e();g();d();f();h();i();j();c();b()}k()};Msn.VE.Environment=function(){};Msn.VE.Environment.Redirect=function(a){window.location.href=a};Msn.VE.Environment.BrowserInfo=new Msn.VE.BrowserInfo;function VEParameter(b,a){this.Name=b;this.Value=a}VEParameter.prototype.Name=this.name;VEParameter.prototype.Value=this.value;function VENetwork(c,a,b){if(c!=null&&c!="undefined")this.ServiceUrl=c;if(a!=null&&a!="undefined")Msn.VE.API.Globals.veonbegininvokeevent=a;if(b!=null&&b!="undefined")Msn.VE.API.Globals.veonendinvokeevent=b}function BeginInvoke(f,c,h,g){if(this.ServiceUrl==null||this.ServiceUrl=="undefined"||this.ServiceUrl.length==0)throw new VEException("VENetwork:BeginInvoke","err_noserviceurl",l662gt);if(Msn.VE.API.Globals.veonbegininvokeevent)Msn.VE.API.Globals.veonbegininvokeevent();var e=VENetwork.GetExecutionID();if(c){var b=this.ServiceUrl+"?";for(var d=0;d<c.length;d++){b=b+c[d].Name;b=b+"=";b=b+c[d].Value;b=b+"&"}}else b=this.ServiceUrl;if(Msn.VE.API.Globals.vedebug)alert(b);var a=document.createElement("script");a.type="text/javascript";a.language="javascript";a.id=e;a.src=b;if(navigator.userAgent.indexOf("IE")>=0)a.onreadystatechange=function(){if(a&&("loaded"==a.readyState||"complete"==a.readyState)){a.onreadystatechange=null;EndInvoke(g,h,f,a,e)}};else a.onload=function(){a.onload=null;EndInvoke(g,h,f,a,e)};VENetwork.GetAttachTarget().appendChild(a)}function EndInvoke(endInvokeTarget,fnCallback,endInvokeMethod,elScript,executionId){var objects=null;if(endInvokeMethod)eval("objects = "+endInvokeMethod+"();");document.getElementsByTagName("head")[0].removeChild(elScript);elScript=null;if(fnCallback!=null&&fnCallback!="undefined")fnCallback(objects,endInvokeTarget);if(Msn.VE.API.Globals.veonendinvokeevent)Msn.VE.API.Globals.veonendinvokeevent()}VENetwork.GetExecutionID=function(){var a=new Date,b=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds());b+=Math.round(Math.random()*1000000);return b};function GetXmlHttp(){var a=null;try{a=new ActiveXObject("Msxml2.XMLHTTP")}catch(b){try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(c){a=null}}if(!a&&typeof XMLHttpRequest!="undefined")a=new XMLHttpRequest;return a}VENetwork.AttachStyleSheetCallback=function(a){if(a)a()};VENetwork.AttachStyleSheet=function(a,b){if(a==null||a=="undefined"||a.length==0)throw new VEException("VENetwork:AttachStylesheet","err_nostylesurl",l783it);elStyle=document.createElement("link");elStyle.rel="stylesheet";elStyle.type="text/css";elStyle.rev="stylesheet";elStyle.id=VENetwork.GetExecutionID();elStyle.href=a;VENetwork.GetAttachTarget().appendChild(elStyle);if(navigator.userAgent.indexOf("IE")>=0)elStyle.onreadystatechange=function(){if(elStyle&&("loaded"==elStyle.readyState||"complete"==elStyle.readyState)){elStyle.onreadystatechange=null;VENetwork.AttachStyleSheetCallback(b)}};else VENetwork.AttachStyleSheetCallback(b);return};VENetwork.DownloadScriptCallback=function(a){if(a)a()};VENetwork.DownloadScript=function(a,b){if(a==null||a=="undefined"||a.length==0)throw new VEException("VENetwork:DownloadScript","err_noscripturl",l24ht);elScript=document.createElement("script");elScript.type="text/javascript";elScript.language="javascript";elScript.id=VENetwork.GetExecutionID();elScript.src=a;if(navigator.userAgent.indexOf("IE")>=0)elScript.onreadystatechange=function(){if(elScript&&("loaded"==elScript.readyState||"complete"==elScript.readyState)){elScript.onreadystatechange=null;VENetwork.DownloadScriptCallback(b)}};else elScript.onload=function(){elScript.onload=null;VENetwork.DownloadScriptCallback(b)};VENetwork.GetAttachTarget().appendChild(elScript);return};VENetwork.DownloadXml=function(d,c,b){var a=GetXmlHttp();a.open(c,d,true);a.onreadystatechange=function(){if(a.readyState==4){if(b)b(a.responseXML);a=null}};a.send(null)};VENetwork.GetAttachTarget=function(){if(document.getElementsByTagName("head")[0]!=null)return document.getElementsByTagName("head")[0];else throw new VEException("VENetwork:cstr","err_noheadelement",l611ft)};VENetwork.prototype.BeginInvoke=BeginInvoke;VENetwork.prototype.EndInvoke=EndInvoke;function VEException(b,c,a){this.source=b;this.name=c;this.message=a}VEException.prototype.Name=this.name;VEException.prototype.Source=this.source;VEException.prototype.Message=this.message;function VEValidator(){}VEValidator.ValidateFloat=function(b,c){var a="";if(arguments!=null&&arguments.caller!=null)a=VEValidator.GetCaller(arguments.caller);if(a=="")a="VEValidator.ValidateFloat";if(b==null||b=="undefined")throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","float"));try{if(isNaN(parseFloat(b)))throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","float"));return true}catch(d){throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","float"))}};VEValidator.ValidateInt=function(b,c){var a="";if(arguments!=null&&arguments.caller!=null)a=VEValidator.GetCaller(arguments.caller);if(a=="")a="VEValidator.ValidateInt";if(b==null||b=="undefined")throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","int"));try{if(isNaN(parseInt(b)))throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","int"));return true}catch(d){throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","int"))}};VEValidator.ValidateNonNull=function(b,c){var a="";if(arguments!=null&&arguments.caller!=null)a=VEValidator.GetCaller(arguments.caller);if(a=="")a="VEValidator.ValidateNonNull";if(b==null||b=="undefined")throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","non null"))};VEValidator.ValidateMapStyle=function(a,c){var b="";if(arguments!=null&&arguments.caller!=null)b=VEValidator.GetCaller(arguments.caller);if(b=="")b="VEValidator.ValidateMapStyle";if(a==null||a=="undefined")throw new VEException(b,"err_invalidargument",l614qt.replace("%1",c).replace("%2","MapStyle"));if(a=="r"||a=="R"||a=="a"||a=="A"||a=="o"||a=="O"||a=="h"||a=="H")return true;throw new VEException(b,"err_invalidargument",l614qt.replace("%1",c).replace("%2","MapStyle"))};VEValidator.ValidateMapMode=function(b,c){var a="";if(arguments!=null&&arguments.caller!=null)a=VEValidator.GetCaller(arguments.caller);if(a="")a="VEValidator.ValidateMapMode";if(b==null||b=="undefined")throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","MapMode"));if(b==VEMapMode.Mode2D||b==VEMapMode.Mode3D)return true;throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","MapMode"))};VEValidator.ValidateDistanceUnit=function(b,c){var a="";if(arguments!=null&&arguments.caller!=null)a=VEValidator.GetCaller(arguments.caller);if(a=="")a="VEValidator.ValidateDistanceUnit";if(b==null||b=="undefined")throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","VEDistanceUnit"));if(b==VEDistanceUnit.Miles||b==VEDistanceUnit.Kilometers)return true;throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","VEDistanceUnit"))};VEValidator.ValidateMaxZoom=function(b,c){var a="";if(arguments!=null&&arguments.caller!=null)a=VEValidator.GetCaller(arguments.caller);if(a=="")a="VEValidator.ValidateMaxZoom";if(b==null||b=="undefined")throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","ValidateMaxZoom"));if(b<=Msn.VE.API.Globals.vemaxzoom)return true;throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","ValidateMaxZoom"))};VEValidator.ValidateLayerType=function(a,c){var b="";if(arguments!=null&&arguments.caller!=null)b=VEValidator.GetCaller(arguments.caller);if(b=="")b="VEValidator.ValidateLayerType";if(a==null||a=="undefined")throw new VEException(b,"err_invalidargument",l614qt.replace("%1",c).replace("%2","VELayerType"));if(a==VELayerType.GeoRSS||a==VELayerType.VECollection||a==VELayerType.VETileSource)return true;throw new VEException(b,"err_invalidargument",l614qt.replace("%1",c).replace("%2","VELayerType"))};VEValidator.ValidateDashboardSize=function(b,c){var a="";if(arguments!=null&&arguments.caller!=null)a=VEValidator.GetCaller(arguments.caller);if(a=="")a="VEValidator.ValidateDashboardSize";if(b==null||b=="undefined")throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","VEDashboardSize"));if(b==VEDashboardSize.Normal||b==VEDashboardSize.Tiny)return true;throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","VEDashboardSize"))};VEValidator.ValidateObject=function(b,c,e,d){var a="";if(arguments!=null&&arguments.caller!=null)a=VEValidator.GetCaller(arguments.caller);if(a=="")a="VEValidator.ValidateObject";if(b==null||b=="undefined")throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2","non null"));if(!e.prototype.isPrototypeOf(b))throw new VEException(a,"err_invalidargument",l614qt.replace("%1",c).replace("%2",d))};VEValidator.GetCaller=function(b){if(b!=null||b!=""){try{var a=b.toString().match(/function (\w*)/)[1]}catch(c){a=""}if(a==null||a.length==0)return "";else return a}else return ""};function VEPushpin(f,e,d,h,g,c,b,a){VEValidator.ValidateNonNull(f,"pinId");VEValidator.ValidateNonNull(e,"veLatLong");var i=this;this.IsInLayer=false;this.ID=f;this.LatLong=e;this.Title=h;if(d==null||d=="undefined"||d.length==0)this.Iconurl=Msn.VE.API.Constants.iconurl;else this.Iconurl=d;this.Details=g;if(c==null||c=="undefined"||c.length==0)this.IconStyle="";else this.IconStyle=c;if(b==null||b=="undefined"||b.length==0)this.TitleStyle="VE_Pushpin_Popup_Title";else this.TitleStyle=b;if(a==null||a=="undefined"||a.length==0)this.DetailsStyle="VE_Pushpin_Popup_Body";else this.DetailsStyle=a;if(window.ero==null||window.ero=="undefined")window.ero=ERO.getInstance()}VEPushpin.ShowDetailOnMouseOver=true;VEPushpin.OnMouseOverCallback=null;VEPushpin.prototype.Dispose=function(){this.DetailsStyle==null;this.TitleStyle=null;this.IconStyle=null;this.Details=null;this.IconUrl=null;this.Title=null;this.LatLong=null;this.ID=null;this.m_vemapcontrol=null;this.m_vemap=null};VEPushpin.Hide=function(a){VEMap.ValidateState();if(window.ero!=null){if(a=="undefined"||a==null)a=false;window.ero.hide(a)}};VEPushpin.GetEroContent=function(c,b,e,d){var a="<p>";if(c.length>0)a+='<div class="'+e+'">'+unescape(c)+"</div>";if(b.length>0)a+='<div class="'+d+'">'+unescape(b)+"</div>";if(!document.all&&(c.length==0||b.length==0))a+="<br/><br/>";a+="</p>";return a};VEPushpin.Show=function(l,m,k,h,d,c,g,e){var a=VEMap._GetMapFromGUID(l);if(a==null||a=="undefined")return;VEMap.ValidateState();var i=a.vemapcontrol.GetX(h)+a.GetLeft(),j=a.vemapcontrol.GetY(k)+a.GetTop();if(VEPushpin.ShowDetailOnMouseOver){var b=$ID(m+"_"+a.GUID);if(b!=null&&b!="undefined"){window.ero.setBoundingArea(new Microsoft.Web.Geometry.Point(0,0),new Microsoft.Web.Geometry.Point(document.body.clientWidth,document.body.clientHeight));var f=VEPushpin.GetEroContent(d,c,g,e);window.ero.setContent(f);window.ero.dockToElement(b)}}if(VEPushpin.OnMouseOverCallback!=null)VEPushpin.OnMouseOverCallback(i,j,d,unescape(c))};VEPushpin.Show3D=function(a,c,b,f,d){if(VEPushpin.ShowDetailOnMouseOver){var e=VEPushpin.GetEroContent(c,b,f,d);window.ero.setContent(e);window.ero.dockToRect(a,null,-1,true,true)}if(VEPushpin.OnMouseOverCallback!=null)VEPushpin.OnMouseOverCallback(a.getP1().x,a.getP1().y,c,unescape(b))};function GetContent(){var d=this.ID+"_"+this.m_vemap.GUID,a="<img class='"+this.IconStyle+"' src='"+this.Iconurl+"' id='"+d+"' ",c=this.Title!=null&&this.Title!="undefined"&&this.Title.length>0,b=this.Details!=null&&this.Details!="undefined"&&this.Details.length>0;if(c||b){a+=" onmouseout='VEPushpin.Hide();' onmousedown='VEPushpin.Hide(true);' onmouseover='VEPushpin.Show(\""+this.m_vemap.GUID+'","'+this.ID+'",'+this.LatLong.Latitude+","+this.LatLong.Longitude;if(c)a+=', "'+escape(this.Title)+'"';else a+=',""';if(b)a+=', "'+escape(this.Details)+'"';else a+=',""';a+=',"'+this.TitleStyle+'"';a+=',"'+this.DetailsStyle+'"';a+=");' "}a+="/>";return a}VEPushpin.DisposeERO=function(){if(window.ero!=null&&window.ero!="undefined"){window.ero.destroy();window.ero=null}};VEPushpin.prototype._SetMapInstance=function(a){this.m_vemap=a;this.m_vemapcontrol=a.vemapcontrol};VEPushpin.prototype.GetContent=GetContent;function GetImageFullUrl(a){var b="";if(a&&a.constructor==String&&a.length>0){var c=new Image;c.src=a;b=c.src}return b}function VE_Scratchpad(){}VE_Scratchpad.AddLocation=function(){return};function VEFindResult(f,c,a,d,b,e){VEValidator.ValidateNonNull(c,"name");VEValidator.ValidateNonNull(a,"description");VEValidator.ValidateNonNull(b,"isSponsored");this.ID=f;this.Name=c;this.Description=a;this.LatLong=d;this.IsSponsored=b;this.Phone=e}function VESearchResult(c,a,b){this.ID=c;this.LatLong=a;this.Score=b}function VESearchType(){}VESearchType.Business="YellowPageSearch";function VE_SearchManager(b){VEValidator.ValidateObject(b,"vemap",VEMap,"VEMap");this.m_vemap=b;var a=new VELatLongFactory(new VELatLongFactorySpecFromMap(this.m_vemap));this.m_showDisambigousDialog=true;this.Initialize=function(){};this.Find=function(e,d,r,q,j){VEMap.ValidateState();var c="",k="";if(e==null||e=="undefined"||e.length<=0)c="";else{c=e;this.vesearchwhat=c}if(d==null||d=="undefined"||d.length<=0)k="";else k=d;if(c==""&&k=="")throw new VEException("VEMap:Find","err_invalidwhatwhere",l20jt);var b=[],e=new VEParameter("a",c);b.push(e);d=new VEParameter("b",k);b.push(d);var f=0,g=0,h=0,i=0,o=1,s=1,t="false";if(c!=null&&c.length>0){var m=this.m_vemap.vemapcontrol.PixelToLatLong(new Msn.VE.Pixel(0,0)),l=this.m_vemap.vemapcontrol.PixelToLatLong(new Msn.VE.Pixel(this.m_vemap.GetWidth(),this.m_vemap.GetHeight()));if(m==null||l==null)return;f=m.latitude;g=l.longitude;h=l.latitude;i=m.longitude;if(f<h){var p=f;f=h;h=p}if(g<i){p=g;g=i;i=p}if(j!=null&&j!="undefined"){VEValidator.ValidateInt(j,"startPageIndex");o=parseInt(j)}var a=new VEParameter("c",f);b.push(a);a=new VEParameter("d",g);b.push(a);a=new VEParameter("e",h);b.push(a);a=new VEParameter("f",i);b.push(a);a=new VEParameter("g",o);b.push(a);a=new VEParameter("i",s);b.push(a);a=new VEParameter("r",t);b.push(a);a=new VEParameter("t",VESearchType.Business);b.push(a)}b.push(new VEParameter(Msn.VE.API.Constants.mapguid,this.m_vemap.GUID));this.vesearchcallback=r;this.vesearchdisambiguatecallback=q;var n=new VENetwork;n.ServiceUrl=Msn.VE.API.Constants.searchservice;n.BeginInvoke(null,b,null)};this._HandleFailedWhereSearch=function(a){VEMap.ValidateState();if(a!=null&&a!="undefined")this.m_vemap.ShowMessage(a.replace(/%1/g,MapControl.Features.PlatformName))};this._ApplyResults=function(l,d,c,k,g){VEMap.ValidateState();var f=[],e=null;if(!Msn.VE.API.Globals.veiscommercialcontrol){if(this.m_vemap.searchelement!=null){e=$ID(this.m_vemap.searchelement);e.innerHTML=""};if(d!=null)for(var b=0;b<d.length;b++){var i=new VEFindResult(d[b].id,d[b].name,d[b].description,a.CreateVELatLong(d[b].latitude,d[b].longitude),false,d[b].phone);f.push(i);if(e!=null)e.appendChild(VE_SearchManager.CreateSearchResultElement(d[b]));try{var j=new VEPushpin(d[b].id,a.CreateVELatLong(d[b].latitude,d[b].longitude),null,d[b].name,d[b].description+"<br/>"+d[b].phone);this.m_vemap.AddPushpin(j)}catch(m){}}if(c!=null)for(b=0;b<c.length;b++){var h=null;if(c[b].latitude!=null&&c[b].latitude!="undefined"&&c[b].longitude!=null&&c[b].longitude!="undefined"&&c[b].latitude>=-85&&c[b].latitude<=85&&c[b].longitude>=-180&&c[b].longitude<=180)h=a.CreateVELatLong(c[b].latitude,c[b].longitude);i=new VEFindResult(c[b].id,c[b].title,c[b].description,h,true);f.push(i);if(e!=null)e.appendChild(VE_SearchManager.CreateAdElement(c[b]));try{if(h!=null){j=new VEPushpin(c[b].id,h,null,c[b].title,c[b].description);this.m_vemap.AddPushpin(j)}}catch(m){}}if(g!=null&&g!="undefined"&&g.length!=0)this.m_vemap.ShowMessage(g)}f.HasMore=k;f.Message=g;Msn.VE.API.Globals.vesearchpoiresults=f;if(this.vesearchcallback!=null&&this.vesearchcallback!="undefined")this.vesearchcallback(f)};this.ApplySuggestion=function(c,a){VEMap.ValidateState();var b=$ID("vewhatinput");if(b)b.value=a;this.Find(a,this.m_vemap.lastwheresearch,null,"VEMap._GetMapFromGUID("+this.m_vemap.GUID+")._Disambiguate",1)};this.CreateAdElement=function(a){VEMap.ValidateState();if(a==null||a=="undefined")return null;var b=document.createElement("div");b.id="veadresults_"+a.id;b.className="VE_AdResult";var c=document.createElement("a");c.className="VE_AdResult_Title";c.innerHTML=a.title;c.href=a.url;b.appendChild(c);var d=document.createElement("div");d.className="VE_AdResult_Description";d.innerHTML=a.description;b.appendChild(d);return b};this.CreateSearchResultElement=function(b){VEMap.ValidateState();if(b==null||b=="undefined")return null;var a=document.createElement("div");a.id="vesearchresults_"+b.id;a.className="VE_SearchResult";var e=document.createElement("a");e.className="VE_SearchResult_Title";e.innerHTML=b.name;a.appendChild(e);var f=document.createElement("div");f.className="VE_SearchResult_Description";f.innerHTML=b.description;a.appendChild(f);var d=document.createElement("div");d.className="VE_SearchResult_Phone";d.innerHTML=b.phone;a.appendChild(d);var g=document.createElement("div");g.className="VE_SearchResult_Type";g.innerHTML=b.phone;a.appendChild(g);var c=document.createElement("div");c.className="VE_SearchResult_Rating";c.innerHTML=b.phone;a.appendChild(c);return a};this.UpdateAmbiguousList=function(c){VEMap.ValidateState();if(c==null||c=="undefined"||c.length==0)return;Msn.VE.API.Globals.vesearchlocresults=c;if(this.m_showDisambigousDialog)this.m_vemap.m_veambiguouslist.Show(c,this.vesearchdisambiguatecallback);if(b.DisambiguationCallback!=null&&b.DisambiguationCallback!="undefined"){var e=[];for(var d=0;d<c.length;d++){var f=new VESearchResult(c[d][0],a.CreateVELatLong(c[d][5],c[d][6]));e.push(f)}b.DisambiguationCallback(e)}};this.SearchCallback=function(c){if(this.vesearchwhat==null||this.vesearchwhat=="undefined")if(this.vesearchcallback!=null&&this.vesearchcallback!="undefined"){var d=[];for(var b=0;b<c.length;b++){var e=new VESearchResult(c[b][0],a.CreateVELatLong(c[b][1],c[b][2]),c[b][3]);d.push(e)}this.vesearchcallback(d)}}}Msn.VE.Search=new Object;Msn.VE.Search.strLastWhere="";function VEMessage(b){VEValidator.ValidateObject(b,"vemap",VEMap,"VEMap");this.m_vemap=b;var a=this;this.Show=function(g){if(g==null||g=="undefined"||g.length<=0)return;g=c(g);if(this.vemessagepanel==null||this.vemessagepanel=="undefined"){var d=document.createElement("div");d.id=this.m_vemap.ID+"_vemessagepanel";d.className="VE_Message";d.style.zIndex=Msn.VE.API.Globals.vemessagepanelzIndex;d.style.top=this.m_vemap.GetHeight()/2-Msn.VE.API.Globals.vemessagepanelheight/2+"px";d.style.left=30+"px";d.style.width=this.m_vemap.GetWidth()-60+"px";d.style.height=Msn.VE.API.Globals.vemessagepanelheight+"px";d.style.position="absolute";this.vemessagepanel=d;var e=document.createElement("a");e.className="VE_Message_Title";e.style.zIndex=parseInt(Msn.VE.API.Globals.vemessagepanelzIndex)+1;e.style.top="1px";e.style.left="1px";e.style.width=parseInt(this.vemessagepanel.style.width)-5+"px";e.innerHTML=IOSec.EncodeHtml(l658zt);e.unselectable="on";this.vemessagepanel.appendChild(e);var f=document.createElement("a");f.className="VE_Message_Close";f.style.zIndex=parseInt(Msn.VE.API.Globals.vemessagepanelzIndex)+2;f.style.top="1px";f.style.right="1px";f.onclick=a.Hide;f.unselectable="on";f.innerHTML=l712At;this.vemessagepanel.appendChild(f);var b=document.createElement("div");b.id=this.m_vemap.ID+"_vemessagepanel_body";b.className="VE_Message_Body";b.style.zIndex=parseInt(Msn.VE.API.Globals.vemessagepanelzIndex)+3;b.style.top=22+"px";b.style.width=parseInt(this.vemessagepanel.style.width)-8+"px";b.onclick=a.Hide;b.unselectable="on";b.innerHTML=g;this.vemessagepanel.appendChild(b);this.m_vemap.AddControl(this.vemessagepanel,Msn.VE.API.Globals.vemessagepanelzIndex)}else{b=$ID(this.m_vemap.ID+"_vemessagepanel_body");b.innerHTML=g}this.vemessagepanel.style.display="block";mvcViewFacade.ShowShimIfSupported(this.vemessagepanel);this.timeoutIntervalID=window.setInterval(this.Hide,10000)};this.Hide=function(){VEMap.ValidateState();if(a.vemessagepanel!=null&&a.vemessagepanel!="undefined"){a.vemessagepanel.style.display="none";HideShim(a.vemessagepanel);if(a.timeoutIntervalID!=null){window.clearInterval(a.timeoutIntervalID);a.timeoutIntervalID=null}}};this.Dispose=function(){if(this.vemessagepanel!=null&&this.vemessagepanel!="undefined")this.vemessagepanel=null};function c(a){var b=/<a[^>]*>/gi;a=a.replace(b,"");b=/<\/a>/gi;a=a.replace(b,"");return a}}var L_cannotrenderroute_text="The route could not be drawn because this web browser does not support SVG and VML.";VEDistanceUnit=new function(){this.Miles="m";this.Kilometers="k"};VERouteType=new function(){this.Shortest="s";this.Quickest="q"};function VERoute(b,c,a){VEValidator.ValidateObject(b,"startLocation",VERouteLocation,"VERouteLocation");VEValidator.ValidateObject(c,"endLocation",VERouteLocation,"VERouteLocation");VEValidator.ValidateObject(a,"veRouteItinerary",VERouteItinerary,"VERouteItinerary");this.StartLocation=b;this.EndLocation=c;this.Itinerary=a}function VERouteLocation(b,a){VEValidator.ValidateNonNull(b,"address");VEValidator.ValidateObject(a,"veLatLong",VELatLong,"VELatLong");this.Address=b;this.LatLong=a}function VERouteItinerary(c,a,d,b){this.Distance=c;this.DistanceUnit=a;this.Time=d;this.RouteType=b;this.Segments=[];this.AddSegment=function(a){VEValidator.ValidateObject(a,"segment",VERouteSegment,"VERouteSegment");this.Segments.push(a)}}function VERouteSegment(b,c,a){VEValidator.ValidateObject(a,"veLatLong",VELatLong,"VELatLong");this.Instruction=b;this.Distance=c;this.LatLong=a}function VEDirectionsManager(c){VEValidator.ValidateObject(c,"vemap",VEMap,"VEMap");this.m_vemap=c;var d=this;this.lastStartString="";this.lastEndString="";this.laststart="";this.lastend="";this.lastcallback=null;this.disambigwhat="";this.veroutecache=[];var a=new VELatLongFactory(new VELatLongFactorySpecFromMap(this.m_vemap)),b=new VELatLongDecoder;this.Initialize=function(){try{document.namespaces.add("v","urn:schemas-microsoft-com:vml")}catch(a){}if(this.veroutecache==null||this.veroutecache=="undefined")this.veroutecache=[];else this.RemoveRoutePins()};this.GetDrivingDirections=function(c,d,f,g,m){VEMap.ValidateState();this.ClearRoute();var i="",j="",k="m",l="q";try{if(c==null||c=="undefined"||c.length<=0)throw new VEException("VEDirectionsManager:GetDrivingDirections","err_invaliddirections",l709ct);else i=c;if(d==null||d=="undefined"||d.length<=0)throw new VEException("VEDirectionsManager:GetDrivingDirections","err_invaliddirections",l709ct);else j=d;if(f!=null&&f!="undefined"){this.lastdist=f;if(f==VEDistanceUnit.Kilometers)k="k"}else this.lastdist=VEDistanceUnit.Miles;if(g!=null&&g!="undefined"){this.lasttype=g;if(g==VERouteType.Shortest)l="s"}else this.lastdist=VERouteType.Quickest;var a=[];this.laststart=c;if(typeof c=="object"){var e=b.Decode(c);a.push(new VEParameter("startlat",e.Latitude));a.push(new VEParameter("startlon",e.Longitude))}else a.push(new VEParameter("start",i));this.lastend=d;if(typeof d=="object"){e=b.Decode(d);a.push(new VEParameter("endlat",e.Latitude));a.push(new VEParameter("endlon",e.Longitude))}else a.push(new VEParameter("end",j));a.push(new VEParameter("units",k));a.push(new VEParameter("type",l));a.push(new VEParameter(Msn.VE.API.Constants.mapguid,this.m_vemap.GUID));this.vedirectionscallback=m;this.vedddisambiguatecallback="VEMap._GetMapFromGUID("+this.m_vemap.GUID+")._dm.DisambiguateDirections";var h=new VENetwork;h.ServiceUrl=Msn.VE.API.Constants.directionsservice;h.BeginInvoke(null,a,null)}catch(n){throw n}};this.Populate=function(g,e,f,c,k,l,m,r,j,A,t,v,o,n){try{if(e==null||c==null||k==null||l==null||m==null||r==null||j==null||t==null||v==null||o==null||n==null)throw new VEException("VEDirectionsManager:GetDrivingDirections","err_noroute",l859lt);if(g==null||g=="undefined"||g.length==0)g=this.lastStartString;if(f==null||f=="undefined"||f.length==0)f=this.lastEndString;var w=new VERouteLocation(g,a.CreateVELatLong(e[0],e[1])),y=new VERouteLocation(f,a.CreateVELatLong(c[0],c[1])),q=new Msn.VE.DirectionsDecoder;l=q.DecodeCoordinatesString(l);m=q.DecodeCoordinatesString(m);var p=j;if(j==null||j.length==0)p="mi";var i=new VERouteItinerary(r,p,t,A),x=new VERouteSegment(l99Kt+" "+g,0,a.CreateVELatLong(e[0],e[1]));i.AddSegment(x);var s=true,d=null;if(k!=null){var u=k.length;for(var h=0;h<u;h++){var b=k[h],B=new VERouteSegment(b.name,b.distance,a.CreateVELatLong(b.latitude,b.longitude));i.AddSegment(B);if(s){d=new VEPushpin(VENetwork.GetExecutionID(),a.CreateVELatLong(b.latitude,b.longitude),Msn.VE.API.Constants.vedirectionsstarticon,l594Ft,b.name);this.m_vemap.AddPushpin(d);this.veroutecache.push(d);s=false}else{d=new VEPushpin(VENetwork.GetExecutionID(),a.CreateVELatLong(b.latitude,b.longitude),Msn.VE.API.Constants.vedirectionsstepicon.replace("%1",h).replace("%2",u),l686Mt+" "+h,b.name);this.m_vemap.AddPushpin(d);this.veroutecache.push(d)}}var z=new VERouteSegment(l79Jt+" "+f,0,a.CreateVELatLong(c[0],c[1]));i.AddSegment(z);d=new VEPushpin(VENetwork.GetExecutionID(),a.CreateVELatLong(c[0],c[1]),Msn.VE.API.Constants.vedirectionsendicon,l257Gt,l79Jt+" "+f);this.m_vemap.AddPushpin(d);this.veroutecache.push(d);this.m_vemap.vemapcontrol.SetViewport(e[0],e[1],c[0],c[1]);var C=new VERoute(w,y,i)}this.CreateRouteHighLight("veDDHighlight",l,m,o,n);if(this.vedirectionscallback!=null&&this.vedirectionscallback!="undefined")this.vedirectionscallback(C)}catch(D){throw D}};this.CreateRouteHighLight=function(h,f,g,e,a){VEMap.ValidateState();if(this.verenderingdisabled){this.ShowMessage(L_cannotrenderroute_text);return}var b=6,d="#11DD11",c=4;if(this.verouteHighlight!=null)this.RemoveRouteHighLight();this.verouteHighlight=this.m_vemap.vemapcontrol.AddLine(h,f,g,b,d,c,e,a)};this.ClearRoute=function(){this.RemoveRoutePins();this.RemoveRouteHighLight();VEPushpin.Hide();this.m_vemap.m_veambiguouslist.Hide()};this.RemoveRoutePins=function(){try{VEMap.ValidateState();var b=null;if(this.veroutecache!=null){var c=this.veroutecache.length;for(var a=0;a<c;a++){b=this.veroutecache[a];if(b==null||b=="undefined")continue;this.m_vemap.DeletePushpin(b.ID)}for(a=0;a<c;a++)this.veroutecache.pop()}}catch(d){}};this.RemoveRouteHighLight=function(){VEMap.ValidateState();if(this.verouteHighlight==null)return;this.m_vemap.vemapcontrol.RemoveLine(this.verouteHighlight.id)};this.ShowMessage=function(b,a){this.m_vemap.ShowMessage(a)};this.ShowNotFoundMessage=function(){};this.HandleFailedGetDirections=function(a){if(a!=null&&a!="undefined"){window.setTimeout("VEMap._GetMapFromGUID('"+this.m_vemap.GUID+"')._dm.ClearRoute()",10);this.m_vemap.ShowMessage(a.replace(/%1/g,MapControl.Features.PlatformName))}};this.Disambiguate=function(a,b){if(!this.m_vemap.m_veambiguouslist.IsVisible()){this.disambigwhat=a;this.m_vemap.m_veambiguouslist.Show(b,this.vedddisambiguatecallback)}};this.DisambiguateDirections=function(f,b,c){var d="",e="";if(this.disambigwhat=="end"){d=this.laststart;this.lastEndString=f;if(b!=null&&b!="undefined"&&c!=null&&c!="undefined")e=a.CreateVELatLong(b,c);else e=f}else{e=this.lastend;this.lastStartString=f;if(b!=null&&b!="undefined"&&c!=null&&c!="undefined")d=new VELatLong(b,c);else d=f}this.GetDrivingDirections(d,e,this.lastdist,this.lasttype,this.vedirectionscallback)}}function VE_Directions(){}function VE_RouteInstruction(d,c,a,b){this.name=d;this.distance=b;this.latitude=c;this.longitude=a;this.permanentPin=false}function VE_Location(c,b,a){this.name=c;this.latitude=b;this.longitude=a}function VEAmbiguouslist(b){VEValidator.ValidateNonNull(b,"vemap");this.m_vemap=b;var a=this;this.ID=this.m_vemap.ID+"_veplacelistpanel";this.Show=function(c,i){var f=null;if(this.veplacelistpanel==null||this.veplacelistpanel=="undefined"){var h=document.createElement("div");h.id=this.ID;h.className="VE_PlaceList";h.style.top=this.m_vemap.GetHeight()/2-Msn.VE.API.Globals.veplacelistpanelheight/2+"px";h.style.left=this.m_vemap.GetWidth()/2-Msn.VE.API.Globals.veplacelistpanelwidth/2+"px";h.style.width=Msn.VE.API.Globals.veplacelistpanelwidth+"px";h.style.height=Msn.VE.API.Globals.veplacelistpanelheight+"px";h.style.position="absolute";this.veplacelistpanel=h;var e=document.createElement("a");e.className="VE_PlaceList_Title";e.style.zIndex=parseInt(Msn.VE.API.Globals.veplacelistpanelzIndex)+1;e.style.width=parseInt(Msn.VE.API.Globals.veplacelistpanelwidth)-5+"px";e.style.top="1px";e.style.left="1px";e.innerHTML=IOSec.EncodeHtml(l870Et);e.unselectable="on";this.veplacelistpanel.appendChild(e);var g=document.createElement("a");g.className="VE_PlaceList_Close";g.style.zIndex=parseInt(Msn.VE.API.Globals.veplacelistpanelzIndex)+2;g.style.top="1px";g.style.right="1px";g.onclick=a.Hide;g.unselectable="on";g.innerHTML=l712At;this.veplacelistpanel.appendChild(g);f=document.createElement("div");f.id=this.m_vemap.ID+"_veplacelistbody";f.style.zIndex=300;f.className="VE_PlaceList_Body";this.veplacelistpanel.appendChild(f);this.m_vemap.AddControl(this.veplacelistpanel,Msn.VE.API.Globals.veplacelistpanelzIndex)}else f=$ID(this.m_vemap.ID+"_veplacelistbody");f.innerHTML="";for(var b=0;b<c.length;b++){if(c[b]==null||c[b]=="undefined")continue;var d=document.createElement("div");d.id="veplacelistpanel_body_loc"+b;d.className="VE_PlaceList_Location";d.style.position="relative";d.style.zIndex=parseInt(Msn.VE.API.Globals.veplacelistpanelzIndex)+4;d.unselectable="on";var j="VEMap._GetMapFromGUID('"+this.m_vemap.GUID+"').m_veambiguouslist.Hide();",k="VEMap._GetMapFromGUID('"+this.m_vemap.GUID+"').vemapcontrol.SetViewport";if(c[b].name)if(i!=null&&i!="undefined")d.innerHTML='<a onclick="javascript:'+j+i+"('"+c[b].name+"', "+c[b].latitude+", "+c[b].longitude+');">'+c[b].name+"</a>";else d.innerHTML='<a onclick="javascript:'+j+'">'+c[b].name+"</a>";else if(i!=null&&i!="undefined")d.innerHTML='<a onclick="javascript:'+j+i+"('"+c[b][0]+"', "+c[b][1]+", "+c[b][2]+", "+c[b][3]+", "+c[b][4]+');">'+c[b][0]+"</a>";else d.innerHTML='<a onclick="javascript:'+j+k+"("+c[b][1]+", "+c[b][2]+", "+c[b][3]+", "+c[b][4]+');">'+c[b][0]+"</a>";f.appendChild(d)}this.veplacelistpanel.style.display="block";mvcViewFacade.ShowShimIfSupported(this.veplacelistpanel)};this.Hide=function(){if(a.veplacelistpanel!=null&&a.veplacelistpanel!="undefined"){HideShim(a.veplacelistpanel);a.veplacelistpanel.style.display="none"}};this.IsVisible=function(){var a=false;if(this.veplacelistpanel!=null&&this.veplacelistpanel!="undefined"&&this.veplacelistpanel.style.display!="none")a=true;return a};this.Dispose=function(){if(this.veplacelistpanel!=null&&this.veplacelistpanel!="undefined")this.veplacelistpanel=null}}function VEGraphicsManager(f){VEValidator.ValidateObject(f,"vemap",VEMap,"VEMap");var a=this;this._spacecontrol=null;this._hackUniqueLayerId="UniqueLayer_Hack";var k=null;this._entityIdShapePostfix="_Shape";this.m_vemap=f;this.m_vemapcontrol=this.m_vemap.vemapcontrol;var d=new VELatLongDecoder,c=null,e=1,b=null;this.Initialize=function(){if(this.m_vegraphiccanvas==null||this.m_vegraphiccanvas=="undefined")try{this.m_vegraphicspolylines=[];this.m_vegraphicspolygons=[];var b=document.createElement("div");b.id="rootgraphicshape";this.m_vemapcontrol.SetChildDiv(b);this.m_vegraphiccanvas=Msn.Drawing.Graphic.CreateGraphic(b,this.m_vemapcontrol);this.m_vegraphiccanvas.SetZIndex(17);this.m_vemapcontrol.AttachEvent("onstartzoom",a.Clear);this.m_vemapcontrol.AttachEvent("onchangeview",a.Update);this.m_vemapcontrol.AttachEvent("onobliquechange",a.Update);this.m_vemapcontrol.AttachEvent("oninitmode",a.UpdateViewMode)}catch(c){throw c;return}};this.UpdateViewMode=function(){if(a.m_vemap.GetMapMode()==Msn.VE.MapActionMode.Mode3D){a.DrawAll3DPushpins();a.Draw()}else _spacecontrol=null};this.Update=function(){if(a.m_vemap.GetMapMode()!=Msn.VE.MapActionMode.Mode3D){a.Clear();a.Draw()}};this.Clear=function(){if(a.m_vegraphiccanvas!=null&&a.m_vegraphiccanvas!="undefined")a.m_vegraphiccanvas.Clear()};function i(a){var c=false;if(a.minX>b.x1&&a.minY>b.y1&&a.maxX<b.x2&&a.maxY<b.y2)c=true;return c}function h(a){if(typeof a=="undefined"||a.type==MC_GEO_TYPE_POINT)return false;if(a.minX==null||a.minY==null||a.maxX==null||a.maxY==null){var b=null;b=Msn.Drawing.ComputeBoundingBox(a.points);if(b){a.minX=b[0];a.minY=b[1];a.maxX=b[2];a.maxY=b[3]}else return false}var d=true;d=IsRecIntersect(c.x1,c.y1,c.x2,c.y2,a.minX,a.minY,a.maxX,a.maxY);return d}function g(c,d){if(h(c)){var f=c.points;if(!i(c)){d=b;if(d==null)return;var e=null;e=VE_LineClip.Clip(f,d.x1,d.y1,d.x2,d.y2);if(e)c.points=e}a.m_vegraphiccanvas.DrawPrimitive(c);c.points=f}}this.Draw=function(){c=GetCurrentMapViewBounds(a.m_vemapcontrol);b=GetBufferedMapViewBounds(e,c);a.m_vegraphiccanvas.resetOffset();if(a.m_vegraphicspolylines!=null&&a.m_vegraphicspolylines.length>0){var f=a.m_vegraphicspolylines.length;for(var d=0;d<f;d++){var g=a.m_vegraphicspolylines[d];a.DrawOne(g,true,b)}}if(a.m_vegraphicspolygons!=null&&a.m_vegraphicspolygons.length>0){var i=a.m_vegraphicspolygons.length;for(d=0;d<i;d++){var h=a.m_vegraphicspolygons[d];a.DrawOne(h,false,b)}}};this.DrawOne=function(f,m,o){if(typeof f=="undefined"||f==null)return;if(a.m_vemap.GetMapMode()==Msn.VE.MapActionMode.Mode3D){j(f,m,o);return}else a._spacecontrol=null;if(o==null){c=GetCurrentMapViewBounds(a.m_vemapcontrol);b=GetBufferedMapViewBounds(e,c)}a.m_vegraphiccanvas.resetOffset();var n=f.GetLatLongs(),h=[];for(var k=0;k<n.length;k++){var l=d.Decode(n[k]);h.push(l.Longitude);h.push(l.Latitude)}var i;if(m)i=new Msn.Drawing.PolyLine(h);else i=new Msn.Drawing.Polygon(h);a.m_vegraphiccanvas.SetZIndex(17);a.m_vegraphiccanvas.SetStroke(f.Stroke);g(i)};function j(e,h){if(typeof e=="undefined"||e==null)return;if(!a._spacecontrol)a._spacecontrol=a.m_vemapcontrol.Get3DControl();var m=e.GetLatLongs(),f=[];for(var i=0;i<m.length;i++){var j=d.Decode(m[i]);f.push(j.Longitude);f.push(j.Latitude)}var g;if(h)g=new Msn.Drawing.PolyLine(f);else g=new Msn.Drawing.Polygon(f);a.m_vegraphiccanvas.SetZIndex(17);a.m_vegraphiccanvas.SetStroke(e.Stroke);var o=e.ID,n=a._hackUniqueLayerId,l=ConvertPointArrayToView3DParameter(g.points),c=GetPrimitiveSymbolOrDefault(g,e.Stroke),p=ConvertStrokeWeightToView3DParameter(c.stroke_weight),b="Linecolor='"+c.stroke_color+"'"+" Lineweight='"+p+"'"+" Dashstyle='"+c.stroke_dashstyle+"'"+" Lineopacity='"+c.stroke_opacity+"'",k=o+a._entityIdShapePostfix;if(h)a._spacecontrol.AddPolylineWithProperties(n,k,l,b);else if(!h){b=b.concat(" Fillcolor='",c.fill_color,"'");b=b.concat(" Fillopacity='",c.fill_opacity,"'");b=b.concat(" Lineopacity='",c.stroke_opacity,"'");a._spacecontrol.AddPolygonWithProperties(n,k,l,b)}}}VEGraphicsManager.prototype.RemoveLine=function(a){this.RemoveLinebyId(a.ID)};VEGraphicsManager.prototype.RemoveLinebyId=function(b){if(this.m_vegraphiccanvas==null||this.m_vegraphiccanvas=="undefined"){throw new VEException("VEMap:RemoveLinebyId","err_GraphicsInitError",L_GraphicsInitError_Text);return}try{var c=this.m_vegraphicspolylines.length,a=0;while(a<c&&b!=this.m_vegraphicspolylines[a].ID)a++;if(a<c)this.m_vegraphicspolylines.splice(a,1);else{throw new VEException("VEMap:RemoveLinebyId","err_GraphicsInitError",l501ot);return}}catch(d){throw d;return}if(this.m_vemap.GetMapMode()==Msn.VE.MapActionMode.Mode3D)this.Clear3DShape(b);else{this.Clear();this.Draw()}};VEGraphicsManager.prototype.RemoveAllLines=function(){if(this.m_vemap.GetMapMode()==Msn.VE.MapActionMode.Mode3D)this.ClearAll3DShape();this.m_vegraphicspolylines=[];this.Clear();this.Draw()};VEGraphicsManager.prototype.DrawLine=function(a){if(this.m_vegraphiccanvas==null||this.m_vegraphiccanvas=="undefined"){throw new VEException("VEMap:DrawLine","err_GraphicsInitError",L_GraphicsInitError_Text);return}try{VEValidator.ValidateObject(a,"vePolyline",VEPolyline,"VEPolyline");var c=this.m_vegraphicspolylines.length;for(var b=0;b<c;b++)if(a.ID==this.m_vegraphicspolylines[b].ID)throw new VEException("VEMap:DrawLine","err_invalidpolylineid",l501ot);this.m_vegraphicspolylines.push(a)}catch(d){throw d;return}this.DrawOne(a,true)};VEGraphicsManager.prototype.RemovePolygon=function(a){this.RemovePolygonbyId(a.ID)};VEGraphicsManager.prototype.RemovePolygonbyId=function(b){if(this.m_vegraphiccanvas==null||this.m_vegraphiccanvas=="undefined"){throw new VEException("VEMap:RemovePolygonbyId","err_GraphicsInitError",L_GraphicsInitError_Text);return}try{var c=this.m_vegraphicspolygons.length,a=0;while(a<c&&b!=this.m_vegraphicspolygons[a].ID)a++;if(a<c)this.m_vegraphicspolygons.splice(a,1);else{throw new VEException("VEMap:RemovePolygonbyId","err_GraphicsInitError",l0pt);return}}catch(d){throw d;return}if(this.m_vemap.GetMapMode()==Msn.VE.MapActionMode.Mode3D)this.Clear3DShape(b);else{this.Clear();this.Draw()}};VEGraphicsManager.prototype.RemoveAllPolygons=function(){if(this.m_vemap.GetMapMode()==Msn.VE.MapActionMode.Mode3D)this.ClearAll3DShape();this.m_vegraphicspolygons=[];this.Clear();this.Draw()};VEGraphicsManager.prototype.DrawPolygon=function(a){if(this.m_vegraphiccanvas==null||this.m_vegraphiccanvas=="undefined"){throw new VEException("VEMap:DrawPolygon","err_GraphicsInitError",L_GraphicsInitError_Text);return}try{VEValidator.ValidateObject(a,"vePolygon",VEPolygon,"VEPolygon");var c=this.m_vegraphicspolygons.length;for(var b=0;b<c;b++)if(a.ID==this.m_vegraphicspolygons[b].ID)throw new VEException("VEMap:DrawPolygon","err_invalidpolygonid",l0pt);this.m_vegraphicspolygons.push(a)}catch(d){throw d;return}this.DrawOne(a,false)};VEGraphicsManager.prototype.Dispose=function(){if(this.m_vegraphiccanvas!=null){this.m_vegraphiccanvas.Clear();this.m_vegraphiccanvas.Destroy();this.m_vegraphiccanvas=null}if(this.m_vegraphicspolylines!=null&&this.m_vegraphicspolylines!="undefined"){var b=this.m_vegraphicspolylines.length;for(var a=0;a<b;a++)this.m_vegraphicspolylines.pop().Dispose()}if(this.m_vegraphicspolygons!=null&&this.m_vegraphicspolygons!="undefined"){var c=this.m_vegraphicspolygons.length;for(a=0;a<c;a++)this.m_vegraphicspolygons.pop().Dispose()}if(this.m_vemap!=null){this.m_vemapcontrol.DetachEvent("onchangeview",this.Update);this.m_vemapcontrol.DetachEvent("onobliquechange",this.Update);this.m_vemapcontrol.DetachEvent("onstartzoom",this.Clear)}};VEGraphicsManager.prototype.DrawAll3DPushpins=function(){if(this.m_vemap.GetMapMode()!=Msn.VE.MapActionMode.Mode3D)return;if(!this.m_vemap.pushpins)return;if(typeof this._spacecontrol=="undefined"||this._spacecontrol==null)this._spacecontrol=this.m_vemapcontrol.Get3DControl();if(!this._spacecontrol)return;var c=this.m_vemap.pushpins,e=c.length;for(var a=0;a<e;a++){var b=c[a],d=b.LatLong;this.Add3DPushpin(b.ID,d.Latitude,d.Longitude,25,25,"VEAPI_Pushpin",b,Msn.VE.API.Globals.vepushpinpanelzIndex-1)}};VEGraphicsManager.prototype.Add3DPushpin=function(b,e,f,n,l,g,d,m){var h=f,j=e,k=this._hackUniqueLayerId,o='text=""',c;c=GetImageFullUrl(d.Iconurl);var i=b;this.m_vemapcontrol.Get3DControl().AddPointWithProperties(k,i,j,h,c,o);var a=null;if(!$ID(b)){a=this.m_vemapcontrol.AddPushpin(b,e,f,n,l,g,d.GetContent(),m);if(a)a.style.display="block"}};VEGraphicsManager.prototype.Remove3DPushpin=function(a){if(typeof this._spacecontrol=="undefined"||this._spacecontrol==null)this._spacecontrol=this.m_vemapcontrol.Get3DControl();this.Clear3DShape(a);this.m_vemapcontrol.RemovePushpin(a)};VEGraphicsManager.prototype.ClearAllPushpins=function(b){if(typeof this._spacecontrol=="undefined"||this._spacecontrol==null)this._spacecontrol=this.m_vemapcontrol.Get3DControl();var d=b.length;for(var c=0;c<d;c++){var a=b.pop();if(!a.IsInLayer){this.Clear3DShape(a.ID);a.Dispose()}}this.m_vemapcontrol.ClearPushpins()};VEGraphicsManager.prototype.ClearAll3DShape=function(){var c=null,b=0;if(this.m_vegraphicspolylines!=null&&this.m_vegraphicspolylines!="undefined"){b=this.m_vegraphicspolylines.length;for(var a=0;a<b;a++){c=this.m_vegraphicspolylines[a];this.Clear3DShape(c.ID)}}if(this.m_vegraphicspolygons!=null&&this.m_vegraphicspolygons!="undefined"){b=this.m_vegraphicspolygons.length;for(a=0;a<b;a++){c=this.m_vegraphicspolygons[a];this.Clear3DShape(c.ID)}}};VEGraphicsManager.prototype.Clear3DShape=function(c){var a=c;this._spacecontrol.DeleteGeometry(this._hackUniqueLayerId,a);var b=a+this._entityIdShapePostfix;this._spacecontrol.DeleteGeometry(this._hackUniqueLayerId,b)};function ConvertPointArrayToView3DParameter(a){var b="",c=a.length;for(i=0;i<c;i+=2){var d=a[i],e=a[i+1];b+=d+","+e+" "}return b}function ConvertStrokeWeightToView3DParameter(a){if(a==null)return "";var c=a.length,b=a.substring(0,c-2);return b+"px"}function GetPrimitiveSymbolOrDefault(c,b){var a=c.symbol;if(a==null){if(typeof b!="undefined"){c.symbol=new Msn.Drawing.MapSymbol;a=c.symbol;a.stroke_weight=b.width+"pt";a.joinstyle=b.linejoin;a.stroke_color=b.color.ToHexString();a.stroke_dashstyle=b.linecap;a.stroke_opacity=b.color.A.toString();a.fill_color=b.fillcolor.ToHexString();a.fill_opacity=b.fillcolor.A.toString();return a}else if(_defaultSymbol==null){_defaultSymbol=new Msn.Drawing.MapSymbol;_defaultSymbol.id=MC_PROPERTY_DEFAULT;c.symbol=_defaultSymbol}return _defaultSymbol}return a}VELayerType=new function(){this.VECollection="c";this.GeoRSS="g";this.VETileSource="t"};function VELayerSpecification(c,g,d,h,e,f,a,b){this.Type=null;this.ID=null;this.LayerSource=null;this.Method=null;this.FnCallback=null;this.IconUrl=null;this.Opacity=null;this.ZIndex=null;if(c!="undefined"&&c!=null){VEValidator.ValidateLayerType(c,"veLayerType");this.Type=c}if(g!="undefined"&&g!=null)this.ID=g;if(d!="undefined"&&d!=null)this.LayerSource=d;if(h!="undefined"&&h!=null)this.Method=h;if(e!="undefined"&&e!=null)this.FnCallback=e;if(f!="undefined"&&f!=null)this.IconUrl=f;if(a!="undefined"&&a!=null){VEValidator.ValidateInt(a,"Opacity");if(a<0||a>1)throw new VEException("VEMap:AddLayer","err_invalidOpacity",l968wt);this.Opacity=a}if(b!="undefined"&&b!=null){VEValidator.ValidateInt(b,"ZIndex");this.ZIndex=b}}function VELayerManager(a){var b=this;VEValidator.ValidateNonNull(a,"vemap");this.m_vemap=a;this.m_vemapcontrol=this.m_vemap.vemapcontrol;this.m_velayers=[];this.m_veLatLongDecoder=new VELatLongDecoder;this.m_spec=new VELatLongFactorySpecFromMap(this.m_vemap);var d=new VELatLongFactory(this.m_spec);this.AddLayer=function(a){VEValidator.ValidateObject(a,"veLayerSpec",VELayerSpecification,"VELayerSpecification");VEValidator.ValidateLayerType(a.Type,"veLayerSpec.Type");VEValidator.ValidateNonNull(a.ID,"veLayerSpec.ID");VEValidator.ValidateNonNull(a.LayerSource,"veLayerSpec.LayerSource");if(a.Type==VELayerType.GeoRSS){VEValidator.ValidateNonNull(a.Method,"veLayerSpec.Method");this.AddGeoRSSLayer(a)}else if(a.Type==VELayerType.VECollection)this.AddVECollectionLayer(a);else if(a.Type==VELayerType.VETileSource)this.AddVETileLayer(a);else throw new VEException("VEMap:AddLayer","err_invalidlayertype",l368st)};this.AddGeoRSSLayer=function(a){VEMap.ValidateState();try{var c=this.GetLayerById(a.ID);if(c!=null&&c!="undefined")throw new VEException("VELayerManager:AddGeoRSSLayer","err_invalidlayerid",l32rt);var b=new VELayer(a,VENetwork.GetExecutionID(),this);this.m_velayers.push(b);VENetwork.DownloadXml(a.LayerSource,a.Method,b.AddGeoRSSLayerCallback)}catch(d){throw d}};this.AddVECollectionLayer=function(c){VEMap.ValidateState();try{var e=this.GetLayerById(c.ID);if(e!=null&&e!="undefined")throw new VEException("VELayerManager:AddCollectionLayer","err_invalidlayerid",l32rt);var b=new VELayer(c,VENetwork.GetExecutionID(),this);this.m_velayers.push(b);var a=[];a.push(new VEParameter("action",VE_AnnotationActions.RetrieveAll));a.push(new VEParameter(VE_CollectionsManagerConstants.C_Id,b.Spec.LayerSource));a.push(new VEParameter(VE_CollectionsManagerConstants.Market,Msn.VE.API.Globals.language));a.push(new VEParameter(Msn.VE.API.Constants.mapguid,this.m_vemap.GUID));a.push(new VEParameter(Msn.VE.API.Constants.contextid,b.GUID));var d=new VENetwork;d.ServiceUrl=Msn.VE.API.Constants.collectionservice;d.BeginInvoke(null,a,null)}catch(f){throw f}};this.AddVETileLayer=function(b){VEMap.ValidateState();try{if(a.m_vetilesourcemanager.GetSourceById(b.LayerSource)!=null){var c=this.GetLayerById(b.ID);if(c!=null&&c!="undefined")throw new VEException("VELayerManager:AddVETileLayer","err_invalidlayerid",l32rt);var d=new VELayer(b,VENetwork.GetExecutionID(),this);this.m_velayers.push(d);a.vemapcontrol.LoadTileLayer(b.ID,b.LayerSource,b.Opacity,b.ZIndex)}else throw new VEException("VEMap:AddVETileLayer","err_invalidsourceid",l975ut)}catch(e){throw e}};this.GetLayerById=function(c){var b=this.m_velayers.length;for(var a=0;a<b;++a)if(this.m_velayers[a].Spec.ID==c)return this.m_velayers[a];return null};this.GetLayerByGUID=function(c){var b=this.m_velayers.length;for(var a=0;a<b;++a)if(this.m_velayers[a].GUID==c)return this.m_velayers[a];return null};this.AddGeoRSSLayerPushpins=function(s,e){var p=[],m=null,l=null,n=null,h=null,f=null,b=null,a=s.getElementsByTagName("item");if(a.length>0)for(i=0;i<a.length;i++){count=i;for(j=0;j<a[i].childNodes.length;j++){if(a[i].childNodes[j].nodeType!=1)continue;if(a[i].childNodes[j].nodeName=="title")if(a[i].childNodes[j].firstChild)m=a[i].childNodes[j].firstChild.nodeValue;else m="";else if(a[i].childNodes[j].nodeName=="description")if(a[i].childNodes[j].firstChild)l=a[i].childNodes[j].firstChild.nodeValue;else l="";else if(a[i].childNodes[j].nodeName=="link")n=a[i].childNodes[j].firstChild.nodeValue;else if(a[i].childNodes[j].nodeName=="icon")h=a[i].childNodes[j].firstChild.nodeValue;else if(a[i].childNodes[j].nodeName=="virtualearth:icon")h=a[i].childNodes[j].firstChild.nodeValue;else if(a[i].childNodes[j].nodeName=="geo:lat")f=a[i].childNodes[j].firstChild.nodeValue;else if(a[i].childNodes[j].nodeName=="geo:lon")b=a[i].childNodes[j].firstChild.nodeValue;else if(a[i].childNodes[j].nodeName=="geo:long")b=a[i].childNodes[j].firstChild.nodeValue;else if(a[i].childNodes[j].nodeName=="geo:Point"||a[i].childNodes[j].nodeName=="geo:point")for(k=0;k<a[i].childNodes[j].childNodes.length;k++){var g=a[i].childNodes[j].childNodes[k];if(g.nodeName=="geo:lat")f=g.firstChild.nodeValue;else if(g.nodeName=="geo:lon"||g.nodeName=="geo:long")b=g.firstChild.nodeValue}else if(a[i].childNodes[j].nodeName=="georss:point"){if(a[i].childNodes[j].firstChild){var o=a[i].childNodes[j].firstChild.nodeValue;latlon=c(o);if(latlon.length>1){f=latlon[0];b=latlon[1]}}}else if(a[i].childNodes[j].nodeName=="gml:name")if(a[i].childNodes[j].firstChild)m=a[i].childNodes[j].firstChild.nodeValue;else m="";else if(a[i].childNodes[j].nodeName=="gml:description")if(a[i].childNodes[j].firstChild)l=a[i].childNodes[j].firstChild.nodeValue;else l="";else if(a[i].childNodes[j].nodeName=="gml:Point"||a[i].childNodes[j].nodeName=="gml:point")for(k=0;k<a[i].childNodes[j].childNodes.length;k++){g=a[i].childNodes[j].childNodes[k];if(g.nodeName=="gml:pos")if(g.firstChild){o=g.firstChild.nodeValue;latlon=c(o);if(latlon.length>1){f=latlon[0];b=latlon[1]}}}else if(a[i].childNodes[j].nodeName=="gml:pos")if(a[i].childNodes[j].firstChild){o=a[i].childNodes[j].firstChild.nodeValue;latlon=c(o);if(latlon.length>1){f=latlon[0];b=latlon[1]}}}if(f==null||f=="undefined"||f.length<=0||b==null||b=="undefined"||b.length<=0)continue;if(e.Spec.IconUrl!=null&&e.Spec.IconUrl!="undefined")h=e.Spec.IconUrl;if(h==null||h=="undefined"||h.length<=0)h=Msn.VE.API.Constants.iconurl;var q=l;if(n!=null&&n!="undefined")q+="<p><a href='"+n+'\' class="VE_Pushpin_Popup_Link" target=_blank>. . .</a></p>';var t="Layer"+e.Spec.ID+"_"+i;try{var r=new VEPushpin(t,d.CreateVELatLong(f,b),h,m,q);r.IsInLayer=true;p.push(r)}catch(u){this.m_vemap.ShowMessage(u.message)}}else this.m_vemap.ShowMessage(l872xt);e.Pins=p;this.Show(e.Spec.ID);if(e.Spec.FnCallback!=null&&e.Spec.FnCallback!="undefined")e.Spec.FnCallback(p)};function c(a){a=a.replace(/^\s+/g,"");a=a.replace(/\s+$/g,"");var b=[];if(a.indexOf(",")>0)b=a.split(",");else{a=a.replace(/\s+/g," ");b=a.split(" ")}return b}this.RetrieveAllAnnotationsCallback=function(e,h){if(h!="undefined"&&h!=null){var a=b.GetLayerByGUID(h);if(a!=null&&a!="undefined"){var m=Msn.VE.API.Constants.iconurl;if(a.Spec.IconUrl!=null&&a.Spec.IconUrl!="undefined")m=a.Spec.IconUrl;var i=[];for(var c=0;c<e.length;++c){var j=IOSec.EncodeHtml(e[c].Title),o=IOSec.EncodeHtml(e[c].Notes),g=b.GetValidatedUrl(e[c].Url),p=e[c].Latitude,q=e[c].Longitude,f=b.GetValidatedUrl(e[c].PhotoUrl),k=o,l="Layer"+a.Spec.ID+"_"+c;if(f!=null&&f!="undefined"&&f.length>1)j='<a href="" onclick="window.open(\''+f+"', '_blank' , 'menubar=0,resizable=1,scrollbars=0,status=0,titlebar=0,toolbar=0,width=800,height=600,screenX=200,left=200,screenY=200,top=200');return false;\"><img border=0 id=eroImg_"+l+' style="position: relative; display: block; padding-right: 10px; padding-left: 0px; padding-bottom: 5px; padding-top: 3px; width: 80px; height: 80px; float: left;" src="'+IOSec.EncodeHtml(f)+'"/></a>'+j;if(g!=null&&g!="undefined"&&g.length>0)k+="<p><a href='"+g+'\' class="VE_Pushpin_Popup_Link" target=_blank>. . .</a></p>';var n=new VEPushpin(l,d.CreateVELatLong(p,q),m,j,k);n.IsInLayer=true;i.push(n)}a.Pins=i;b.Show(a.Spec.ID);if(a.Spec.FnCallback!=null&&a.Spec.FnCallback!="undefined")a.Spec.FnCallback(i)}}}}VELayerManager.prototype.Dispose=function(){this.DeleteAllLayers();this.m_velayers=null;this.m_vemapcontrol=null;this.m_vemap=null;this.m_veLatLongDecoder=null;this.m_spec=null};VELayerManager.prototype.Show=function(g){VEMap.ValidateState();try{VEValidator.ValidateNonNull(g,"layerId");var d=this.GetLayerById(g);if(d!=null&&d!="undefined"){var b=[],e=d.Pins,h=e.length;for(var c=0;c<h;c++){var f=new Object,a=e[c].LatLong;if(this.m_spec.IsEncode())a=this.m_veLatLongDecoder.Decode(a);f.latitude=a.Latitude;f.longitude=a.Longitude;b.push(f);try{this.m_vemap.AddPushpin(e[c])}catch(i){}}if(b!=null&&b.length>0)this.m_vemapcontrol.SetBestMapView(b)}else throw new VEException("VEMap:RemoveLayerbyId","err_invalidlayerid",l32rt)}catch(i){throw i}};VELayerManager.prototype.Hide=function(b){VEMap.ValidateState();try{VEValidator.ValidateNonNull(b,"layerId");var a=this.GetLayerById(b);if(a!=null&&a!="undefined")try{this.DeletePushpinsForLayer(a)}catch(c){}else throw new VEException("VEMap:RemoveLayerbyId","err_invalidlayerid",l32rt)}catch(c){throw c}};VELayerManager.prototype.DeleteAllLayers=function(){var b=this.m_velayers.length;for(var a=0;a<b;++a){this.DeletePushpinsForLayer(this.m_velayers[a]);this.m_velayers[a].Dispose()}this.m_velayers=[]};VELayerManager.prototype.HideAllLayers=function(){var b=this.m_velayers.length;for(var a=0;a<b;++a)this.Hide(this.m_velayers[a].Spec.ID)};VELayerManager.prototype.ShowAllLayers=function(){var b=this.m_velayers.length;for(var a=0;a<b;++a)this.Show(this.m_velayers[a].Spec.ID)};VELayerManager.prototype.DeleteLayer=function(a){this.DeleteLayerById(a.Spec.ID)};VELayerManager.prototype.DeleteLayerById=function(c){try{if(this.m_velayers==null||this.m_velayers=="undefined"){throw new VEException("VEMap:RemoveLayerbyId","err_GraphicsInitError",L_GraphicsInitError_Text);return}var b=this.m_velayers.length,a=0;while(a<b&&c!=this.m_velayers[a].Spec.ID)a++;if(a<b){if(this.m_velayers[a].Spec.Type==VELayerType.VETileSource)this.m_vemap.vemapcontrol.ClearTileLayer(c);else try{this.DeletePushpinsForLayer(this.m_velayers[a])}catch(d){}this.m_velayers[a].Dispose();this.m_velayers[a]=null;this.m_velayers.splice(a,1)}else{throw new VEException("VEMap:RemoveLayerbyId","err_invalidlayerid",l32rt);return}}catch(d){throw d;return}};VELayerManager.prototype.DeletePushpinsForLayer=function(b){VEMap.ValidateState();VEValidator.ValidateNonNull(b,"layer");try{var c=b.Pins,d=c.length;for(var a=0;a<d;a++)this.m_vemap.DeletePushpin(c[a].ID)}catch(e){throw e;return}};VELayerManager.prototype.DeleteLayerBySourceId=function(b){try{if(this.m_velayers==null||this.m_velayers=="undefined"){throw new VEException("VEMap:RemoveLayerbyId","err_GraphicsInitError",L_GraphicsInitError_Text);return}for(var a=0;a<this.m_velayers.length;a++)if(this.m_velayers[a]!=null&&this.m_velayers[a]!="undefined"&&this.m_velayers[a].Spec.LayerSource==b){this.m_velayers[a].Dispose();this.m_velayers[a]=null;this.m_velayers.splice(a,1)}}catch(c){throw c;return}};VELayerManager.prototype.GetValidatedUrl=function(a){if(a==null||a=="undefined"||a.length<=0)return "";try{a=unescape(a);a=a.replace(/\|/g," ").replace(/\^/g," ").replace(/^\s+/g,"").replace(/\s+$/g,"");var b=new RegExp(/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/);if(a.match(b))return a;else return ""}catch(c){return ""}};function VELayer(a,d,c){VEValidator.ValidateObject(a,"veLayerSpec",VELayerSpecification,"VELayerSpecification");this.Spec=a;this.GUID=d;this.Pins=[];var b=this;this.m_veLayerManager=c;this.AddGeoRSSLayerCallback=function(a){b.m_veLayerManager.AddGeoRSSLayerPushpins(a,b)};this.Dispose=function(){for(var a=0;a<this.Pins.length;++a)if(this.Pins[a]!=null&&this.Pins[a]!="undefined"){this.Pins[a].Dispose();this.Pins[a]=null}this.Pins=null;this.GUID=null;this.Spec=null;this.m_veLayerManager=null}}function VELatLong(b,a){try{this.Latitude=null;this.Longitude=null;this._reserved=null;if(b!=null&&b!="undefined"){VEValidator.ValidateFloat(b,"latitude");this.Latitude=b}if(a!=null&&a!="undefined"){VEValidator.ValidateFloat(a,"longitude");this.Longitude=a}}catch(c){throw c;return}}function Clone(){var a=new VELatLong;a.Latitude=this.Latitude;a.Longitude=this.Longitude;a._reserved=this._reserved;return a}function toString(){var a="";if(this.Latitude!=null&&this.Longitude!=null)a=this.Latitude+", "+this.Longitude;return a}VELatLong.prototype.toString=toString;VELatLong.prototype.Clone=Clone;function VELatLongRectangle(d,c,b,a){VEValidator.ValidateObject(d,"topLeftLatLong",VELatLong,"VELatLong");VEValidator.ValidateObject(c,"bottomRightLatLong",VELatLong,"VELatLong");this.TopLeftLatLong=d;this.BottomRightLatLong=c;if(b!=null&&b!="undefined"){VEValidator.ValidateObject(b,"topRightLatLong",VELatLong,"VELatLong");this.TopRightLatLong=b}if(a!=null&&a!="undefined"){VEValidator.ValidateObject(a,"bottomLeftLatLong",VELatLong,"VELatLong");this.BottomLeftLatLong=a}}function VELatLongDecoder(){var a=new VELatLongEncoding;this.Decode=function(c){VEValidator.ValidateObject(c,"veLatLong",VELatLong,"VELatLong");var b=c.Clone();if(b.Latitude==null||b.Longitude==null&&b._reserved!=null){var d=a.Decode(b._reserved);b.Latitude=d[0];b.Longitude=d[1];b._reserved=null}return b}}function VELatLongFactoryAlwaysEncodeSpec(){this.IsEncode=function(){return true}}function VELatLongFactorySpecFromMap(a){VEValidator.ValidateObject(a,"vemap",VEMap,"VEMap");var b=a;this.IsEncode=function(){return b.GetMapStyle()==VEMapStyle.Birdseye}}function VELatLongFactorySpecFromMapView(a){VEValidator.ValidateNonNull(a,"mapView");var b=a;this.IsEncode=function(){return b.mapStyle==Msn.VE.MapStyle.Oblique}}function VELatLongFactory(a){VEValidator.ValidateNonNull(a,"veLatLongFactorySpec");var c=a,b=new VELatLongEncoding;this.CreateVELatLong=function(e,d){var a=null;if(c.IsEncode()){a=new VELatLong;a._reserved=b.Encode(e,d)}else a=new VELatLong(e,d);return a}}function VEPolyline(d,c,a,b){VEValidator.ValidateNonNull(d,"id");VEValidator.ValidateNonNull(c,"arrVELatLong");this.ID=d;this.LatLongs=c;this.Stroke=new Msn.Drawing.Stroke;if(a==null||a=="undefined")a=new VEColor(17,221,17,0.7);this.SetColor(a);if(b==null||b=="undefined")b=6;this.SetWidth(b)}function SetColor(a){$VE_A.LogAPI("VE | APIs","VEPolyline - SetColor");VEValidator.ValidateNonNull(a);this.Stroke.color=new Msn.Drawing.Color(a.R,a.G,a.B,a.A)}function SetWidth(a){$VE_A.LogAPI("VE | APIs","VEPolyline - SetWidth");VEValidator.ValidateInt(a,"width");this.Stroke.width=a}function GetLatLongs(){return this.LatLongs}function Dispose(){this.ID=null;this.LatLongs=null;this.Stroke=null}VEPolyline.prototype.SetColor=SetColor;VEPolyline.prototype.SetWidth=SetWidth;VEPolyline.prototype.GetLatLongs=GetLatLongs;VEPolyline.prototype.Dispose=Dispose;function VEPolygon(e,d,c,a,b){VEValidator.ValidateNonNull(e,"id");VEValidator.ValidateNonNull(d,"arrVELatLong");this.ID=e;this.LatLongs=d;this.Stroke=new Msn.Drawing.Stroke;if(c==null||c=="undefined")c=new VEColor(17,221,17,0.7);this.SetFillColor(c);if(a==null||a=="undefined")a=new VEColor(17,221,17,0.7);this.SetOutlineColor(a);if(b==null||b=="undefined")b=6;this.SetOutlineWidth(b)}function SetFillColor(a){$VE_A.LogAPI("VE | APIs","VEPolygon - SetFillColor");VEValidator.ValidateNonNull(a);this.Stroke.fillcolor=new Msn.Drawing.Color(a.R,a.G,a.B,a.A)}function SetOutlineColor(a){$VE_A.LogAPI("VE | APIs","VEPolygon - SetOutlineColor");VEValidator.ValidateNonNull(a);this.Stroke.color=new Msn.Drawing.Color(a.R,a.G,a.B,a.A)}function SetOutlineWidth(a){$VE_A.LogAPI("VE | APIs","VEPolygon - SetOutlineWidth");VEValidator.ValidateInt(a,"width");this.Stroke.width=a}function GetLatLongs(){return this.LatLongs}function Dispose(){this.ID=null;this.LatLongs=null;this.Stroke=null}VEPolygon.prototype.SetFillColor=SetFillColor;VEPolygon.prototype.SetOutlineColor=SetOutlineColor;VEPolygon.prototype.SetOutlineWidth=SetOutlineWidth;VEPolygon.prototype.GetLatLongs=GetLatLongs;VEPolygon.prototype.Dispose=Dispose;function VEColor(d,c,b,a){try{VEValidator.ValidateInt(d,"r");VEValidator.ValidateInt(c,"g");VEValidator.ValidateInt(b,"b");VEValidator.ValidateFloat(a,"a");this.R=d;this.G=c;this.B=b;this.A=a}catch(e){throw e;return}}VE_CollectionActions=function(){};VE_CollectionActions.Create="CreateCollection";VE_CollectionActions.Update="UpdateCollection";VE_CollectionActions.RetrieveAll="RetrieveAllCollections";VE_CollectionActions.RetrieveDetails="RetrieveCollectionDetails";VE_CollectionActions.Delete="DeleteCollection";VE_CollectionActions.DeleteAll="DeleteAllCollections";VE_CollectionActions.DeleteAllAnnotations="DeleteAllAnnotations";VE_AnnotationActions=function(){};VE_AnnotationActions.Create="CreateAnnotation";VE_AnnotationActions.Delete="DeleteAnnotation";VE_AnnotationActions.Update="UpdateAnnotation";VE_AnnotationActions.RetrieveAll="RetrieveAllAnnotations";VE_AnnotationState=function(){};VE_AnnotationState.None="None";VE_AnnotationState.Added="Added";VE_AnnotationState.Updated="Updated";VE_AnnotationState.Deleted="Deleted";VE_CollectionsManagerConstants=function(){};VE_CollectionsManagerConstants.Handler="UserCollections.aspx?action=";VE_CollectionsManagerConstants.Market="mkt=";VE_CollectionsManagerConstants.Random="rand=";VE_CollectionsManagerConstants.A_Id="aid";VE_CollectionsManagerConstants.A_Title="atitle";VE_CollectionsManagerConstants.A_Latitude="alatitude";VE_CollectionsManagerConstants.A_Longitude="alongitude";VE_CollectionsManagerConstants.A_Notes="anotes";VE_CollectionsManagerConstants.A_Keywords="akeywords";VE_CollectionsManagerConstants.A_IconId="aiconid";VE_CollectionsManagerConstants.A_InfoUrl="aurl";VE_CollectionsManagerConstants.A_PhotoUrl="aphotourl";VE_CollectionsManagerConstants.A_UserDate="auserdate";VE_CollectionsManagerConstants.A_DisplayOrder="adisplayorder";VE_CollectionsManagerConstants.A_BusinessId="abusinesslistingid";VE_CollectionsManagerConstants.A_CreationId="acreationid";VE_CollectionsManagerConstants.A_State="astate";VE_CollectionsManagerConstants.C_Id="cid";VE_CollectionsManagerConstants.C_Name="cname";VE_CollectionsManagerConstants.C_IsPublic="cispublic";VE_CollectionsManagerConstants.C_Length="cannotationcount";VE_CollectionsManagerConstants.C_Keywords="ckeywords";VE_CollectionsManagerConstants.ViewerDefaultTitle=l690Nt;VE_CollectionsManagerConstants.MinimizedTimerDelay=1;VE_CollectionsManagerConstants.TimerDelay=2000;VE_CollectionsManagerConstants.ExtendedTimerDelay=5000;VE_CollectionsManagerConstants.MAX_COLLECTION_SIZE=200;VE_CollectionsManagerConstants.HELP_FILE_PATH="/cPublicPrivate.htm";VE_Annotation=function(m,k,l,g,h,j,f,e,b,c,i,d,a){this.Id=0;if(typeof m!="undefined"&&m!=null)this.Id=m;this.Title=l696Pt;if(typeof k!="undefined"&&k!=null)this.Title=unescape(k);this.Latitude=0;if(typeof f!="undefined"&&f!=null)this.Latitude=f;this.Longitude=0;if(typeof e!="undefined"&&e!=null)this.Longitude=e;this.Notes="";if(typeof j!="undefined"&&j)this.Notes=unescape(j);if(a!=null&&a.length>0&&a[0]!=null){this.Keywords=a;this.Keywords[0]=unescape(this.Keywords[0])}else this.Keywords=a;this.Url="";if(typeof l!="undefined"&&l)this.Url=l;this.PhotoUrl="";if(typeof g!="undefined"&&g)this.PhotoUrl=g;this.UserDate=Date();if(typeof h!="undefined"&&h!=null)this.UserDate=h;this.DisplayOrder=0;if(typeof c!="undefined"&&c!=null)this.DisplayOrder=c;this.BusinessListingId=0;if(typeof b!="undefined"&&b!=null)this.BusinessListingId=b;this.IconId=0;if(typeof i!="undefined"&&i!=null)this.IconId=i;this.LastModified=Date();if(typeof d!="undefined"&&d!=null)this.LastModified=d;this.Delta=0;this.MoveUp=function(){this.Delta=this.Delta-1};this.MoveDown=function(){this.Delta=this.Delta+1};this.State=VE_AnnotationState.None;this.PushPin="";this._cacheOfSerializationLength=0};VE_Annotation.prototype.GetCacheOfSerializationLength=function(){if(this._cacheOfSerializationLength<=0){var a=VE_CookieSerializer.SerializeAnnotation(this);if(a!=null)this._cacheOfSerializationLength=a.length}return this._cacheOfSerializationLength};VE_Annotation.prototype.InvalidateCacheOfSerializationLength=function(){this._cacheOfSerializationLength=0};VE_Annotation.prototype.index=0;VE_Annotation.prototype.SetIndex=function(a){this.index=a};VE_Annotation.prototype.GetIndex=function(){return this.index};VE_Annotation.prototype.SetDisplayOrder=function(a){this.DisplayOrder=a};VE_Annotation.prototype.GetDisplayOrder=function(){return this.DisplayOrder};VE_Annotation.prototype.SetProperties=function(b,i,j,e,f,h,l,k,c,g,d,a){if(b)this.Id=b;this.Title=unescape(i.replace(/%0D%0A/g,"\r\n").replace(/%0A/g,"\n"));this.Notes=unescape(h.replace(/%0D%0A/g,"\r\n").replace(/%0A/g,"\n"));if(a!=null&&a.length>0&&a[0]!=null){this.Keywords=a;this.Keywords[0]=this.Keywords[0].replace(/%0D%0A/g,"\r\n").replace(/%0A/g,"\n")}else this.Keywords=a;this.Url=unescape(j);this.PhotoUrl=unescape(e);this.UserDate=f;this.BusinessListingId=c;this.IconId=g;this.LastModified=d};VE_Annotation.prototype.symbolUrl="samplesymbol";VE_Annotation.prototype.GetMsnId=function(){return this.Id};VE_Annotation.prototype.SetMsnId=function(a){this.Id=a};VE_Annotation.prototype.SetBoundingBox=function(f,e,c,d,a,b){if(typeof this.Boundingbox=="undefined"||this.Boundingbox==null){if(c==null||d==null||a==null||b==null)return null;this.Boundingbox=new Msn.VE.Bounds(f,e,c,d,a,b)}else{this.Boundingbox.x1=c;this.Boundingbox.y1=d;this.Boundingbox.z1=f;this.Boundingbox.x2=a;this.Boundingbox.y2=b;this.Boundingbox.z2=e}return this.Boundingbox};VE_Annotation.prototype.GetBoundingBox=function(){if(typeof this.Boundingbox=="undefined"||!this.Boundingbox)this.Boundingbox=new Msn.VE.Bounds(0,0,Infinity,Infinity,-Infinity,-Infinity);return this.Boundingbox};VE_Annotation.prototype.GetCenterPoint=function(){if(!this.GetBoundingBox())return;var a=new Array(2);a[0]=(this.GetBoundingBox().x1+this.GetBoundingBox().x2)/2;a[1]=(this.GetBoundingBox().y1+this.GetBoundingBox().y2)/2;return a};VE_Annotation.prototype.SetId=function(a){this.iid=a};VE_Annotation.prototype.GetId=function(){if(typeof this.iid=="undefined"||this.iid==0||this.iid==null)this.iid=Msn.Drawing.GetGeoUID(MC_GEO_TYPE_ENTITY);return this.iid};VE_Annotation.prototype.SetVisibility=function(a){this.Visibility=a};VE_Annotation.prototype.GetVisibility=function(){if(typeof this.Visibility=="undefined"||typeof this.Visibility=="null")this.Visibility=true;return this.Visibility};VE_Annotation.prototype.SetBusinessListingId=function(a){if(typeof a=="undefined"||a=="null")this.BusinessListingId=0;else this.BusinessListingId=a};VE_Annotation.prototype.GetBusinessListingId=function(){if(typeof this.BusinessListingId=="undefined"||this.BusinessListingId==null||this.BusinessListingId=="null")this.BusinessListingId=0;return this.BusinessListingId};VE_Annotation.prototype.SetType=function(a){this.Type=a};VE_Annotation.prototype.GetType=function(){if(typeof this.Type=="undefined")this.Type="aN";return this.Type};VE_Annotation.prototype.SetSaveStatus=function(a){this.SaveStatus=a};VE_Annotation.prototype.IsSaved=function(){if(typeof this.SaveStatus=="undefined")this.SaveStatus=true;return this.SaveStatus};VE_Annotation.prototype.SetOnScratchpad=function(a){this.OnScratchpad=a};VE_Annotation.prototype.IsOnScratchpad=function(){if(typeof this.OnScratchpad=="undefined")this.OnScratchpad=true;return this.OnScratchpad};VE_Annotation.prototype.SetZoomLevel=function(a){this.ZoomLevel=a};VE_Annotation.prototype.GetZoomLevel=function(){if(typeof this.ZoomLevel=="undefined")this.ZoomLevel=12;return this.ZoomLevel};VE_Annotation.prototype.SetChangeState=function(a){this.ChangeState=a};VE_Annotation.prototype.GetChangeState=function(){if(typeof this.ChangeState=="undefined")this.ChangeState=MC_CHANGE_STATE_DEFAULT;return this.ChangeState};VE_Annotation.prototype.SetChangeType=function(a){this.ChangeType=a};VE_Annotation.prototype.GetChangeType=function(){if(typeof this.ChangeType=="undefined")this.ChangeType=MC_CHANGE_TYPE_ALL;return this.ChangeType};VE_Annotation.prototype.SetName=function(a){this.Title=a};VE_Annotation.prototype.GetName=function(){if(typeof this.Title=="undefined")this.Title=l696Pt;return this.Title};VE_Annotation.prototype.GetPrimitiveCount=function(){if(typeof this.Primitives=="undefined"||this.Primitives==null){this.Primitives=[];return 0}return this.Primitives.length};VE_Annotation.prototype.SetPrimitives=function(a){this.Primitives=a;this.SetType(a[0].type)};VE_Annotation.prototype.GetPrimitives=function(){if(typeof this.Primitives=="undefined"||this.Primitives==null)this.Primitives=[];return this.Primitives};VE_Annotation.prototype.GetPrimitive=function(a){if(typeof this.Primitives=="undefined"||this.Primitives==null||this.Primitives.length==0){this.Primitives=[];return null}if(a<this.Primitives.length)return this.Primitives[a];else return this.Primitives[0]};VE_Annotation.prototype.AddPrimitive=function(a){if(typeof this.Primitives=="undefined"||this.Primitives==null)this.Primitives=[];this.Primitives.push(a);this.SetType(a.type)};VE_Annotation.prototype.DeletePrimitive=function(c){if(typeof this.Primitives=="undefined"||this.Primitives==null){this.Primitives=[];return null}if(this.Primitives.length==1){this.Primitives[0].Destroy();this.Primitives.pop();this.Primitives=[];return null}var b=null;for(var a=0;a<this.Primitives.length;a++){b=this.Primitives[a];if(b.iid==c){this.Primitives[a].splice(a,1);break}}if(b)b.Destroy()};VE_Annotation.prototype.ClearAllPrimitives=function(){if(typeof this.Primitives=="undefined"||this.Primitives==null){this.Primitives=[];return}for(var a=0;a<this.Primitives.length;a++)this.Primitives[a].Destroy();this.Primitives=[]};VE_Annotation.prototype.Update=function(j,h){var b=false,l=this.GetId().split(MC_IID_CON_TOKEN);if(l[0]==MC_IID_NAMESPACE)b=true;else{b=false;if(!h)return false;var k=h.split(MC_IID_CON_TOKEN);if(k[0]!=MC_IID_NAMESPACE)return false}var m=this.Primitives.length,a=null,d=Infinity,f=Infinity,e=-Infinity,g=-Infinity;for(var i=0;i<m;i++){a=this.Primitives[i];if(a.type!=MC_GEO_TYPE_POINT){if(!b||j||(a.minX==null||a.minY==null||a.maxX==null||a.maxY==null)){var c=Msn.Drawing.ComputeBoundingBox(a.points);if(c){a.minX=c[0];a.minY=c[1];a.maxX=c[2];a.maxY=c[3]}}d=Math.min(a.minX,d);f=Math.min(a.minY,f);e=Math.max(a.maxX,e);g=Math.max(a.maxY,g);Msn.Drawing.CalculateLabelPosition(a);this.Longitude=a.labelPosX;this.Latitude=a.labelPosY}else{d=Math.min(a.points[0],d);f=Math.min(a.points[1],f);e=Math.max(a.points[0],e);g=Math.max(a.points[1],g);this.Longitude=a.points[0];this.Latitude=a.points[1]}if(!b)a.iid=h+MC_IID_CON_TOKEN+this.GetId()+MC_IID_CON_TOKEN+a.iid;a.title=this.GetName();if(a.shape!=null)a.shape.id=a.iid}this.SetBoundingBox(0,0,d,f,e,g);if(!b)this.SetId(h+MC_IID_CON_TOKEN+this.GetId());this.guid=this.GetId();return this.GetBoundingBox()};VE_Annotation.prototype.ToString=function(){var a="<e>",f=this.Primitives.length,d=null;for(var e=0;e<f;e++){d=this.Primitives[e];if(d.type==MC_GEO_TYPE_POINT)a=a.concat("<coords>",d.points.join(","),"</coords>")}var b="<a>",c="</a>";a=a.concat("<as>");a=a.concat(b,this.GetBusinessListingId(),c,b,this.Url,c,b,this.PhotoUrl,c,b,this.Title,c,b,this.Type,c);a=a.concat("</as>");a=a.concat("</e>");return a};L_integerencodingoutofrange_text="VEIntegerEncoding: The number encoded is out of supported range";L_floatintegermapencodingoutofrange_text="VEFloatIntegerMap: The number encoded is out of supported range";L_integerencodinginvalidstringlength_text="VEIntegerEncoding: Invalid string length";L_integerencodingunknowndigit_text="VEIntegerEncoding: The encoded string has an unknown digit";function VEIntegerEncoding(g,j){var e=g,d=g.length,a=j,h=1;for(var i=0;i<a;++i)h*=d;var f=h-1,c=[];for(var b=0;b<e.length;++b)c[e.substr(b,1)]=b;this.MaxValue=function(){return f};this.ValueLength=function(){return a};this.Encode=function(c){if(c<=f){var h="",g=[];for(var b=0;b<a;++b)g[b]=0;var i=a-1;while(c>0){g[i]=Math.floor(c%d);c=Math.floor(c/d);--i}for(b=0;b<g.length;++b)h+=e.substr(g[b],1);return h}else throw L_integerencodingoutofrange_text};this.Decode=function(c){if(c.length==a){var b=0;for(var e=0;e<c.length;++e){b*=d;b+=this.DigitValue(c.substr(e,1))}return b}else throw L_integerencodinginvalidstringlength_text};this.DigitValue=function(a){if(c[a]!=null&&c[a]!="undefined")return c[a];else throw L_integerencodingunknowndigit_text}}function VEFloatIntegerMap(e,d,f){var a=e,c=d,b=f;this.MinFloat=function(){return a};this.MaxFloat=function(){return c};this.MaxInt=function(){return b};this.FloatToInt=function(d){if(d>=a&&d<=c){var e=(d-a)/(c-a),f=e*b+0.5;return Math.min(Math.floor(f),b)}else throw L_floatintegermapencodingoutofrange_text};this.IntToFloat=function(d){if(d<=b){var f=d/b,e=a+f*(c-a);return e}else throw L_floatintegermapencodingoutofrange_text}}L_velatlongencodinginvalidstringlength_text="VELatLongEncoding: Invalid string length";function VELatLongEncoding(){var g=-90,f=90,e=-180,d=180,i="0123456789bcdfghjkmnpqrstvwxyz",h=6,a=new VEIntegerEncoding(i,h),c=new VEFloatIntegerMap(g,f,a.MaxValue()),b=new VEFloatIntegerMap(e,d,a.MaxValue());this.Encode=function(e,d){var f=a.Encode(c.FloatToInt(e))+a.Encode(b.FloatToInt(d));return f};this.Decode=function(f){if(f.length==2*a.ValueLength()){var e=a.ValueLength(),j=f.substr(0,e),h=f.substr(e,e),i=a.Decode(j),g=a.Decode(h),d=[];d[0]=c.IntToFloat(i);d[1]=b.IntToFloat(g);return d}else throw L_velatlongencodinginvalidstringlength_text}}VEMapMode=new function(){this.Mode2D=1;this.Mode3D=2};function VEMapViewSpecification(c,d,e,g,f){try{this.LatLong=null;this.ZoomLevel=null;this.Altitude=null;this.Pitch=null;this.Heading=null;if(c!=null&&c!="undefined"){VEValidator.ValidateObject(c,"veLatLong",VELatLong,"VELatLong");this.LatLong=c}if(d!=null&&d!="undefined"){VEValidator.ValidateInt(d,"zoomLevel");this.ZoomLevel=d}if(e!=null&&e!="undefined"){VEValidator.ValidateFloat(e,"altitude");this.Altitude=parseFloat(e)}if(g!=null&&g!="undefined"){VEValidator.ValidateFloat(g,"pitch");var a=parseFloat(g);a=a%360;if(a<-90)a=-90;if(a>90)a=90;this.Pitch=a}if(f!=null&&f!="undefined"){VEValidator.ValidateFloat(f,"heading");var b=parseFloat(f);b=b%360;if(b<0)b+=360;this.Heading=b}}catch(h){throw h;return}}function MapViewSpecClone(){var a=new VEMapViewSpecification;a.LatLong=this.LatLong.Clone();a.Altitude=this.Altitude;a.Pitch=this.Pitch;a.Heading=this.Heading;return veLatLong}VEMapViewSpecification.prototype.Clone=MapViewSpecClone;VEMapStyle=new function(){this.Road=Msn.VE.MapStyle.Road;this.Aerial=Msn.VE.MapStyle.Aerial;this.Hybrid=Msn.VE.MapStyle.Hybrid;this.Oblique=Msn.VE.MapStyle.Oblique;this.Birdseye=Msn.VE.MapStyle.Oblique};VEOrientation=new function(){this.North=Msn.VE.Orientation.North;this.East=Msn.VE.Orientation.East;this.West=Msn.VE.Orientation.West;this.South=Msn.VE.Orientation.South;this.SouthWest="Southwest";this.NorthEast="Northeast";this.SouthEast="Southeast";this.NorthWest="Northwest"};function VEBirdseyeScene(c){VEValidator.ValidateNonNull(c,"obliqueScene");var a=c,d=new VELatLongFactory(new VELatLongFactoryAlwaysEncodeSpec),b=new VELatLongDecoder;this.PixelToLatLong=function(f,g,c){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - PixelToLatLong");var e=new Msn.VE.Pixel(f,g),b=a.PixelToLatLong(e,c);return d.CreateVELatLong(b.latitude,b.longitude)};this.LatLongToPixel=function(d,e){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - LatLongToPixel");VEValidator.ValidateObject(d,"veLatLong",VELatLong,"VELatLong");var c=b.Decode(d),f=new Msn.VE.LatLong(c.Latitude,c.Longitude);return a.LatLongToPixel(f,e)};this.IsValidTile=function(c,d,b){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - IsValidTile");return a.IsValidTile(c,d,b)};this.GetID=function(){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - GetID");return a.GetID()};this.GetTileFilename=function(){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - GetTileFilename");return a.GetTileFilename()};this.GetThumbnailFilename=function(){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - GetThumbnailFilename");return a.GetThumbnailFilename()};this.GetNeighbor=function(d){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - GetNeighbor");var b=null,c=a.neighborScenes[d];if(c!=null){b=new Msn.VE.ObliqueScene(c);return new VEBirdseyeScene(b)}return null};this.GetRotation=function(d){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - GetRotation");var b=null,c=a.GetRotation(d);if(c!=null)b=new VEBirdseyeScene(c);return b};this.GetOrientation=function(){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - GetOrientation");return a.GetOrientation()};this.GetBounds=function(){return a.GetBounds()};this.GetWidth=function(){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - GetWidth");return a.GetWidth()};this.GetHeight=function(){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - GetHeight");return a.GetHeight()};this.ContainsLatLong=function(d){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - ContainsLatLong");VEValidator.ValidateObject(d,"veLatLong",VELatLong,"VELatLong");var c=b.Decode(d),e=new Msn.VE.LatLong(c.Latitude,c.Longitude);return a.ContainsLatLong(e)};this.ContainsPixel=function(d,e,b){$VE_A.LogAPI("VE | APIs","VEBirdseyeScene - ContainsPixel");var c=new Msn.VE.Pixel(d,e);return a.ContainsPixel(c,b)}}function $VE_A(){}function VE_Range(b,a){this.min=b;this.max=a}VE_Range.prototype.IsInRange=function(a){return a>=this.min&&a<=this.max};VE_Range.prototype.toString=function(){return this.min+"-"+this.max};$VE_A.distanceBuckets=new Array(new VE_Range(0,10),new VE_Range(11,25),new VE_Range(26,100),new VE_Range(101,200),new VE_Range(201,500),new VE_Range(501,1000));$VE_A.analyticsEnabled=true;$VE_A.PanLogDelayTimerId=null;$VE_A.AccumulatedPans=0;$VE_A.PanLogDelay=500;$VE_A.LogHelp=function(){$VE_A.Log("VE | Help Pane","Help")};$VE_A.LogAbout=function(){$VE_A.Log("VE | About Pane","About")};$VE_A.LogPrintDetailsPage=function(){$VE_A.Log("VE | Details Page","Print")};$VE_A.LogGetDirectionsDetailsPage=function(){$VE_A.Log("VE | Details Page","Get Directions")};$VE_A.LogGetMoreInfoDetailsPage=function(){$VE_A.Log("VE | Details Page","MSN Search")};$VE_A.LogLocate=function(){$VE_A.Log("VE | Locate Me","Locate Me")};$VE_A.LogResponseTimes=function(){var a=map.GetFailureRate()*100;s.prop33=a.toFixed(1);a=map.GetResponseRangeCounts()[0]*100;s.prop34=a.toFixed(1);a=map.GetResponseRangeCounts()[2]*100;s.prop35=a.toFixed(1);$VE_A.Log("VE | Response Times");map.ResetResponseRangeCounts()};$VE_A.LogZoom=function(){$VE_A.Log(map.GetMapStyle()==Msn.VE.MapStyle.Oblique?"VE | Oblique Imagery":"VE | Home Page","Zoom","Mouse/Game Control/Keyboard")};$VE_A.LogPan=function(){if($VE_A.PanLogDelayTimerId!=null&&typeof $VE_A.PanLogDelayTimerId=="number")window.clearTimeout($VE_A.PanLogDelayTimerId);$VE_A.PanLogDelayTimerId=window.setTimeout("$VE_A.FireLogPan();",$VE_A.PanLogDelay);$VE_A.AccumulatedPans+=1};$VE_A.FireLogPan=function(){$VE_A.PanLogDelayTimerId=null;$VE_A.Log(map.GetMapStyle()==Msn.VE.MapStyle.Oblique?"VE | Oblique Imagery":"Main | VE","PAN","Mouse/Game Control/Keyboard",null,$VE_A.AccumulatedPans);$VE_A.AccumulatedPans=0};$VE_A.FireLog3DPan=function(){$VE_A.Log("Main | VE","3D PAN","Mouse/Game Control/Keyboard",null,0)};$VE_A.LogFailedSearch=function(){s.prop11="No Search Results";$VE_A.Log("VE | Exception","Search")};$VE_A.LogJSWatson=function(a){if(a!=null&&a!="undefined"&&a.length>0){s.prop11=a;$VE_A.Log("VE | Exception","JSWatson")}};$VE_A.LogScrachPadItems=function(){s.prop12=VE_Scratchpad.highWaterCount;$VE_A.Log("VE | Scratch Pad","Exit")};$VE_A.LogAds=function(c,d,g,f,e,b,a){s.events=d;if(c==null||c=="undefined")s.eVar8=$ID("what")?$ID("what").value==l355cDt?"":$ID("what").value:"";else s.eVar8=c;s.eVar9=$ID("where")?$ID("where").value==l341fZt?$VE_A.FormatLatLong(map.GetCenterLatitude(),map.GetCenterLongitude()):$ID("where").value:"";if(d=="Event6")s.eVar11=e;else{s.eVar10=f;if(a!=null&&typeof a!="undefined")s.eVar17=a+""}if(b!=null&&b!="undefined")s.eVar12=b;else s.eVar12="";$VE_A.Log("VE | "+g,null)};$VE_A.SearchDictionary=["","Where-only","What-only","What and Where","Who-only","Who and Where","Q"];$VE_A.LogSearch=function(c,f,g,e){s.events="Event8";s.pageName="Main > SEARCH | VE";var b="%1%2",a=0;if(e)a=a+6;else{if(typeof c=="string"&&c.length>0)switch(g){case VE_SearchType.Business:a=a+2;break;case VE_SearchType.Person:a=a+4;break}if(f)a=a+1}if($VE_A.SearchDictionary.length>a){b=b.replace(/%2/,$VE_A.SearchDictionary[a]);s.eVar13=b.replace(/%1/,"");s.prop6=b.replace(/%1/,"SEARCH ")}else{s.eVar13="";s.prop6=""}var d=$ID("logging");if(d)d.innerHTML=s.t();$VE_A.ResetLogProps()};$VE_A.SetCampaignId=function(a){if(a!=null&&a!=""&&a!="undefined")if(s){s.campaign=a;$VE_A.Log("VE | Home Page","Campaign Page View")}};$VE_A.LogClick2Call=function(a){if(a!=null&&a!="undefined")if(a=="1")$VE_A.Log("VE | Search Pane ERO","C2C call Entry Point");else if(a=="2")$VE_A.Log("VE | Map ERO","C2C call Entry Point");else if(a=="3")$VE_A.Log("VE | Details Page","C2C call Entry Point");else $VE_A.Log("VE | Click-2-Call","C2C call Entry Point");else $VE_A.Log("VE | Click-2-Call","C2C call entry point")};$VE_A.LogSend2Phone=function(a){if(a!=null&&a!="undefined")if(a=="1")$VE_A.Log("VE | Search Pane ERO","S2P call Entry Point");else if(a=="2")$VE_A.Log("VE | Map ERO","S2P call Entry Point");else if(a=="3")$VE_A.Log("VE | Details Page","S2P call Entry Point");else $VE_A.Log("VE | Send-2-Phone","S2P call Entry Point");else $VE_A.Log("VE | Send-2-Phone","S2P call entry point")};$VE_A.LogAPI=function(c,a){return;if(window.s=="undefined"||window.s==null)return;if(!$VE_A.analyticsEnabled)return;s.pageName=c;s.prop6=a?a:"";var b=$ID("logging");if(b)b.innerHTML=s.t();$VE_A.ResetLogProps()};$VE_A.LogGeoCommunity=function(c,a,b){if(window.s=="undefined"||window.s==null)return;if(a)s.prop43=a;if(b)s.prop44=b;$VE_A.Log(("Main > ").concat(c," | VE"),c)};$VE_A.Log=function(i,d,e,c,f){if(window.s=="undefined"||window.s==null)return;if(!$VE_A.analyticsEnabled)return;s.pageName=i;s.prop3=window["map"]?map.GetMapStyle():"";s.prop4=window["map"]?map.GetZoomLevel():"";s.prop5=window["map"]?$VE_A.FormatLatLong(map.GetCenterLatitude(),map.GetCenterLongitude()):"";s.prop6=d?d:"";s.prop7=e?e:"";s.prop8=$ID("what")?$ID("what").value==l355cDt?"":$ID("what").value:"";s.prop9=$ID("where")?$ID("where").value==l341fZt?state.GetStartWhere():$ID("where").value:"";s.prop13=window["map"]?map.GetMapMode():"";s.prop36=window.usertype==undefined?1:usertype;if(s.prop13==Msn.VE.MapActionMode.Mode3D){var a=map.GetCurrentMapView(),b=null;if(a.cameraLatlong!=null&&a.cameraLatlong!="undefined")b=a.cameraLatlong.latitude.toFixed(3)+","+a.cameraLatlong.longitude.toFixed(3);else b=a.latlong.latitude.toFixed(3)+","+a.latlong.longitude.toFixed(3);s.prop14=b+","+a.GetAltitude().toFixed(0)+","+a.GetTilt().toFixed(1)+","+a.GetDirection().toFixed(1)}else s.prop14="";s.prop41="";try{if(typeof VE_BrandFinderAdManager!="undefined")s.prop41=VE_BrandFinderAdManager.GetNumAdsInView()+""}catch(j){}s.prop42="";try{var g=VE_SearchManager.FindByPanel(taskArea.getCurrent());if(g instanceof VE_Search)s.prop42=g.GetNumHighlightedListings()+""}catch(j){}if(typeof f=="number")s.prop45=f;if(d=="CID Parameter")try{if(typeof window._collectionIdFromState!="undefined"&&window._collectionIdFromState!=null)s.prop39=window._collectionIdFromState}catch(j){}else s.prop39="";if(c){s.prop10=$VE_A.ConvertDistanceToBucket(c);s.prop32=c.numberOfWaypoints}else s.prop10="";var h=$ID("logging");if(h)h.innerHTML=s.t();$VE_A.ResetLogProps()};$VE_A.FormatLatLong=function(b,a){if(!b||!a){if(state&&state.GetLatitude()&&state.GetLongitude())return state.GetLatitude().toFixed(3)+","+state.GetLongitude().toFixed(3);return "0.0,0.0"}return b.toFixed(3)+","+a.toFixed(3)};$VE_A.ConvertDistanceToBucket=function(c){var a=c.distance;if(!a)return "";if(c.distanceUnit&&c.distanceUnit.indexOf("mi")!=-1)a=Math.round(a*1.6093);for(var b=0;b<$VE_A.distanceBuckets.length;b++)if($VE_A.distanceBuckets[b].IsInRange(a))return $VE_A.distanceBuckets[b].toString();return "1001 and Above"};$VE_A.ResetLogProps=function(){s.prop11="";s.prop12="";s.prop32="";s.prop33="";s.prop34="";s.prop35="";s.prop41="";s.prop42="";s.prop45="";s.events="";s.eVar8="";s.eVar9="";s.eVar10="";s.eVar11="";s.eVar12="";s.eVar17="";s.campaign=""};function VETileSourceSpecification(a,d,c,g,f,e,b){this.ID=null;this.TileSource=null;this.NumServers=1;this.Bounds=null;this.MinZoom=null;this.MaxZoom=null;this.GetTilePath=null;if(a!="undefined"&&a!=null)this.ID=a;if(d!="undefined"&&d!=null)this.TileSource=d;if(c!="undefined"&&c!=null)this.NumServers=c;if(g!="undefined"&&g!=null)this.Bounds=g;if(f!="undefined"&&f!=null)this.MinZoom=f;if(e!="undefined"&&e!=null)this.MaxZoom=e;if(b!="undefined"&&b!=null)this.GetTilePath=b}function VETileSourceManager(a){var b=this;VEValidator.ValidateNonNull(a,"vemap");this.m_vemap=a;this.m_vemapcontrol=this.m_vemap.vemapcontrol;this.m_vetilesources=[];this.AddTileSource=function(a){VEValidator.ValidateObject(a,"tileSourceSpec",VETileSourceSpecification,"VETileSourceSpecification");VEValidator.ValidateNonNull(a.ID,"tileSourceSpec.ID");if(a.GetTilePath=="undefined"||a.GetTilePath==null)VEValidator.ValidateNonNull(a.TileSource,"tileSourceSpec.TileSource");if(a.MinZoom!=null)VEValidator.ValidateInt(a.MinZoom,"tileSourceSpec.MinZoom");if(a.MaxZoom!=null){VEValidator.ValidateInt(a.MaxZoom,"tileSourceSpec.MaxZoom");VEValidator.ValidateMaxZoom(a.MaxZoom,"tileSourceSpec.MaxZoom")}if(a.MinZoom!=null&&a.MaxZoom!=null)if(a.MinZoom>a.MaxZoom)throw new VEException("VETileSourceManager:AddVETileSource","err_invalidsourceid",l389vt);this.AddVETileSourceSpec(a)};this.AddVETileSourceSpec=function(b){VEMap.ValidateState();try{var c=this.GetSourceById(b.ID);if(c!=null&&c!="undefined")throw new VEException("VETileSourceManager:AddVETileSource","err_invalidsourceid",l975ut);this.m_vetilesources.push(b);a.vemapcontrol.SetTileSource(b)}catch(d){throw d}};this.GetSourceById=function(c){var b=this.m_vetilesources.length;for(var a=0;a<b;++a)if(this.m_vetilesources[a].ID==c)return this.m_vetilesources[a];return null};this.DeleteSourceById=function(c){try{if(this.m_vetilesources==null||this.m_vetilesources=="undefined"){throw new VEException("VEMap:RemoveSourcebyId","err_GraphicsInitError",L_GraphicsInitError_Text);return}var d=this.m_vetilesources.length,b=0;while(b<d&&c!=this.m_vetilesources[b].ID)b++;if(b<d){a.vemapcontrol.DeleteTileSource(c);this.m_vetilesources[b]=null;this.m_vetilesources.splice(b,1);a.m_velayermanager.DeleteLayerBySourceId(c)}else{throw new VEException("VEMap:RemoveSourcebyId","err_invalidsourceid",l975ut);return}}catch(e){throw e;return}};this.Dispose=function(){this.DeleteAllSources();this.m_vetilesources=null;this.m_vemapcontrol=null;this.m_vemap=null};this.DeleteAllSources=function(){var b=this.m_vetilesources.length;for(var a=0;a<b;++a)this.m_vetilesources[a]=null;this.m_vetilesources=[]}}function VE_TrafficManager(a){VEValidator.ValidateObject(a,"vemap",VEMap,"VEMap")}VE_TrafficManager.m_vemap=null;VE_TrafficManager.markets=[];VE_TrafficManager.incidents=[];VE_TrafficManager.incidentJSFiles=[];VE_TrafficManager.showingMarkets=[];VE_TrafficManager.showConstructionIncidents=false;VE_TrafficManager.incidentsAvailable=false;VE_TrafficManager.flowAvailable=false;VE_TrafficManager.turnedOn=false;VE_TrafficManager.showIncidents=false;VE_TrafficManager.showTrafficFlow=false;VE_TrafficManager.prevZoomLevel=0;VE_TrafficManager.prevMapStyle="";VE_TrafficManager.isViewDirty=false;VE_TrafficManager.masterTimer=null;VE_TrafficManager.slaveTimer=null;VE_TrafficManager.Severity={Serious:l210Vt,Moderate:l100Wt,Minor:l985Xt};VE_TrafficManager.GetMarkets=function(){try{VENetwork.DownloadScript(VE_TrafficManager.m_vemap.vemapcontrol.GetMarketsFile(),VE_TrafficManager.GetTrafficInfo)}catch(a){}};VE_TrafficManager._ProcessMarkets=function(a){if(VE_TrafficManager.markets[0]==null)VE_TrafficManager.markets[0]=[];if(a!=null&&a.length>0){var c=a.length;for(var b=0;b<c;b++)if(a[b]!=null)VE_TrafficManager.markets[0].push(a[b])}};VE_TrafficManager._GetIncidents=function(b){VE_TrafficManager.showingMarkets=VE_TrafficManager._GetIncidentMarkets();if(b)if(VE_TrafficManager.showingMarkets.length>0){VE_TrafficManager.incidentsAvailable=true;for(var a=0;a<VE_TrafficManager.showingMarkets.length;a++)try{var c=VENetwork.DownloadScript(VE_TrafficManager.m_vemap.vemapcontrol.GetIncidentsFile()+"-"+VE_TrafficManager.showingMarkets[a]+".js",null);VE_TrafficManager.incidentJSFiles.push(c)}catch(d){}}};VE_TrafficManager._ProcessIncidents=function(a){if(a==null||a.length<=0)return;var b=a[0].MarketId;if(VE_TrafficManager.incidents[b]==null)VE_TrafficManager.incidents[b]=[];else{VE_TrafficManager._ClearPins(b);var d=VE_TrafficManager.incidents[b].length;for(var c=0;c<d;c++)VE_TrafficManager.incidents[b].pop()}if(a!=null&&a.length>0){d=a.length;for(c=0;c<d;c++)if(a[c]!=null)VE_TrafficManager.incidents[b].push(a[c])}VE_TrafficManager._DisplayIncidents()};VE_TrafficManager._GetIncidentMarkets=function(){var b=[],h=VE_TrafficManager.m_vemap.vemapcontrol.PixelToLatLong(new Msn.VE.Pixel(0,0)),g=VE_TrafficManager.m_vemap.vemapcontrol.PixelToLatLong(new Msn.VE.Pixel(VE_TrafficManager.m_vemap.GetWidth(),VE_TrafficManager.m_vemap.GetHeight()));if(h==null||g==null)return b;var c=h.latitude,d=g.longitude,e=g.latitude,f=h.longitude;if(c<e){var i=c;c=e;e=i}if(d<f){i=d;d=f;f=i}if(VE_TrafficManager.markets.length==0)return b;var k=new VELatLongRectangle(new VELatLong(c,f),new VELatLong(e,d)),l=VE_TrafficManager.markets[0].length;for(var a=0;a<l;a++){var j=new VELatLongRectangle(new VELatLong(VE_TrafficManager.markets[0][a].NELatitude,VE_TrafficManager.markets[0][a].SWLongitude),new VELatLong(VE_TrafficManager.markets[0][a].SWLatitude,VE_TrafficManager.markets[0][a].NELongitude));if(VE_TrafficManager._isBBOverlap(k,j)){if(VE_TrafficManager.markets[0][a].Incident=="Incidents")b.push(VE_TrafficManager.markets[0][a].Id);if(VE_TrafficManager.markets[0][a].Flow=="Flow")VE_TrafficManager.flowAvailable=true}}return b};VE_TrafficManager._isBBOverlap=function(b,a){return VE_TrafficManager._IsRectInBoundingBox(b,a)||VE_TrafficManager._IsRectInBoundingBox(a,b)};VE_TrafficManager._IsRectInBoundingBox=function(a,b){return !(a.BottomRightLatLong.Latitude>b.TopLeftLatLong.Latitude||a.BottomRightLatLong.Longitude<b.TopLeftLatLong.Longitude||a.TopLeftLatLong.Latitude<b.BottomRightLatLong.Latitude||a.TopLeftLatLong.Longitude>b.BottomRightLatLong.Longitude)};VE_TrafficManager.GetTrafficInfo=function(){if(!VE_TrafficManager.turnedOn)return;try{if(VE_TrafficManager.m_vemap.vemapcontrol.IsModeEnabled(Msn.VE.MapActionMode.Mode3D))if(VE_TrafficManager.showTrafficFlow)VE_TrafficManager.m_vemap.vemapcontrol.Show3DTraffic(false);else VE_TrafficManager.m_vemap.vemapcontrol.Remove3DTraffic();var a=VE_TrafficManager.m_vemap.GetZoomLevel();if(VE_TrafficManager.m_vemap.GetMapStyle()==Msn.VE.MapStyle.Oblique)return;VE_TrafficManager.prevZoomLevel=a;VE_TrafficManager.prevMapStyle=VE_TrafficManager.m_vemap.GetMapStyle();VE_TrafficManager.incidentsAvailable=false;VE_TrafficManager.flowAvailable=false;VE_TrafficManager._ClearPins();VE_TrafficManager.m_vemap.vemapcontrol.HideTrafficLegend();if(a>=9){VE_TrafficManager._GetIncidents(VE_TrafficManager.showIncidents);if(VE_TrafficManager.showTrafficFlow&&VE_TrafficManager.flowAvailable&&a<=15){VE_TrafficManager.m_vemap.vemapcontrol.ClearTileLayer("Traffic");VE_TrafficManager.m_vemap.vemapcontrol.SetTrafficView()}}if(a<9||a>15)VE_TrafficManager.m_vemap.vemapcontrol.ShowTrafficLegend("");VE_TrafficManager.RenewAutoRefresh()}catch(b){}finally{}};VE_TrafficManager._DisplayIncidents=function(){if(VE_TrafficManager.showingMarkets!=null&&VE_TrafficManager.showingMarkets.length>0){var d=VE_TrafficManager.showingMarkets.length;for(var b=0;b<d;b++){var a=VE_TrafficManager.showingMarkets[b];if(VE_TrafficManager.incidents[a]!=null&&VE_TrafficManager.incidents[a].length>0){VE_TrafficManager._RemoveDuplicates(a);VE_TrafficManager._RenderTrafficInfo(a)}}var c="",a=VE_TrafficManager.showingMarkets[0];if(VE_TrafficManager.incidents[a]!=null&&VE_TrafficManager.incidents[a].length>0)c=VETime.FormatPanelTime(VE_TrafficManager.incidents[a][0].Timestamp,false);VE_TrafficManager.m_vemap.vemapcontrol.ShowTrafficLegend(c)}};VE_TrafficManager._RenderTrafficInfo=function(c){if(c)VE_TrafficManager._ClearPins(c);else VE_TrafficManager._ClearPins();var e=VE_TrafficManager.m_vemap.GetZoomLevel();if(e>8){if(c==null)return;if(VE_TrafficManager.incidents[c]!=null){var b=VE_TrafficManager.incidents[c],f=VE_TrafficManager.incidents[c].length;for(var a=0;a<f;a++)if(b[a].Type!=VE_TrafficIncidentType.Weather&&b[a].Type!=VE_TrafficIncidentType.MassTransit){if(!VE_TrafficManager.showConstructionIncidents)if(b[a].Type==VE_TrafficIncidentType.UnscheduledConstruction||b[a].Type==VE_TrafficIncidentType.ScheduledConstruction)continue;if(VE_TrafficManager.flowAvailable&&b[a].Type==VE_TrafficIncidentType.Congestion)continue;var d=new VEPushpin("pin_traffic_incident_"+c+"_"+b[a].Id,new VELatLong(b[a].Latitude,b[a].Longitude),Msn.VE.API.Constants.trafficiconurl.replace("%1",VE_TrafficManager.GetColor(b[a].Criticality)),"",VE_TrafficManager.CreatePopupContent(b[a]));b[a].pushPin=d;VE_TrafficManager.m_vemap.AddPushpin(d)}}}};VE_TrafficManager.GetColor=function(a){switch(a){case 0:return Msn.VE.UI.Color.Red;break;case 1:return Msn.VE.UI.Color.Orange;break;case 2:return Msn.VE.UI.Color.Yellow;break;default:return Msn.VE.UI.Color.Yellow}};VE_TrafficManager.CreatePopupContent=function(a){var b='<div class = "traffictitle">'+(a.Type?IOSec.EncodeHtml(a.Type.replace(/&amp;/gi,"&")):"")+"</div>"+'<div class = "trafficheader">'+l675Qt+":</div> "+'<div class = "trafficdata">'+VE_TrafficManager._GetSeverity(a.Criticality)+"</div>"+'<div class = "trafficheader">'+l13Rt+":</div> "+'<div class = "trafficdata">'+(a.Location?IOSec.EncodeHtml(a.Location.replace(/&amp;/gi,"&")):"")+"</div>"+'<div class = "trafficheader">'+l799St+":</div> "+'<div class = "trafficdata">'+(a.Description?IOSec.EncodeHtml(a.Description.replace(/&amp;/gi,"&")):"")+"</div>"+"<BR><div>"+'<div class = "trafficlabel">'+l738Tt+":</div>"+'<div class = "trafficdata">'+(a.Starttime?IOSec.EncodeHtml(VETime.FormatTime(a.Starttime,true)):"")+"</div>"+"</div>"+"<div>"+'<div class = "trafficlabel">'+l313Ut+":</div>"+'<div class = "trafficdata">'+(a.Endtime?IOSec.EncodeHtml(VETime.FormatTime(a.Endtime,true)):"")+"</div>"+"</div>";return b};VE_TrafficManager._GetSeverity=function(a){switch(a){case 0:return VE_TrafficManager.Severity.Serious;break;case 1:return VE_TrafficManager.Severity.Moderate;break;case 2:return VE_TrafficManager.Severity.Minor;break;default:return VE_TrafficManager.Severity.Minor}};VE_TrafficManager._RemoveDuplicates=function(c){if(c==null||c=="undefined")return;var a=VE_TrafficManager.incidents[c];if(a==null)return;for(var b=0;b<a.length;b++)for(var d=b+1;d<a.length;d++)if(a[b].Id==a[d].Id)a.splice(b,1)};VE_TrafficManager.ClearTraffic=function(){VE_TrafficManager._ClearPins();if(VE_TrafficManager.m_vemap!=null){VE_TrafficManager.m_vemap.vemapcontrol.ClearTileLayer("Traffic");VE_TrafficManager.m_vemap.vemapcontrol.HideTrafficLegend();if(VE_TrafficManager.m_vemap.vemapcontrol.IsModeEnabled(Msn.VE.MapActionMode.Mode3D))VE_TrafficManager.m_vemap.vemapcontrol.Remove3DTraffic()}VE_TrafficManager.turnedOn=false;VE_TrafficManager.ExpireAutoRefresh()};VE_TrafficManager.Destroy=function(){VE_TrafficManager.ClearTraffic();VE_TrafficManager.incidentsAvailable=false;VE_TrafficManager.flowAvailable=false;if(VE_TrafficManager.incidents!=null){if(VE_TrafficManager.markets[0]!=null)for(var c=0;c<VE_TrafficManager.markets[0].length;c++){var b=VE_TrafficManager.markets[0][c].Id,i=VE_TrafficManager.incidents[b];if(i==null)continue;var a=VE_TrafficManager.incidents[b].pop();if(a==null)continue;for(var e=0;e<a.length;e++){var f=a.pop();f=null}a=null}VE_TrafficManager.incidents[b]=null}if(VE_TrafficManager.markets!=null&&VE_TrafficManager.markets[0]!=null&&VE_TrafficManager.markets[0].length>0){var h=VE_TrafficManager.markets[0].length;for(var d=0;d<h;d++){var g=VE_TrafficManager.markets[0].pop();g=null}VE_TrafficManager.markets[0]=null}};VE_TrafficManager._ClearPins=function(e){if(VE_TrafficManager.markets==null||VE_TrafficManager.markets.length<=0)return;var c=VE_TrafficManager.markets[0];if(c!=null&&c.length>0)for(var a=0;a<c.length;a++)if(c[a].pushPin){VE_TrafficManager.m_vemap.DeletePushpin(c[a].pushPin.ID);c[a].pushPin=null}if(VE_TrafficManager.incidents==null||VE_TrafficManager.incidents.length<=0)return;if(e){var b=VE_TrafficManager.incidents[e];if(b==null)return;for(a=0;a<b.length;a++)if(b[a].pushPin){VE_TrafficManager.m_vemap.DeletePushpin(b[a].pushPin.ID);b[a].pushPin=null}}else for(var d=0;d<VE_TrafficManager.markets[0].length;d++){var f=VE_TrafficManager.markets[0][d].Id,b=VE_TrafficManager.incidents[f];if(b==null)continue;for(a=0;a<b.length;a++)if(b[a].pushPin){VE_TrafficManager.m_vemap.DeletePushpin(b[a].pushPin.ID);b[a].pushPin=null}b=null}};VE_TrafficManager._ViewChangeNotification=function(){if(VE_TrafficManager.m_vemap.GetMapStyle()==Msn.VE.MapStyle.Oblique)return;if(!VE_TrafficManager.turnedOn)return;var a=VE_TrafficManager.m_vemap.GetZoomLevel();if(VE_TrafficManager.prevZoomLevel<=8&&a>8)VE_TrafficManager.isViewDirty=true;else if(VE_TrafficManager.prevZoomLevel>8&&a<=8)VE_TrafficManager.isViewDirty=true;else if(VE_TrafficManager.prevZoomLevel<=15&&a>15)VE_TrafficManager.isViewDirty=true;else if(VE_TrafficManager.prevZoomLevel>15&&a<=15)VE_TrafficManager.isViewDirty=true;else if(VE_TrafficManager.prevMapStyle==Msn.VE.MapStyle.Oblique)VE_TrafficManager.isViewDirty=true;else{var b=VE_TrafficManager._GetIncidentMarkets();if(b!=null&&b.length>0)for(var c=0;c<b.length;c++){var e=false;for(var d=0;d<VE_TrafficManager.showingMarkets.length;d++)if(b[c]==VE_TrafficManager.showingMarkets[d]){e=true;break}if(!e){VE_TrafficManager.isViewDirty=true;break}else VE_TrafficManager.isViewDirty=false}else VE_TrafficManager.isViewDirty=true}VE_TrafficManager.prevZoomLevel=a;VE_TrafficManager.prevMapStyle=VE_TrafficManager.m_vemap.GetMapStyle();if(VE_TrafficManager.isViewDirty)window.setTimeout("VE_TrafficManager.GetTrafficInfo()",1);VE_TrafficManager.RenewAutoRefresh()};VE_TrafficManager.ExpireAutoRefresh=function(){if(VE_TrafficManager.masterTimer!=null)window.clearInterval(VE_TrafficManager.masterTimer);if(VE_TrafficManager.slaveTimer!=null)window.clearInterval(VE_TrafficManager.slaveTimer)};VE_TrafficManager.RenewAutoRefresh=function(){if(!VE_TrafficManager.turnedOn)return;VE_TrafficManager.ExpireAutoRefresh();VE_TrafficManager.masterTimer=window.setInterval("VE_TrafficManager.ExpireAutoRefresh()",VE_TrafficManager.m_vemap.vemapcontrol.GetSlidingExpirationForAutoRefresh());VE_TrafficManager.slaveTimer=window.setInterval(VE_TrafficManager.AutoRefresh,VE_TrafficManager.m_vemap.vemapcontrol.GetAutoRefreshRate())};VE_TrafficManager.AutoRefresh=function(){try{var a=VE_TrafficManager.m_vemap.GetZoomLevel();if(a>=9)VE_TrafficManager.GetTrafficInfo()}catch(b){}};VE_TrafficIncidentType=new function(){this.ScheduledConstruction="SCHEDULED CONSTRUCTION";this.OtherNews="OTHER NEWS";this.Congestion="CONGESTION";this.Accident="ACCIDENT";this.DisabledVehicle="DISABLED VEHICILE";this.RoadHazard="ROAD HAZARD";this.UnscheduledConstruction="UNSCHEDULED CONSTRUCTION";this.PlannedEvent="PLANNED EVENT";this.MassTransit="MASS TRANSIT";this.Weather="WEATHER";this.Miscellaneous="MISCELLANEOUS"};function VE_Market(h,g,f,e,c,d,b,a){this.Id=h;this.Name=g;this.GMTOffset=f;this.SWLatitude=e;this.SWLongitude=c;this.NELatitude=d;this.NELongitude=b;if(a.indexOf("Flow")==0)this.Flow="Flow";if(a.indexOf("Incidents")!=-1)this.Incident="Incidents"}function VE_Incident(e,h,k,b,g,j,f,c,a,d,i){this.Timestamp=e;this.MarketId=h;this.Id=k;this.Description=b;this.Location=g;this.Type=j;this.Latitude=f;this.Longitude=c;this.Criticality=a;this.Starttime=d;this.Endtime=i}if(typeof registerNamespace!="undefined")registerNamespace("Microsoft.Web");else{if(typeof Microsoft=="undefined")Microsoft={};if(typeof Microsoft.Web=="undefined")Microsoft.Web={}}Microsoft.Web.Css={Style:{Height:0,Width:1,Top:2,Left:3,Bottom:4,Right:5,Position:6,Margin:7,Padding:8,Display:9,Visibility:10},Units:{Auto:"auto",Pixels:"px",Points:"pt",Ems:"em",Percentage:"%"},Position:{Static:"static",Relative:"relative",Absolute:"absolute"},Display:{None:"none",Block:"block",Table:"table",Inline:"inline"},Visibility:{Visible:"visible",Hidden:"hidden"},Cursors:{Auto:"auto",Default:"default",Crosshair:"crosshair",Pointer:"pointer",Move:"move",Wait:"wait",Text:"text",Help:"help",NResize:"n-resize",NEResize:"ne-resize",NWResize:"nw-resize",SResize:"s-resize",SEResize:"se-resize",SWResize:"sw-resize",EResize:"e-resize",WResize:"w-resize"},RegEx:{RectClip:/rect\((auto|\d+px|\d*\.*\d+em|\d*\.*\d+pt)\s*,*\s*(auto|\d+px|\d*\.*\d+em|\d*\.*\d+pt)\s*,*\s*(auto|\d+px|\d*\.*\d+em|\d*\.*\d+pt)\s*,*\s*(auto|\d+px|\d*\.*\d+em|\d*\.*\d+pt)\)/},Functions:{getComputedStyle:function(b,c){var a=null;if(document.defaultView&&document.defaultView.getComputedStyle&&typeof document.defaultView.getComputedStyle!="undefined")a=document.defaultView.getComputedStyle(b,null);else a=b.currentStyle;return a[c]},setClip:function(c,d,e){var b=Microsoft.Web.Css.Functions.getClip(c,0),f=Microsoft.Web.Css.RegEx.RectClip,a=f.exec(b);a[d]=e;if(d==0)c.style.clip=a[0];else{a[d]=e;a.shift();b="rect("+a.join(" ")+")";c.style.clip=b}},getClip:function(d,e){var b=d.style.clip;if(b==""){b=Microsoft.Web.Css.Functions.getComputedStyle(d,"clip");if(b=="auto")b="rect(auto auto auto auto)";else if(typeof b=="undefined"||b==null){var c=d.currentStyle;if(typeof c!="undefined"&&c!=null)b="rect("+c.clipTop+" "+c.clipRight+" "+c.clipBottom+" "+c.clipLeft+")"}}var f=Microsoft.Web.Css.RegEx.RectClip,a=f.exec(b);if(e==0)return a[0];a[1]=a[1]=="auto"?0:a[1];a[4]=a[4]=="auto"?0:a[4];a[2]=a[2]=="auto"?d.offsetWidth:a[2];a[3]=a[3]=="auto"?d.offsetHeight:a[3];if(e==5)return a;else return a[e]}}};if(typeof registerNamespace!="undefined")registerNamespace("Microsoft.Web");else{if(typeof Microsoft=="undefined")Microsoft={};if(typeof Microsoft.Web=="undefined")Microsoft.Web={}}Microsoft.Web.Animation={AccelerationFunction:function(e){var b=null,a=200,d=e;this.setSteps=function(d){a=d;b=null;c()};this.getSteps=function(){return a};this.getValue=function(e){if(!b)c();var d=parseInt(Math.round(e*a));if(d<0)d=0;if(d>a)d=a;return b[d]};this.getTotal=function(){return this.getValue(1)};function c(){b=[];b[0]=0;for(var c=1;c<=a;c++)b[c]=b[c-1]+d(c/a)}},Movie:function(a,f){var c=this;this.Repeat=true;this.AppendContent=true;var e=[],b=-1,d=null;this.addFrame=function(b,a){if(a==null)a=true;var c={data:b,append:a};e.push(c)};this.start=function(){c.stop();c.show();c.clear();b=-1;d=setInterval(g,f)};this.stop=function(){if(d)clearInterval(d)};this.show=function(){a.style.visibility="visible"};this.hide=function(){a.style.visibility="hidden"};this.clear=function(){a.innerHTML=""};function g(){b++;if(b>e.length-1){b=0;if(!c.Repeat){clearInterval(d);return}else c.clear()}var f=e[b];if(f.append)a.innerHTML+=f.data;else a.innerHTML=f.data}},RollDirection:{TopDown:1,RightLeft:2,BottomUp:4,LeftRight:8},RollStyle:{In:0,Out:1},Roller:function(q){var c=this;this.superclass=Microsoft.Web.OO.Eventable.EventableObject;this.superclass();var d=Microsoft.Web.Css,b=Microsoft.Web.Animation,h=Microsoft.Web.OO.Eventable,a=q,e=null,k=true,g=false,f=AccelerationFunctions.CrazyElevator,i=10,j=10,l=5,p={top:1,right:2,bottom:3,left:4},o={top:3,right:4,bottom:1,left:2};this.setAccelerationFunction=function(a){if(a instanceof Microsoft.Web.Animation.AccelerationFunction)f=a};this.setXLeave=function(a){if(typeof a=="number"&&a>=0)i=Math.floor(a,10)};this.setYLeave=function(a){if(typeof a=="number"&&a>=0)j=Math.floor(a,10)};this.getLeave=function(){return {x:i,y:j}};this.setDelay=function(a){if(typeof a=="number"&&a>0)l=Math.floor(a,10)};this.isExpanded=function(){return k};this.isRolling=function(){return g};this.isAssociated=function(){if(e!=null&&e.length>0)return true;return false};this.associate=function(a){if(a instanceof Array)e=a};this.rollIn=function(d){if(g)return;c.executeEvent("beforerollin",c,new h.EventArgs("beforerollin",a));m(b.RollStyle.In,d);k=false};this.rollOut=function(d){if(g)return;c.executeEvent("beforerollout",c,new h.EventArgs("beforerollout",a));m(b.RollStyle.Out,d);k=true};function m(t,m){g=true;n();var k=p,q=0,r=0;if(t==b.RollStyle.Out){k=o;q=i;r=j}var w=a.offsetWidth,u=a.offsetHeight,y=w-i,z=u-j,A=y/f.getTotal(),B=z/f.getTotal(),v=f.getSteps();for(var s=0;s<=v;s++){var x=s/v;setTimeout(C(x),s*l)}function C(i){return function(){var l=parseInt(Math.round(f.getValue(i)*A))+q,n=parseInt(Math.round(f.getValue(i)*B))+r,j={top:0,right:0,bottom:0,left:0};if((m&b.RollDirection.TopDown)==b.RollDirection.TopDown){d.Functions.setClip(a,k.top,n+d.Units.Pixels);j.top=n-r}if((m&b.RollDirection.RightLeft)==b.RollDirection.RightLeft){d.Functions.setClip(a,k.right,w-l+d.Units.Pixels);j.right=-l+q}if((m&b.RollDirection.BottomUp)==b.RollDirection.BottomUp){d.Functions.setClip(a,k.bottom,u-n+d.Units.Pixels);j.bottom=-n+r}if((m&b.RollDirection.LeftRight)==b.RollDirection.LeftRight){d.Functions.setClip(a,k.left,l+d.Units.Pixels);j.left=l-q}if(e!=null){var p;for(p=0;p<e.length;p++){var o=e[p],v=j.top+j.bottom,y=o.origPos.y+v,s=j.left+j.right,x=o.origPos.x+s;if(s!=0)o.style.left=x+d.Units.Pixels;if(v!=0)o.style.top=y+d.Units.Pixels}}if(i==1){g=false;if(t==b.RollStyle.In)c.executeEvent("afterrollin",c,new h.EventArgs("afterrollin",a));else{a.style.clip="rect(auto auto auto auto)";c.executeEvent("afterrollout",c,new h.EventArgs("afterrollout",a))}}c.executeEvent("roll",c,new h.EventArgs("roll",a))}}}function n(){var b=Microsoft.Web.Css;if(e==null)return;var c,i=e.length;for(c=0;c<i;c++){var a=e[c];a.origPos={x:parseInt(b.Functions.getComputedStyle(a,"left")),y:parseInt(b.Functions.getComputedStyle(a,"top"))};if(isNaN(a.origPos.x)){var f=parseInt(b.Functions.getComputedStyle(a,"marginLeft"),10),d=parseInt(b.Functions.getCoputedStyle(a,"paddingLeft"),10);a.origPos.x=a.offsetLeft-(isNaN(f)?0:f)-(isNaN(d)?0:d)}if(isNaN(a.origPos.y)){var h=parseInt(b.Functions.getComputedStyle(a,"marginTop"),10),g=parseInt(b.Functions.getComputedStyle(a,"paddingTop"),10);a.origPos.y=a.offsetTop-(isNaN(h)?0:h)-(isNaN(g)?0:g)}}b=null}},Slider:function(){var d=this,c=Microsoft.Web.Geometry,a=AccelerationFunctions.Linear,b=5;this.setAccelerationFunction=function(b){if(b instanceof Microsoft.Web.Animation.AccelerationFunction)a=b};this.setDelay=function(a){if(typeof a=="number"&&a>0)b=a};this.slideToPoint=function(e,i){var d=new c.Point(e.offsetLeft,e.offsetTop),n=d.getDistanceFrom(i);a.setSteps(Math.floor(n/10));var p=n/a.getTotal(),o=i.y-d.y,l=i.x-d.x,f=Math.atan(o/l),m=a.getSteps();for(var h=0;h<=m;h++){sum=a.getValue(h/m);var g=sum*p,k,j;if(l<0){k=d.y-Math.sin(f)*g;j=d.x-Math.cos(f)*g}else{k=d.y+Math.sin(f)*g;j=d.x+Math.cos(f)*g}setTimeout(q(j,k),h*b)}function q(a,b){return function(){e.style.top=parseInt(Math.round(b))+"px";e.style.left=parseInt(Math.round(a))+"px"}}}}};var AccelerationFunctions={Linear:new Microsoft.Web.Animation.AccelerationFunction(function(){return 1}),ExponentialAcc:new Microsoft.Web.Animation.AccelerationFunction(function(b){var a=0,d=1,c=d-a,f=a+b*c,e=Math.pow(f,2);return e}),ExponentialDec:new Microsoft.Web.Animation.AccelerationFunction(function(b){var a=-1,d=0,c=d-a,f=a+b*c,e=Math.pow(f,2);return e}),CosineWave:new Microsoft.Web.Animation.AccelerationFunction(function(b){var a=-Math.PI,d=Math.PI,c=d-a,f=a+b*c,e=Math.cos(f)+1;return e}),CrazyElevator:new Microsoft.Web.Animation.AccelerationFunction(function(b){var a=-5,d=5,c=d-a,f=a+b*c,e=2/(Math.pow(Math.abs(f),3)+1);return e})};if(typeof registerNamespace!="undefined")registerNamespace("Microsoft.Web.Geometry");else{if(typeof Microsoft=="undefined")Microsoft={};if(typeof Microsoft.Web=="undefined")Microsoft.Web={};if(typeof Microsoft.Web.Geometry=="undefined")Microsoft.Web.Geometry={}}Microsoft.Web.Geometry.Point=function(c,d){var a=this,b=Microsoft.Web.Geometry;this.x=c;this.y=d;this.add=function(c,d){var e=new b.Point(a.x+c,a.y+d);return e};this.getDistanceFrom=function(b){var c=Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2),d=Math.sqrt(c);return d}};Microsoft.Web.Geometry.Overlap={Range:{GreaterThanX:1,LessThanX:2,GreaterThanY:4,LessThanY:8,InXRange:16,InYRange:32,InRange:48},getInstance:function(f,g){var d=Microsoft.Web.Geometry.Overlap,a=f,b=g,c=0;e();function e(){if(b.getP2().x>a.getP2().x)c+=d.Range.GreaterThanX;if(b.getP1().x<a.getP1().x)c+=d.Range.LessThanX;if(b.getP2().y>a.getP2().y)c+=d.Range.GreaterThanY;if(b.getP1().y<a.getP1().y)c+=d.Range.LessThanY;if(a.getP1().x<=b.getP1().x&&b.getP2().x<=a.getP2().x)c+=d.Range.InXRange;if(a.getP1().y<=b.getP1().y&&b.getP2().y<=a.getP2().y)c+=d.Range.InYRange}this.getRange=function(){return c};this.getLeftXBleed=function(){if(c&d.Range.LessThanX)return Math.abs(a.getP1().x-b.getP1().x);else return 0};this.getRightXBleed=function(){if(c&d.Range.GreaterThanX)return b.getP2().x-a.getP2().x;else return 0};this.getTopYBleed=function(){if(c&d.Range.LessThanY)return Math.abs(a.getP1().y-b.getP1().y);else return 0};this.getBottomYBleed=function(){if(c&d.Range.GreaterThanY)return b.getP2().y-a.getP2().y;else return 0}}};Microsoft.Web.Geometry.Rectangle=function(h,i){var g=this,a=h,b=i,d,e;f();function f(){c()}this.move=function(c){a.x=c.x;a.y=c.y;b.x=c.x+e;b.y=c.y+d};this.getP1=function(){return a};this.getP2=function(){return b};this.setP1=function(b){a=b;c()};this.setP2=function(a){b=a;c()};this.getWidth=function(){return e};this.getHeight=function(){return d};this.containsPoint=function(c){return c.x>=a.x&&c.x<=b.x&&c.y>=a.y&&c.y<=b.y};this.getOverlap=function(a){var b=Microsoft.Web.Geometry;return new b.Overlap.getInstance(g,a)};function c(){d=b.y-a.y;e=b.x-a.x}};Microsoft.Web.Geometry.Functions={getSlope:function(a,b){return (b.y-a.y)/(b.x-a.x)},getYIntercept:function(b,a){return a.y-b*a.x},getElementPosition:function(a){var d=Microsoft.Web.Geometry,b=0,c=0;while(a&&a.offsetParent){b+=a.offsetLeft-a.scrollLeft;c+=a.offsetTop-a.scrollTop;a=a.offsetParent}return new d.Point(b,c)},getBestBoundingPoint:function(f,b,c){var a=Microsoft.Web.Geometry;if(!b)b=a.Functions.getElementPosition(f);var e=new a.Rectangle(b,new a.Point(b.x+f.offsetWidth,b.y+f.offsetHeight)),i=c.getOverlap(e),d=i.getRange();if((d&a.Overlap.Range.InRange)==a.Overlap.Range.InRange)return b;var g=b.x,h=b.y;if(d&a.Overlap.Range.GreaterThanX)g=c.getP2().x-e.getWidth();if(d&a.Overlap.Range.LessThanX)g=c.getP1().x;if(d&a.Overlap.Range.GreaterThanY)h=c.getP2().y-e.getHeight();if(d&a.Overlap.Range.LessThanY)h=c.getP1().y;return new a.Point(g,h)}};if(typeof registerNamespace!="undefined")registerNamespace("Microsoft.Web.UI");else{if(typeof Microsoft=="undefined")Microsoft={};if(typeof Microsoft.Web=="undefined")Microsoft.Web={};if(typeof Microsoft.Web.UI=="undefined")Microsoft.Web.UI={}}Microsoft.Web.UI.IEGlyphStates={Unselected:"-unselected",Hover:"-hover",Pressed:"-pressed"};Microsoft.Web.UI.IEGlyph=function(j,l){var k=Microsoft.Web.UI,a,d,c,b;m();function m(){a=document.createElement("div");if(j)a.id=j;b=l||"ieglyph";d=b+k.IEGlyphStates.Hover;c=b+k.IEGlyphStates.Pressed;a.className=b;if(!document.all)return;a.attachEvent("onmouseover",e);a.attachEvent("onmousedown",i);a.attachEvent("onmouseup",e);a.attachEvent("onmouseout",f);window.attachEvent("onunload",n)}this.getElement=function(){return a};this.setContent=function(b){a.innerHTML=b};function n(){a.detachEvent("onmouseover",e);a.detachEvent("onmousedown",i);a.detachEvent("onmouseup",e);a.detachEvent("onmouseout",f);a=null;d=null;c=null;b=null}function e(){f();h(d)}function i(){h(c)}function f(){g(d);g(c)}function h(b){a.className+=" "+b}function g(b){var c=new RegExp(" "+b,"g");a.className=a.className.replace(c,"")}};var ERO={Classes:{Container:"ero",Shadow:"ero-shadow",Body:"ero-body",Actions:"ero-actions",ActionsBackground:"ero-actionsBackground",PreviewArea:"ero-previewArea",LeftBeak:"ero-leftBeak",RightBeak:"ero-rightBeak",HideBeak:"ero-hideBeak",PaddingHack:"ero-paddingHack",ProgressAnimation:"ero-progressAnimation"},BeakDirection:{Right:0,Left:1,None:2},DockPosition:{Top:0,Center:1},m_theEro:null,BeakHeight:34,getInstance:function(){var a=Microsoft.Web.Geometry;if(!ERO.m_theEro){ERO.m_theEro=new b;ERO.m_theEro.setBoundingArea(new a.Point(0,5),new a.Point(document.body.clientWidth,document.body.clientHeight))}ERO.m_theEro.addToPage();return ERO.m_theEro;function b(){var e=this,h=null,n=null,m=false,b=document.createElement("div");b.className=ERO.Classes.Container;if(typeof b.addEventListener!="undefined"){b.addEventListener("mouseover",o,false);b.addEventListener("mouseout",p,false)}else{b.attachEvent("onmouseover",o);b.attachEvent("onmouseout",p)}var r=document.createElement("div");r.className=ERO.Classes.Shadow;var d=document.createElement("div");d.className=ERO.Classes.Body;var q=document.createElement("div");q.className=ERO.Classes.Actions;var k=document.createElement("ul"),j=document.createElement("div");j.className=ERO.Classes.ActionsBackground;var g=document.createElement("div");g.className=ERO.Classes.PreviewArea;var i=document.createElement("div");i.className=ERO.Classes.LeftBeak;var l=null,s=document.createElement("div");s.className=ERO.Classes.PaddingHack;b.appendChild(r);b.appendChild(i);r.appendChild(d);d.appendChild(j);j.appendChild(g);j.appendChild(q);q.appendChild(k);j.appendChild(s);var f=document.createElement("div");f.className=ERO.Classes.ProgressAnimation;var c=new Microsoft.Web.Animation.Movie(f,75);c.addFrame('<div class = "frame1"></div>');c.addFrame('<div class = "frame2"></div>');c.addFrame('<div class = "frame3"></div>');c.addFrame("");c.addFrame("");c.addFrame('<div class = "frame2"></div><div class = "frame3"></div>',false);c.addFrame('<div class = "frame3"></div>',false);c.Repeat=false;this.destroy=function(){if(b){if(typeof b.removeEventListener!="undefined"){b.removeEventListener("mouseover",o,false);b.removeEventListener("mouseout",p,false)}else{b.detachEvent("onmouseover",o);b.detachEvent("onmouseout",p)}if(d.shimElement){d.shimElement.removeNode(true);d.shimElement=null}b=null;r=null;d=null;q=null;k=null;j=null;g=null;i=null;s=null}n=null};this.getElement=function(){return b};this.getAnimation=function(){return c};this.setBeak=function(a){if(a==ERO.BeakDirection.None){if(l==null){var c=Microsoft.Web.Css.Functions;l=c.getComputedStyle(b,"padding");b.style.padding="0px"}i.className=ERO.Classes.HideBeak}else{if(l!=null){b.style.padding=l;l=null}if(a==ERO.BeakDirection.Right)i.className=ERO.Classes.RightBeak;else i.className=ERO.Classes.LeftBeak}};this.setContent=function(c){var a=document.createElement("div");a.className="firstChild";a.innerHTML=c;var b=g.firstChild;if(b)g.replaceChild(a,b);else g.appendChild(a);a=null;b=null};this.addAction=function(b){var a=document.createElement("li");if(!b)return;a.innerHTML=b;k.appendChild(a);a=null};this.clearActions=function(){var a=k.getElementsByTagName("li"),c=a.length;for(var b=0;b<c;b++)k.removeChild(a[0])};this.dockToText=function(d,b){b=typeof b!="undefined"?b:typeof window.event!="undefined"?window.event:null;var c=a.Functions.getElementPosition(d);c.y-=3;var f;if(b==null)f=new a.Rectangle(c,new a.Point(c.x+d.offsetWidth,c.y+d.offsetHeight));else{var g=typeof event.pageX!="undefined"?b.pageX:b.clientX;f=new a.Rectangle(new a.Point(g,c.y),new a.Point(g,c.y+d.offsetHeight))}e.dockToRect(f,null,d)};this.dockToElement=function(b){var c=a.Functions.getElementPosition(b),d=new a.Rectangle(c,new a.Point(c.x+b.offsetWidth,c.y+b.offsetHeight));e.dockToRect(d,null,b)};this.dockToPoint=function(b,c,d){e.dockToRect(new a.Rectangle(b,b),c,d)};this.dockToRect=function(p,s,E,l,C){if(typeof view3DMode!="undefined")HideShim(d);if(typeof s=="undefined"||s==null)s={x:0,y:0};m=true;n=E;e.addToPage();if(typeof l=="undefined"||!l)e.setBeak(ERO.BeakDirection.Left);else e.setBeak(ERO.BeakDirection.None);var o="px",j=g.offsetHeight-ERO.BeakHeight;f.style.top=p.getP1().y-f.offsetHeight+s.y+o;f.style.left=p.getP2().x-f.offsetWidth+s.x+o;var w=p.getP2().x,z=p.getP2().y-j-ERO.BeakHeight/2-p.getHeight()/2,x=e.getSize(),F=x.getP2().y-x.getP1().y,A=x.getP2().x-x.getP1().x,G=new a.Rectangle(new a.Point(w,z),new a.Point(w+A,z+F)),y=h.getOverlap(G),q=y.getRange(),r,v,u,k;r=v=u=k="auto";if(q&a.Overlap.Range.InXRange)k=w;if(q&a.Overlap.Range.InYRange)r=z;if(q&a.Overlap.Range.GreaterThanX){if(typeof l=="undefined"||!l)e.setBeak(ERO.BeakDirection.Right);if(w>h.getP2().x)v=document.body.clientWidth-h.getP2().x;else k=w-A-p.getWidth()}if(q&a.Overlap.Range.LessThanX){if(typeof l=="undefined"||!l)e.setBeak(ERO.BeakDirection.Left);k=h.getP1().x}if(q&a.Overlap.Range.GreaterThanY){u=document.body.clientHeight-h.getP2().y;var D=y.getBottomYBleed();j+=D;if(j>b.offsetHeight-ERO.BeakHeight)j=b.offsetHeight-ERO.BeakHeight-4}if(q&a.Overlap.Range.LessThanY){r=h.getP1().y;D=y.getTopYBleed();j-=D;if(j<0)j=0}if(typeof C=="undefined"||!C){c.start();setTimeout(B,500)}else B();function B(){if(n!=-1&&n!=E)return;b.style.top=r=="auto"?r:r+o;b.style.bottom=u=="auto"?u:u+o;b.style.left=k=="auto"?k:k+o;b.style.right=v=="auto"?v:v+o;i.style.top=j+"px";mvcViewFacade.OnEroShowFadeInAnimationIfSupported(t,b,d)}};function t(){if(b.style&&typeof b.style.filter!="undefined"){b.style.filter="progid:DXImageTransform.Microsoft.Fade(duration=.5)";b.filters[0].Apply();b.style.visibility="visible";b.style.display="block";b.filters[0].Play()}else{window.__eroFadeValue__=1;b.style.visibility="visible";b.style.display="block";b.style.opacity=0;var a;for(a=1;a<=10;a++)setTimeout(function(){var a=__eroFadeValue__++*0.09999999;b.style.opacity=a},50*a)}}this.hide=function(a){m=false;if(a&&a==true)e();else setTimeout(e,500);function e(){if(!m){b.style.visibility="hidden";c.hide();n=null;if(typeof view3DMode!="undefined")HideShim(d)}}};this.setBoundingArea=function(b,c){h=new a.Rectangle(b,c)};this.isInUse=function(){return m};this.addToPage=function(){b.style.visibility="hidden";f.style.visibility="hidden";document.body.appendChild(b);document.body.appendChild(f)};this.getSize=function(){var c=b.offsetLeft,d=b.offsetTop,f=c+b.offsetWidth,g=d+b.offsetHeight,e=new a.Rectangle(new a.Point(c,d),new a.Point(f,g));return e};function o(){m=true}function p(){e.hide()}}}};function VETime(){}VETime.FormatTime=function(a){if(a==null||a==""||a=="undefined")return "";var c=false,d=a.substr(0,10),e=a.substr(11,5),b="";if(a.indexOf("AM")>-1){b="AM";c=true}else b="PM";return d+" "+VETime.ConvertTo12HourFormat(e,c)+" "+b};VETime.ConvertTo12HourFormat=function(d,c){var a=d;try{var b=parseFloat(a.replace(":","."));if(b>12)if(b<13&&c!=true);else b=b-12;a=b.toFixed(2);a=a.replace(".",":")}catch(e){a=""}return a};VETime.FormatPanelTime=function(a,g){if(a==null||a==""||a=="undefined")return "";try{var b=0,d=false,i=a.substr(4,8),h=a.indexOf(":"),f=a.substr(h-2,5),c="";if(a.indexOf("AM")>-1){c="AM";d=true;b=a.indexOf("AM")}else{c="PM";b=a.indexOf("PM")}var e="";if(b>0)e=a.substr(b+3,3);if(g)return i+" "+VETime.ConvertTo12HourFormat(f,d)+" "+c+" "+e;else return VETime.ConvertTo12HourFormat(f,d)+" "+c+" "+e}catch(j){}};VETime.getMonth=function(a){switch(a){case "01":return " Jan";break;case "02":return " Feb";break;case "03":return " Mar";break;case "04":return " Apr";break;case "05":return " May";break;case "06":return " Jun";break;case "07":return " Jul";break;case "08":return " Aug";break;case "09":return " Sep";break;case "10":return " Oct";break;case "11":return " Nov";break;case "12":return " Dec";break}};if(!(navigator.userAgent.indexOf("IE")>=0)&&(typeof VEAPI_DisableAtlasCompat=="undefined"||VEAPI_DisableAtlasCompat!=true))VENetwork.DownloadScript(Msn.VE.API.Constants.atlascompatjs,DownloadMapStyles);else DownloadMapStyles();function DownloadMapStyles(){VENetwork.AttachStyleSheet(Msn.VE.API.Constants.erostylesheet);VENetwork.AttachStyleSheet(Msn.VE.API.Constants.stylesheet);VENetwork.AttachStyleSheet(Msn.VE.API.Constants.trafficstylesheet)}VEDashboardSize=new function(){this.Normal=Msn.VE.DashboardSize.Normal;this.Tiny=Msn.VE.DashboardSize.Tiny};function RequestQueueItem(a,b,c,d){this.Call=a;this.Param1=b;this.Param2=c;this.Param3=d}function VEMap(d){var a=this;this.ID=d;this.GUID=VENetwork.GetExecutionID();if(Msn.VE.API.Globals.vemapinstances==null||Msn.VE.API.Globals.vemapinstances=="undefined")Msn.VE.API.Globals.vemapinstances=[];Msn.VE.API.Globals.vemapinstances[this.GUID]=this;this.requestQueue=[];this.network=new VENetwork;this.mapelement=$ID(d);this.pushpins=[];this.DisambiguationCallback=null;this.ShowMessageBox=true;if(this.mapelement==null)throw new VEException("VEMap:cstr","err_invalidelement",l773et);this.m_vedirectionsmanager=new VEDirectionsManager(this);this.m_vedirectionsmanager.Initialize();this._dm=this.m_vedirectionsmanager;this.m_vesearchmanager=new VE_SearchManager(this);this.m_vesearchmanager.Initialize();this._sm=this.m_vesearchmanager;this.m_vemessage=new VEMessage(this);this.m_veambiguouslist=new VEAmbiguouslist(this);var c=new VELatLongFactory(new VELatLongFactorySpecFromMap(this)),b=new VELatLongDecoder;this.queueEventInitialized=false;this.RequestQueueEnabled=true;windowWidth=GetWindowWidth();windowHeight=GetWindowHeight();scrollbarWidth=GetScrollbarWidth();this.dashboardSize=Msn.VE.DashboardSize.Normal;this.LoadMap=function(a,f,h,g,c,e){if(typeof c!="undefined"&&c!=null){VEValidator.ValidateMapMode(c,"mapMode");this.mapMode=c}if(a!=null&&a!="undefined"){VEValidator.ValidateObject(a,"veLatLong",VELatLong,"VELatLong");var d=b.Decode(a);this.initialLatitude=d.Latitude;this.initialLongitude=d.Longitude}this.fixedMap=g;this.initialZoomLevel=f;this.initialMapStyle=h;this.showMapModeSwitch=e;this.veonmaploadevent=this.onLoadMap;this.mapelement.innerHTML="";this.mapelement.innerHTML="<table width=100% height=100%><tr valign=middle><td align=center valign=middle><h3>"+l669It+"</h3></td></tr></table>";this.InitializeMap();$VE_A.LogAPI("VE | APIs","VEMap - LoadMap")};this._ReArrangeControls=function(){if(a.controlzIndexes!=null&&a.controls!=null&&a.controlzIndexes.length==a.controls.length){var d=a.controls.length;for(var b=0;b<d;b++){document.body.removeChild(a.controls[b]);var c=a.controls[b];c.style.top=a.controltops[b];c.style.left=a.controllefts[b];a._AddControlInner(c,a.controlzIndexes[b])}}};this._ClearView=function(){VEMap.ValidateState();VEPushpin.Hide();a.m_vemessage.Hide();if(VE_TrafficManager.turnedOn==true)VE_TrafficManager._ViewChangeNotification()};this._RefreshLayers=function(){if(a.vemapcontrol.GetMapMode()!=2)a.vemapcontrol.PanView();if(VE_TrafficManager.turnedOn==true)VE_TrafficManager._ViewChangeNotification()};this.SetViewport=function(a,c,b,d){VEMap.ValidateState();try{return this.vemapcontrol.SetViewport(a,c,b,d)}catch(e){throw e;return}};this.GetCenter=function(){VEMap.ValidateState();var b=this.vemapcontrol.GetCenterLatitude(),d=this.vemapcontrol.GetCenterLongitude(),a=c.CreateVELatLong(b,d);$VE_A.LogAPI("VE | APIs","VEMap - GetCenter");return a};this.GetMapView=function(){VEMap.ValidateState();try{var e;if(this.vemapcontrol.IsModeEnabled(Msn.VE.MapActionMode.Mode3D)){var d=this.vemapcontrol.Get3DVisibleArea(true);if(d==null)return null;var b=d[0],g=d[1],a=d[2],f=d[3];e=new VELatLongRectangle(c.CreateVELatLong(b.latitude,b.longitude),c.CreateVELatLong(a.latitude,a.longitude),c.CreateVELatLong(g.latitude,g.longitude),c.CreateVELatLong(f.latitude,f.longitude))}else{b=this.vemapcontrol.PixelToLatLong(new Msn.VE.Pixel(0,0));a=this.vemapcontrol.PixelToLatLong(new Msn.VE.Pixel(this.GetWidth(),this.GetHeight()));if(b==null||a==null)return null;e=new VELatLongRectangle(c.CreateVELatLong(b.latitude,b.longitude),c.CreateVELatLong(a.latitude,a.longitude))}$VE_A.LogAPI("VE | APIs","VEMap - GetMapView");return e}catch(h){throw h;return}};this.PixelToLatLong=function(b,d,f){VEMap.ValidateState();try{VEValidator.ValidateInt(b,"x");VEValidator.ValidateInt(d,"y");var g=new Msn.VE.Pixel(parseInt(b),parseInt(d)),a=this.vemapcontrol.PixelToLatLong(g,f),e=c.CreateVELatLong(a.latitude,a.longitude);$VE_A.LogAPI("VE | APIs","VEMap - PixelToLatLong");return e}catch(h){throw h;return}};this.SetAltitude=function(a){try{VEValidator.ValidateFloat(a,"level");var b=parseFloat(a);this._QueueRequest(this.vemapcontrol.SetAltitude,b)}catch(c){throw c;return}};this.SetPitch=function(b){try{VEValidator.ValidateFloat(b,"pitch");var a=parseFloat(b);a=a%360;if(a<-90)a+=360;if(a>=90)a-=360;if(a<-90)a=-90;this._QueueRequest(this.vemapcontrol.SetTilt,a)}catch(c){throw c;return}};this.SetHeading=function(b){try{VEValidator.ValidateFloat(b,"heading");var a=parseFloat(b);a=a%360;if(a<0)a=360+a;this._QueueRequest(this.vemapcontrol.SetDirection,a)}catch(c){throw c;return}};this.GetAltitude=function(){return this.vemapcontrol.GetAltitude()};this.GetPitch=function(){return this.vemapcontrol.GetTilt()};this.GetHeading=function(){return this.vemapcontrol.GetDirection()};this.SetCenter=function(c){VEMap.ValidateState();try{VEValidator.ValidateObject(c,"veLatLong",VELatLong,"VELatLong");var a=b.Decode(c);$VE_A.LogAPI("VE | APIs","VEMap - SetCenter");this._QueueRequest(this.vemapcontrol.SetCenter,a.Latitude,a.Longitude)}catch(d){throw d;return}};this.SetCenterAndZoom=function(c,d){VEMap.ValidateState();try{VEValidator.ValidateObject(c,"veLatLong",VELatLong,"VELatLong");VEValidator.ValidateInt(d,"zoomLevel");var a=b.Decode(c);$VE_A.LogAPI("VE | APIs","VEMap - SetCenterAndZoom");this._QueueRequest(this.vemapcontrol.SetCenterAndZoom,a.Latitude,a.Longitude,d);return true}catch(e){throw e;return}};this.IncludePointInView=function(c){VEMap.ValidateState();try{VEValidator.ValidateObject(c,"veLatLong",VELatLong,"VELatLong");var a=b.Decode(c);$VE_A.LogAPI("VE | APIs","VEMap - IncludePointInView");return this.vemapcontrol.IncludePointInViewport(a.Latitude,a.Longitude)}catch(d){throw d;return}};this.GetOffsetX=function(){return a.vemapcontrol.GetOffsetX()};this.GetOffsetY=function(){return a.vemapcontrol.GetOffsetY()};this.getSvgLayer=function(){return a.vemapcontrol.getSvgLayer()};this.resizeSVG=function(){return a.vemapcontrol.resizeSVG()};this.GetsvgDiv=function(){return a.vemapcontrol.GetsvgDiv()};this.LatLongToPixel=function(c,d){VEMap.ValidateState();try{VEValidator.ValidateObject(c,"veLatLong",VELatLong,"VELatLong");var a=b.Decode(c),e=new Msn.VE.LatLong(a.Latitude,a.Longitude);$VE_A.LogAPI("VE | APIs","VEMap - LatLongToPixel");return this.vemapcontrol.LatLongToPixel(e,d)}catch(f){throw f;return}};this.PanToLatLong=function(c){VEMap.ValidateState();try{VEValidator.ValidateObject(c,"veLatLong",VELatLong,"VELatLong");var a=b.Decode(c);$VE_A.LogAPI("VE | APIs","VEMap - PanToLatLong");this._QueueRequest(this.vemapcontrol.PanToLatLong,a.Latitude,a.Longitude);return true}catch(d){throw d;return}};this.SetMapView=function(a){VEMap.ValidateState();try{VEValidator.ValidateNonNull(a,"arrObject");if(VEMapViewSpecification.prototype.isPrototypeOf(a)){var h=b.Decode(a.LatLong);view=new Msn.VE.MapView(this.vemapcontrol);view.SetCenterLatLong(new Msn.VE.LatLong(h.Latitude,h.Longitude));view.SetMapStyle(this.vemapcontrol.GetMapStyle());if(a.ZoomLevel!=null)view.SetZoomLevel(a.ZoomLevel);else view.SetZoomLevel(this.vemapcontrol.GetZoomLevel());if(a.Altitude!=null)view.SetAltitude(a.Altitude);if(a.Heading!=null)view.SetDirection(a.Heading);if(a.Pitch!=null)view.SetTilt(a.Pitch);$VE_A.LogAPI("VE | APIs","VEMap - SetMapView");this._QueueRequest(this.vemapcontrol.SetView,view);return true}var g=[];if(VELatLongRectangle.prototype.isPrototypeOf(a)){var c=new Object;c.latitude=a.TopLeftLatLong.Latitude;c.longitude=a.TopLeftLatLong.Longitude;g.push(c);c=new Object;c.latitude=a.BottomRightLatLong.Latitude;c.longitude=a.BottomRightLatLong.Longitude;g.push(c)}else{VEValidator.ValidateNonNull(a[0],"arrObject[0]");if(VELatLong.prototype.isPrototypeOf(a[0]))for(var d=0;d<a.length;d++){h=b.Decode(a[d]);c=new Object;c.latitude=h.Latitude;c.longitude=h.Longitude;g.push(c)}else if(VEPolyline.prototype.isPrototypeOf(a[0]))for(d=0;d<a.length;d++){var i=a[d],f=i.GetLatLongs();for(var e=0;e<f.length;e++){c=new Object;c.latitude=f[e].Latitude;c.longitude=f[e].Longitude;g.push(c)}}else if(VEPolygon.prototype.isPrototypeOf(a[0]))for(d=0;d<a.length;d++){var j=a[d],f=j.GetLatLongs();for(e=0;e<f.length;e++){c=new Object;c.latitude=f[e].Latitude;c.longitude=f[e].Longitude;g.push(c)}}}$VE_A.LogAPI("VE | APIs","VEMap - SetMapView");this._QueueRequest(this.vemapcontrol.SetBestMapView,g);return true}catch(k){throw k;return}};this.AddPushpin=function(a){VEMap.ValidateState();VEValidator.ValidateObject(a,"vePushpin",VEPushpin,"VEPushpin");var e=this.pushpins.length;for(var d=0;d<e;d++){var f=this.pushpins[d];if(f.ID==a.ID)throw new VEException("VEMap:AddPushpin","err_invalidpushpinid",l455nt)}this.pushpins.push(a);a._SetMapInstance(this);var c=b.Decode(a.LatLong);if(this.GetMapMode()==Msn.VE.MapActionMode.Mode3D)this.m_vegraphicsmanager.Add3DPushpin(a.ID,c.Latitude,c.Longitude,25,25,"VEAPI_Pushpin",a,Msn.VE.API.Globals.vepushpinpanelzIndex-1);else this.vemapcontrol.AddPushpin(a.ID,c.Latitude,c.Longitude,25,25,"VEAPI_Pushpin",a.GetContent(),Msn.VE.API.Globals.vepushpinpanelzIndex-1);$VE_A.LogAPI("VE | APIs","VEMap - AddPushpin")};this._DisambiguateCallback="VEMap._GetMapFromGUID("+this.GUID+")._Disambiguate";this._Disambiguate=function(f,b,d,c,e){VEMap.ValidateState();var a=$ID(this.ID+"_vewhereinput");if(a)a.value=unescape(f);this.vemapcontrol.SetViewport(b,d,c,e);if(this.lastwhatsearch!=null&&this.lastwhatsearch.length>0)this.Find(this.lastwhatsearch,null,1,this.m_vesearchmanager.vesearchcallback)};this._DoFind=function(){VEMap.ValidateState();try{this.lastwhatsearch=$ID(this.ID+"_vewhatinput").value;this.lastwheresearch=$ID(this.ID+"_vewhereinput").value;this.m_vesearchmanager.Find(this.lastwhatsearch,this.lastwheresearch,null,this._DisambiguateCallback,1)}catch(a){this.ShowMessage(a.message)}};this.UpdateAmbiguousList=function(a){this.m_vesearchmanager.UpdateAmbiguousList(a)};this.SetDashboardSize=function(a){if(a!="undefined"&&a!=null){VEValidator.ValidateDashboardSize(a,"VEDashboardSize");this.dashboardSize=a}else this.dashboardSize=VEDashboardSize.Normal};this.Dispose=function(){try{VEMap.ValidateState();if(a.vemapcontrol!=null){a.vemapcontrol.DetachEvent("onchangeview",a._ClearView);a.vemapcontrol.DetachEvent("onresize",a._ReArrangeControls);a.vemapcontrol.DetachEvent("onendcontinuouspan",a._RefreshLayers)}a.vemapcontrol.DetachEvent("onclick",VEPushpin.Hide);var e=a.controlzIndexes.length;for(var b=0;b<e;b++)a.controlzIndexes.pop();e=a.controls.length;for(b=0;b<e;b++){try{document.body.removeChild(a.controls[b])}catch(g){}a.controls[b]=null;a.controltops[b]=null;a.controllefts[b]=null}a.controls=null;a.controlzIndexes=null;if(a.m_velayermanager)a.m_velayermanager.Dispose();for(b=0;b<a.pushpins.length;++b)if(a.pushpins[b]!=null&&a.pushpins[b]!="undefined"){if(a.GetMapMode()==Msn.VE.MapActionMode.Mode3D)a.m_vegraphicsmanager.Remove3DPushpin(a.pushpins[b].ID);a.pushpins[b].Dispose();a.pushpins[b]=null}a.pushpins=null;if(a.m_vegraphicsmanager)a.m_vegraphicsmanager.Dispose();if(a.m_vetilesourcemanager)a.m_vetilesourcemanager.Dispose();a.m_vemessage.Dispose();a.m_veambiguouslist.Dispose();try{VE_TrafficManager.Destroy()}catch(g){}Msn.VE.API.Globals.vemapinstances[a.GUID]=null;a.veonmaploadevent=null;a.veloadingdiv=null;a.ID=null;a.vemapcontrol.Destroy();a.vemapcontrol=null;var d=0;for(var f in Msn.VE.API.Globals.vemapinstances)if(Msn.VE.API.Globals.vemapinstances[f]!=null)++d;if(d==0){var c=$ID("help");if(c!=null&&c!="undefined")document.body.removeChild(c);Msn.VE.API.Globals.Dispose()}}catch(g){}}}VEMap._GetMapFromGUID=function(a){if(Msn.VE.API.Globals.vemapinstances[a]==null||Msn.VE.API.Globals.vemapinstances[a]=="undefined"){throw new VEException("VEMap:_GetMapFromGUID","err_notinitialized",l415kt);return}return Msn.VE.API.Globals.vemapinstances[a]};VEMap.prototype.InitializeMap=function(){RegisterNamespaces("Msn.VE");this.mapelement.innerHTML="";this.mapelement.style.overflow="hidden";if(this.mapelement.className==null||this.mapelement.className=="undefined"||this.mapelement.className==""){if(this.mapelement.style==null||this.mapelement.style.height==null||this.mapelement.style.height=="undefined"||this.mapelement.style.height=="")this.mapelement.style.height=Msn.VE.API.Globals.vemapheight+"px";if(this.mapelement.style==null||this.mapelement.style.width==null||this.mapelement.style.width=="undefined"||this.mapelement.style.width=="")this.mapelement.style.width=Msn.VE.API.Globals.vemapwidth+"px"}var a=new Object;if(this.mapMode!=null&&this.mapMode!="undefined")a.mapMode=this.mapMode;else a.mapMode=Msn.VE.API.Globals.vemapmode;a.mapGUID=this.GUID;if(this.initialLatitude!=null&&this.initialLatitude!="undefined")a.latitude=this.initialLatitude;else a.latitude=Msn.VE.API.Globals.vemaplatitude;if(this.initialLongitude!=null&&this.initialLongitude!="undefined")a.longitude=this.initialLongitude;else a.longitude=Msn.VE.API.Globals.vemaplongitude;if(this.initialZoomLevel!=null&&this.initialZoomLevel!="undefined")a.zoomlevel=this.initialZoomLevel;else a.zoomlevel=Msn.VE.API.Globals.vemapzoom;if(this.initialMapStyle!=null&&this.initialMapStyle!="undefined")a.mapstyle=this.initialMapStyle;else a.mapstyle=Msn.VE.API.Globals.vemapstyle;this.m_dashboardId=this.ID+"_dashboard";if(this.fixedMap!=true){a.showDashboard=true;a.dashboardSize=this.dashboardSize;a.dashboardX=5;a.dashboardY=5;a.dashboardId=this.m_dashboardId;a.showScaleBar=true}a.obliqueEnabled=true;a.obliqueUrl=Msn.VE.API.Constants.imageryurl;if(this.fixedMap==true)a.fixedView=true;a.disableLogo=false;if(this.showMapModeSwitch==false)a.showMapModeSwitch=false;else a.showMapModeSwitch=true;this.vemapcontrol=new Msn.VE.MapControl(this.mapelement,a,this);this.vemapcontrol.Init();if(!this.fixedMap==true)this.vemapcontrol.AttachEvent("onchangeview",this._ClearView);this.vemapcontrol.AttachEvent("onendcontinuouspan",this._RefreshLayers);this.vemapcontrol.AttachEvent("oninitmode",this._ResetQueueEvent);RegisterNamespaces("Msn.Drawing");this.m_vegraphicsmanager=new VEGraphicsManager(this);this.m_vegraphicsmanager.Initialize();this.m_velayermanager=new VELayerManager(this);this._lm=this.m_velayermanager;this.m_vetilesourcemanager=new VETileSourceManager(this);this.m_vetrafficmanager=new VE_TrafficManager(this);RegisterNamespaces("Msn.VE.UI");Msn.VE.UI.Color={Red:"red",Orange:"orange",Yellow:"yellow"};if($ID("help")==null||$ID("help")=="undefined")VE_Help.CreateHelpPanel();if(this.veonmaploadevent)this.veonmaploadevent(this);this.controlzIndexes=[];this.controls=[];this.controltops=[];this.controllefts=[];this.vemapcontrol.AttachEvent("onresize",this._ReArrangeControls);window.onunload=this.Dispose};VEMap.ValidateState=function(){return true};VEMap.prototype.DeleteAllPushpins=function(){VEMap.ValidateState();VEPushpin.Hide();if(this.pushpins!=null&&this.pushpins!="undefined")if(this.GetMapMode()==Msn.VE.MapActionMode.Mode3D){$VE_A.LogAPI("VE | APIs","VEMap - DeleteAllPushpins");this.m_vegraphicsmanager.ClearAllPushpins(this.pushpins);return}else{var c=this.pushpins.length;for(var a=0;a<c;a++){var b=this.pushpins.pop();if(!b.IsInLayer)b.Dispose()}}$VE_A.LogAPI("VE | APIs","VEMap - DeleteAllPushpins");return this.vemapcontrol.ClearPushpins()};VEMap.prototype.GetMapStyle=function(){VEMap.ValidateState();$VE_A.LogAPI("VE | APIs","VEMap - GetMapStyle");return this.vemapcontrol.GetMapStyle()};VEMap.prototype.GetBirdseyeScene=function(){VEMap.ValidateState();var b=null,a=this.vemapcontrol.GetObliqueScene();if(a!=null&&a!="undefined")b=new VEBirdseyeScene(a);$VE_A.LogAPI("VE | APIs","VEMap - GetBirdseyeScene");return b};VEMap.prototype.IsBirdseyeAvailable=function(){VEMap.ValidateState();$VE_A.LogAPI("VE | APIs","VEMap - IsBirdseyeAvailable");return this.vemapcontrol.IsObliqueAvailable()};VEMap.prototype.SetBirdseyeOrientation=function(a){VEMap.ValidateState();$VE_A.LogAPI("VE | APIs","VEMap - SetBirdseyeOrientation");return this.vemapcontrol.SetObliqueOrientation(a)};VEMap.prototype.SetBirdseyeScene=function(a){VEMap.ValidateState();$VE_A.LogAPI("VE | APIs","VEMap - SetBirdseyeScene");return this.vemapcontrol.SetObliqueScene(a)};VEMap.prototype.GetZoomLevel=function(){VEMap.ValidateState();$VE_A.LogAPI("VE | APIs","VEMap - GetZoomLevel");return this.vemapcontrol.GetZoomLevel()};VEMap.prototype.StartContinuousPan=function(a,b){VEMap.ValidateState();try{VEValidator.ValidateInt(a,"deltaX");VEValidator.ValidateInt(b,"deltaY");$VE_A.LogAPI("VE | APIs","VEMap - StartContinuousPan");return this.vemapcontrol.ContinuousPan(parseInt(a),parseInt(b))}catch(c){throw c;return}};VEMap.prototype.EndContinuousPan=function(){VEMap.ValidateState();try{$VE_A.LogAPI("VE | APIs","VEMap - EndContinuousPan");return this.vemapcontrol.StopContinuousPan()}catch(a){throw a;return}};VEMap.prototype.Pan=function(a,b){VEMap.ValidateState();try{VEValidator.ValidateInt(a,"deltaX");VEValidator.ValidateInt(b,"deltaY");$VE_A.LogAPI("VE | APIs","VEMap - Pan");return this.vemapcontrol.PanMap(parseInt(a),parseInt(b))}catch(c){throw c;return}};VEMap.prototype.DeletePushpin=function(c){VEMap.ValidateState();try{var d=0;if(typeof this.pushpins=="object"&&this.pushpins&&this.pushpins.constructor==Array)d=this.pushpins.length;for(var a=0;a<d;a++){var b=this.pushpins[a];if(b!=null&&b.ID==c){if(!b.IsInLayer)b.Dispose();this.pushpins.splice(a,1);$VE_A.LogAPI("VE | APIs","VEMap - DeletePushpin");if(this.GetMapMode()==Msn.VE.MapActionMode.Mode3D)return this.m_vegraphicsmanager.Remove3DPushpin(c);else return this.vemapcontrol.RemovePushpin(c)}}throw new VEException("VEMap:DeletePushpin","err_invalidpushpinid",l455nt)}catch(e){throw e;return}};VEMap.prototype.Resize=function(b,a){VEMap.ValidateState();try{VEValidator.ValidateInt(b,"width");VEValidator.ValidateInt(a,"height");return this.vemapcontrol.Resize(b,a)}catch(c){throw c;return}};VEMap.prototype.SetMapMode=function(a){VEMap.ValidateState();try{VEValidator.ValidateMapMode(a,"mapMode");this.vemapcontrol.EnableMode(a,this.GUID)}catch(b){throw b;return}};VEMap.prototype.GetMapMode=function(){VEMap.ValidateState();if(this.vemapcontrol.IsModeEnabled(Msn.VE.MapActionMode.Mode3D))return VEMapMode.Mode3D;return VEMapMode.Mode2D};VEMap.prototype.SetMapStyle=function(a){VEMap.ValidateState();try{VEValidator.ValidateMapStyle(a,"mapStyle");this.vemapcontrol.SetMapStyle(a);$VE_A.LogAPI("VE | APIs","VEMap - SetMapStyle")}catch(b){throw b;return}};VEMap.prototype.SetScaleBarDistanceUnit=function(a){VEMap.ValidateState();try{VEValidator.ValidateDistanceUnit(a,"distanceUnit");this.vemapcontrol.SetScaleBarDistanceUnit(a==VEDistanceUnit.Miles?Msn.VE.DistanceUnit.Miles:Msn.VE.DistanceUnit.Kilometers);$VE_A.LogAPI("VE | APIs","VEMap - SetScaleBarDistanceUnit")}catch(b){throw b;return}};VEMap.prototype.SetZoomLevel=function(a){VEMap.ValidateState();try{VEValidator.ValidateInt(a,"zoomLevel");$VE_A.LogAPI("VE | APIs","VEMap - SetZoomLevel");this._QueueRequest(this.vemapcontrol.SetZoom,a);return true}catch(b){throw b;return}};VEMap.prototype.ZoomIn=function(){VEMap.ValidateState();$VE_A.LogAPI("VE | APIs","VEMap - ZoomIn");this._QueueRequest(this.vemapcontrol.ZoomIn)};VEMap.prototype.ZoomOut=function(){VEMap.ValidateState();$VE_A.LogAPI("VE | APIs","VEMap - ZoomOut");this._QueueRequest(this.vemapcontrol.ZoomOut)};VEMap.prototype.AttachEvent=function(b,a){VEMap.ValidateState();try{VEValidator.ValidateNonNull(b,"eventname");VEValidator.ValidateNonNull(a,"eventhandler");this.vemapcontrol.AttachEvent(b,a);$VE_A.LogAPI("VE | APIs","VEMap - AttachEvent")}catch(c){throw c;return}};VEMap.prototype.DetachEvent=function(b,a){VEMap.ValidateState();try{VEValidator.ValidateNonNull(b,"eventname");VEValidator.ValidateNonNull(a,"eventhandler");this.vemapcontrol.DetachEvent(b,a);$VE_A.LogAPI("VE | APIs","VEMap - DetachEvent")}catch(c){throw c;return}};VEMap.prototype.FindLocation=function(a,b){VEMap.ValidateState();this.lastwhatsearch=null;this.lastwheresearch=a;this.m_vesearchmanager.Find(null,a,b,this._DisambiguateCallback,1);$VE_A.LogAPI("VE | APIs","VEMap - FindLocation")};VEMap.prototype.FindNearby=function(a,b,c){VEMap.ValidateState();this.lastwhatsearch=a;this.lastwheresearch=null;this.m_vesearchmanager.Find(a,null,c,this._DisambiguateCallback,b);$VE_A.LogAPI("VE | APIs","VEMap - FindNearby")};VEMap.prototype.Find=function(b,a,c,d){VEMap.ValidateState();this.lastwhatsearch=b;this.lastwheresearch=a;this.m_vesearchmanager.Find(b,a,d,this._DisambiguateCallback,c);$VE_A.LogAPI("VE | APIs","VEMap - Find")};VEMap.prototype.GetRoute=function(d,e,b,c,a){VEMap.ValidateState();this.m_vedirectionsmanager.GetDrivingDirections(d,e,b,c,a);$VE_A.LogAPI("VE | APIs","VEMap - GetRoute")};VEMap.prototype.DeleteRoute=function(){VEMap.ValidateState();this.m_vedirectionsmanager.ClearRoute();$VE_A.LogAPI("VE | APIs","VEMap - DeleteRoute")};VEMap.prototype.ShowMessage=function(a){if(this.ShowMessageBox){VEMap.ValidateState();this.m_vemessage.Show(a);$VE_A.LogAPI("VE | APIs","VEMap - ShowMessage")}};VEMap.prototype.GetHeight=function(){VEMap.ValidateState();var a=parseInt(this.mapelement.style.height.replace("px",""));if(isNaN(a))a=this.mapelement.offsetHeight;return a};VEMap.prototype.GetWidth=function(){VEMap.ValidateState();var a=parseInt(this.mapelement.style.width.replace("px",""));if(isNaN(a))a=this.mapelement.offsetWidth;return a};VEMap.prototype.GetLeft=function(){var a=0;if(this.mapelement.offsetLeft)a=this.mapelement.offsetLeft;else if(this.mapelement.offsetParent)while(this.mapelement.offsetParent){window.status=a;a+=this.mapelement.offsetLeft;this.mapelement=this.mapelement.offsetParent}else if(this.mapelement.x)a+=this.mapelement.x;$VE_A.LogAPI("VE | APIs","VEMap - GetLeft");return a};VEMap.prototype.GetTop=function(){var a=0;if(this.mapelement.offsetTop)a=this.mapelement.offsetTop;else if(this.mapelement.offsetParent)while(this.mapelement.offsetParent){this.mapelement.offsetTop;this.mapelement=this.mapelement.offsetParent}else if(this.mapelement.y)a+=this.mapelement.y;$VE_A.LogAPI("VE | APIs","VEMap - GetTop");return a};VEMap.prototype.SetFindResultsPanel=function(a){VEMap.ValidateState();if(a==null||a=="undefined")throw new VEException("VEMap:SetFindResultsPanel","err_invalidelement",l773et);var b=$ID(a);if(b==null||b=="undefined")throw new VEException("VEMap:SetFindResultsPanel","err_invalidelement",l773et);this.searchelement=a};VEMap.prototype._AddControlInner=function(a){a.style.position="absolute";a.style.zIndex=201;var e=this.GetTop(),d=this.GetLeft();if(!a.style.top)a.style.top="0px";if(!a.style.left)a.style.left="0px";var c=a.style.top,b=a.style.left;if(isNaN(c))c=c.toString().toLowerCase();if(isNaN(b))b=b.toString().toLowerCase();e+=parseInt(c.replace("px"));d+=parseInt(b.replace("px"));a.style.top=e+"px";a.style.left=d+"px";document.body.appendChild(a)};VEMap.prototype.AddControl=function(a,b){VEMap.ValidateState();if(a==null||a=="undefined")throw new VEException("VEMap:AddControl","err_invalidelement",l773et);if(this.controls==null||this.controls=="undefined")throw new VEException("VEMap:AddControl","err_notinitialized",l415kt);this.controlzIndexes.push(b);this.controls.push(a);this.controltops.push(a.style.top);this.controllefts.push(a.style.left);this._AddControlInner(a,b);$VE_A.LogAPI("VE | APIs","VEMap - AddControl")};VEMap.prototype.HideFindControl=function(){VEMap.ValidateState();var a=$ID(this.ID+"_vefindcontrolinput");if(a!=null&&a!="undefined"){a.style.display="none";HideShim(a)}$VE_A.LogAPI("VE | APIs","VEMap - HideFindControl")};VEMap.prototype.ShowDashboard=function(){this._ToggleDashboard(true);$VE_A.LogAPI("VE | APIs","VEMap - ShowDashboard")};VEMap.prototype.HideDashboard=function(){this._ToggleDashboard(false);$VE_A.LogAPI("VE | APIs","VEMap - HideDashboard")};VEMap.prototype._ToggleDashboard=function(c){VEMap.ValidateState();var a=$ID(this.m_dashboardId);if(a!=null){if(c){a.style.visibility="visible";mvcViewFacade.ShowShimIfSupported(a)}else{a.style.visibility="hidden";HideShim(a)}return}if(this.mapelement.childNodes!=null&&this.mapelement.childNodes!="undefined"){var d=this.mapelement.childNodes.length,a=null;for(var b=0;b<d;b++){a=this.mapelement.childNodes[b];if(a==null)continue;if(a.className!=null&&a.className=="Dashboard Dashboard_normal"){if(c)a.style.display="block";else a.style.display="none";break}}}};VEMap.prototype.ShowFindControl=function(f){VEMap.ValidateState();var c=this.ID+"_vefindcontrolinput",a=$ID(c);if(a!=null&&a!="undefined")a.style.display="block";else{a=document.createElement("div");a.className="VE_FindControl";a.id=c;a.style.zIndex=199;a.style.position="absolute";a.style.top="5px";a.style.left="195px";a.style.padding="5px";var b=this.ID+"_vewhatinputcontainer",g=this.ID+"_vewhatinput",e=this.ID+"_vewhereinput";a.innerHTML="<div class=VE_WhatControl id='"+b+"'>"+l723Bt+" "+'<input id="'+g+'" type="text" name="vewhatinput" size="25" onfocus="this.select()" onblur="this.value = this.value" />'+"</div>"+"<div class=VE_WhereControl>"+l147Ct+" "+'<input id="'+e+'" type="text" name="vewhereinput" size="25" style="color: #333333"'+"ondrop=\"this.value='';this.style.color='black';SelectText(this,0,0);\" />"+"</div>"+"<div class=VE_FindButton>"+'<button id="searchbttn" onclick="VEMap._GetMapFromGUID('+this.GUID+')._DoFind();" type="submit" name="submit" value="Local Search">'+l400Dt+"</button>"+"</div>";this.AddControl(a);if(f){var d=$ID(b);if(d)d.style.display="none"}}mvcViewFacade.ShowShimIfSupported(a);$VE_A.LogAPI("VE | APIs","VEMap - ShowFindControl")};VEMap.prototype._Toggle3DNavigationControl=function(b){if(this.GetMapMode()==VEMapMode.Mode3D){var a=this.vemapcontrol.Get3DControl();if(a!=null)a.ShowNavigationControl=b}};VEMap.prototype.Show3DNavigationControl=function(){this._Toggle3DNavigationControl(true)};VEMap.prototype.Hide3DNavigationControl=function(){this._Toggle3DNavigationControl(false)};VEMap.prototype.Clear=function(){VEMap.ValidateState();this._ClearView();this.DeleteAllPushpins();this.m_vedirectionsmanager.RemoveRouteHighLight();this.m_vegraphicsmanager.Clear();this.m_veambiguouslist.Hide();this.m_vemessage.Hide();$VE_A.LogAPI("VE | APIs","VEMap - Clear")};VEMap.prototype._ShowLoading=function(){VEMap.ValidateState();if(!this.veloadingdiv){this.veloadingdiv=document.createElement("div");this.veloadingdiv.className="VE_Network_Loading";this.veloadingdiv.style.top="75px";this.veloadingdiv.style.left="80px";this.veloadingdiv.innerHTML=l669It;this.AddControl(this.veloadingdiv,202)}if(this.veloadingdiv.style.display!="block")this.veloadingdiv.style.display="block";else this.veloadingdiv.style.display="none"};VEMap.prototype.AddPolyline=function(a){VEMap.ValidateState();this.m_vegraphicsmanager.DrawLine(a);$VE_A.LogAPI("VE | APIs","VEMap - AddPolyline")};VEMap.prototype.DeletePolyline=function(a){VEMap.ValidateState();this.m_vegraphicsmanager.RemoveLinebyId(a);$VE_A.LogAPI("VE | APIs","VEMap - DeletePolyline")};VEMap.prototype.DeleteAllPolylines=function(){VEMap.ValidateState();this.m_vegraphicsmanager.RemoveAllLines();$VE_A.LogAPI("VE | APIs","VEMap - DeleteAllPolylines")};VEMap.prototype.AddPolygon=function(a){VEMap.ValidateState();this.m_vegraphicsmanager.DrawPolygon(a);$VE_A.LogAPI("VE | APIs","VEMap - AddPolygon")};VEMap.prototype.DeletePolygon=function(a){VEMap.ValidateState();this.m_vegraphicsmanager.RemovePolygonbyId(a);$VE_A.LogAPI("VE | APIs","VEMap - DeletePolygon")};VEMap.prototype.DeleteAllPolygons=function(){VEMap.ValidateState();this.m_vegraphicsmanager.RemoveAllPolygons();$VE_A.LogAPI("VE | APIs","VEMap - DeleteAllPolygons")};VEMap.prototype.AddLayer=function(a){VEMap.ValidateState();VEValidator.ValidateObject(a,"veLayerSpec",VELayerSpecification,"VELayerSpecification");this.m_velayermanager.AddLayer(a);$VE_A.LogAPI("VE | APIs","VEMap - AddLayer")};VEMap.prototype.ShowLayer=function(a){VEMap.ValidateState();this.m_velayermanager.Show(a);$VE_A.LogAPI("VE | APIs","VEMap - ShowLayer")};VEMap.prototype.ShowAllLayers=function(){VEMap.ValidateState();VEPushpin.Hide();this.m_velayermanager.ShowAllLayers();$VE_A.LogAPI("VE | APIs","VEMap - ShowAllLayers")};VEMap.prototype.HideLayer=function(a){VEMap.ValidateState();VEPushpin.Hide();this.m_velayermanager.Hide(a);$VE_A.LogAPI("VE | APIs","VEMap - HideLayer")};VEMap.prototype.HideAllLayers=function(){VEMap.ValidateState();VEPushpin.Hide();this.m_velayermanager.HideAllLayers();$VE_A.LogAPI("VE | APIs","VEMap - HideAllLayers")};VEMap.prototype.DeleteLayer=function(a){VEMap.ValidateState();this.m_velayermanager.DeleteLayerById(a);this.m_vegraphicsmanager.Clear();this.m_vegraphicsmanager.Draw();$VE_A.LogAPI("VE | APIs","VEMap - DeleteLayer")};VEMap.prototype.DeleteAllLayers=function(){VEMap.ValidateState();this.m_velayermanager.DeleteAllLayers();this.m_vegraphicsmanager.Clear();this.m_vegraphicsmanager.Draw();$VE_A.LogAPI("VE | APIs","VEMap - DeleteAllLayers")};VEMap.GetVersion=function(){$VE_A.LogAPI("VE | APIs","VEMap - GetVersion");return Msn.VE.API.Globals.vecurrentversion};VEMap.prototype.LoadTraffic=function(c,b,a){VEMap.ValidateState();VE_TrafficManager.m_vemap=this;VE_TrafficManager.turnedOn=true;VE_TrafficManager.showTrafficFlow=c;VE_TrafficManager.showIncidents=b;VE_TrafficManager.showConstructionIncidents=a;VE_TrafficManager.markets=[];VE_TrafficManager.incidents=[];window.setTimeout(VE_TrafficManager.GetMarkets,100);$VE_A.LogAPI("VE | APIs","VEMap - LoadTraffic")};VEMap.prototype.ClearTraffic=function(){VEMap.ValidateState();VE_TrafficManager.ClearTraffic();$VE_A.LogAPI("VE | APIs","VEMap - ClearTraffic")};VEMap.prototype.AddTileSource=function(a){VEMap.ValidateState();VEValidator.ValidateObject(a,"tileSourceSpec",VETileSourceSpecification,"VETileSourceSpecification");this.m_vetilesourcemanager.AddTileSource(a);$VE_A.LogAPI("VE | APIs","VEMap - AddTileSource")};VEMap.prototype.DeleteTileSource=function(a){VEMap.ValidateState();this.m_vetilesourcemanager.DeleteSourceById(a);$VE_A.LogAPI("VE | APIs","VEMap - DeleteSource")};VEMap.prototype.ShowDisambiguationDialog=function(a){VEMap.ValidateState();this.m_vesearchmanager.m_showDisambigousDialog=a;$VE_A.LogAPI("VE | APIs","VEMap - ShowDisambiguationDialog")};VEMap.prototype.HideDisambiguationDialog=function(){VEMap.ValidateState();this.m_vesearchmanager.m_showDisambigousDialog=false;$VE_A.LogAPI("VE | APIs","VEMap - HideDisambiguationDialog")};VEMap.prototype._ResetQueueEvent=function(a){if(a==Msn.VE.MapActionMode.Mode2D)this.queueEventInitialized=false};VEMap.prototype._QueueRequest=function(a,b,c,d){if(this.vemapcontrol.IsModeEnabled(Msn.VE.MapActionMode.Mode3D)&&this.RequestQueueEnabled){if(!this.queueEventInitialized){this.vemapcontrol.Get3DControl().AttachEvent("OnCameraChanged","ProcessQueuedRequest");this.queueEventInitialized=true}if(this.vemapcontrol.IsCameraFlying()||this.requestQueue.length>0){this.requestQueue.push(new RequestQueueItem(a,b,c,d));return}}a(b,c,d)};VEMap.prototype._ProcessQueuedRequest=function(){if(this.requestQueue.length>0){var a=this.requestQueue.shift();a.Call(a.Param1,a.Param2,a.Param3)}};VEMap.prototype.ShowMapModeSwitch=function(a){if(this.fixedMap!=true){this.vemapcontrol.SetShowMapModeSwitch(a);this.showMapModeSwitch=a}}
OAT.Loader.featureLoaded("msapi");
